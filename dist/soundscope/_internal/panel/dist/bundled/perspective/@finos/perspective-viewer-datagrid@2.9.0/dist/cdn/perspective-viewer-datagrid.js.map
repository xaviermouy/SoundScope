{
  "version": 3,
  "sources": ["../../../../node_modules/chroma-js/chroma.js", "../../../../node_modules/regular-table/src/js/constants.js", "../../../../node_modules/regular-table/src/js/utils.js", "../../../../node_modules/regular-table/src/js/scroll_panel.js", "../../../../node_modules/regular-table/src/js/events.js", "../../../../node_modules/regular-table/src/js/view_model.js", "../../../../node_modules/regular-table/src/js/thead.js", "../../../../node_modules/regular-table/src/js/tbody.js", "../../../../node_modules/regular-table/src/js/table.js", "../../../../node_modules/regular-table/src/js/index.js", "../../src/js/style_handlers/column_header.js", "../../src/js/style_handlers/group_header.js", "../../src/js/model/index.js", "../../src/js/style_handlers/table_cell/cell_flash.js", "../../src/js/color_utils.js", "../../src/js/style_handlers/table_cell/numeric.js", "../../src/js/style_handlers/table_cell/string.js", "../../src/js/style_handlers/table_cell/datetime.js", "../../src/js/style_handlers/table_cell/boolean.js", "../../src/js/style_handlers/table_cell/row_header.js", "../../src/js/style_handlers/table_cell/index.js", "../../src/js/event_handlers/sort.js", "../../src/js/event_handlers/expand_collapse.js", "../../src/js/event_handlers/header_click.js", "../../src/js/style_handlers/editable.js", "../../src/js/style_handlers/focus.js", "../../src/js/event_handlers/edit_click.js", "../../src/js/event_handlers/focus.js", "../../src/js/get_cell_config.js", "../../src/js/event_handlers/row_select_click.js", "../../src/js/style_handlers/selection.js", "../../src/js/event_handlers/deselect_all.js", "../../src/js/model/create.js", "../../../perspective/src/js/config/settings.js", "../../../perspective/src/js/config/index.js", "../../src/js/data_listener/formatter_cache.js", "../../src/js/data_listener/format_cell.js", "../../src/js/data_listener/format_tree_header.js", "../../src/js/data_listener/index.js", "../../src/js/event_handlers/dispatch_click.js", "../../src/js/plugin/activate.js", "../../src/js/model/column_overrides.js", "../../src/js/model/toolbar.js", "../../src/js/plugin/restore.js", "../../src/js/plugin/save.js", "../../src/js/plugin/draw.js", "../../src/js/plugin/column_style_controls.js", "../../src/js/custom_elements/datagrid.js", "../../src/js/custom_elements/toolbar.js", "../../src/js/index.js"],
  "sourcesContent": ["\n/**\n * @license\n *\n * chroma.js - JavaScript library for color conversions\n * \n * Copyright (c) 2011-2017, Gregor Aisch\n * All rights reserved.\n * \n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n * \n * 1. Redistributions of source code must retain the above copyright notice, this\n *    list of conditions and the following disclaimer.\n * \n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n * \n * 3. The name Gregor Aisch may not be used to endorse or promote products\n *    derived from this software without specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n */\n\n(function() {\n  var Color, DEG2RAD, LAB_CONSTANTS, PI, PITHIRD, RAD2DEG, TWOPI, _average_lrgb, _guess_formats, _guess_formats_sorted, _input, _interpolators, abs, atan2, bezier, blend, blend_f, brewer, burn, chroma, clip_rgb, cmyk2rgb, colors, cos, css2rgb, darken, dodge, each, floor, hcg2rgb, hex2rgb, hsi2rgb, hsl2css, hsl2rgb, hsv2rgb, interpolate, interpolate_hsx, interpolate_lab, interpolate_lrgb, interpolate_num, interpolate_rgb, lab2lch, lab2rgb, lab_xyz, lch2lab, lch2rgb, lighten, limit, log, luminance_x, m, max, multiply, normal, num2rgb, overlay, pow, rgb2cmyk, rgb2css, rgb2hcg, rgb2hex, rgb2hsi, rgb2hsl, rgb2hsv, rgb2lab, rgb2lch, rgb2luminance, rgb2num, rgb2temperature, rgb2xyz, rgb_xyz, rnd, root, round, screen, sin, sqrt, temperature2rgb, type, unpack, w3cx11, xyz_lab, xyz_rgb,\n    slice = [].slice;\n\n  type = (function() {\n\n    /*\n    for browser-safe type checking+\n    ported from jQuery's $.type\n     */\n    var classToType, len, name, o, ref;\n    classToType = {};\n    ref = \"Boolean Number String Function Array Date RegExp Undefined Null\".split(\" \");\n    for (o = 0, len = ref.length; o < len; o++) {\n      name = ref[o];\n      classToType[\"[object \" + name + \"]\"] = name.toLowerCase();\n    }\n    return function(obj) {\n      var strType;\n      strType = Object.prototype.toString.call(obj);\n      return classToType[strType] || \"object\";\n    };\n  })();\n\n  limit = function(x, min, max) {\n    if (min == null) {\n      min = 0;\n    }\n    if (max == null) {\n      max = 1;\n    }\n    if (x < min) {\n      x = min;\n    }\n    if (x > max) {\n      x = max;\n    }\n    return x;\n  };\n\n  unpack = function(args) {\n    if (args.length >= 3) {\n      return Array.prototype.slice.call(args);\n    } else {\n      return args[0];\n    }\n  };\n\n  clip_rgb = function(rgb) {\n    var i, o;\n    rgb._clipped = false;\n    rgb._unclipped = rgb.slice(0);\n    for (i = o = 0; o < 3; i = ++o) {\n      if (i < 3) {\n        if (rgb[i] < 0 || rgb[i] > 255) {\n          rgb._clipped = true;\n        }\n        if (rgb[i] < 0) {\n          rgb[i] = 0;\n        }\n        if (rgb[i] > 255) {\n          rgb[i] = 255;\n        }\n      } else if (i === 3) {\n        if (rgb[i] < 0) {\n          rgb[i] = 0;\n        }\n        if (rgb[i] > 1) {\n          rgb[i] = 1;\n        }\n      }\n    }\n    if (!rgb._clipped) {\n      delete rgb._unclipped;\n    }\n    return rgb;\n  };\n\n  PI = Math.PI, round = Math.round, cos = Math.cos, floor = Math.floor, pow = Math.pow, log = Math.log, sin = Math.sin, sqrt = Math.sqrt, atan2 = Math.atan2, max = Math.max, abs = Math.abs;\n\n  TWOPI = PI * 2;\n\n  PITHIRD = PI / 3;\n\n  DEG2RAD = PI / 180;\n\n  RAD2DEG = 180 / PI;\n\n  chroma = function() {\n    if (arguments[0] instanceof Color) {\n      return arguments[0];\n    }\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, arguments, function(){});\n  };\n\n  chroma[\"default\"] = chroma;\n\n  _interpolators = [];\n\n  if ((typeof module !== \"undefined\" && module !== null) && (module.exports != null)) {\n    module.exports = chroma;\n  }\n\n  if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return chroma;\n    });\n  } else {\n    root = typeof exports !== \"undefined\" && exports !== null ? exports : this;\n    root.chroma = chroma;\n  }\n\n  chroma.version = '1.4.1';\n\n  _input = {};\n\n  _guess_formats = [];\n\n  _guess_formats_sorted = false;\n\n  Color = (function() {\n    function Color() {\n      var arg, args, chk, len, len1, me, mode, o, w;\n      me = this;\n      args = [];\n      for (o = 0, len = arguments.length; o < len; o++) {\n        arg = arguments[o];\n        if (arg != null) {\n          args.push(arg);\n        }\n      }\n      if (args.length > 1) {\n        mode = args[args.length - 1];\n      }\n      if (_input[mode] != null) {\n        me._rgb = clip_rgb(_input[mode](unpack(args.slice(0, -1))));\n      } else {\n        if (!_guess_formats_sorted) {\n          _guess_formats = _guess_formats.sort(function(a, b) {\n            return b.p - a.p;\n          });\n          _guess_formats_sorted = true;\n        }\n        for (w = 0, len1 = _guess_formats.length; w < len1; w++) {\n          chk = _guess_formats[w];\n          mode = chk.test.apply(chk, args);\n          if (mode) {\n            break;\n          }\n        }\n        if (mode) {\n          me._rgb = clip_rgb(_input[mode].apply(_input, args));\n        }\n      }\n      if (me._rgb == null) {\n        console.warn('unknown format: ' + args);\n      }\n      if (me._rgb == null) {\n        me._rgb = [0, 0, 0];\n      }\n      if (me._rgb.length === 3) {\n        me._rgb.push(1);\n      }\n    }\n\n    Color.prototype.toString = function() {\n      return this.hex();\n    };\n\n    return Color;\n\n  })();\n\n  chroma._input = _input;\n\n\n  /**\n  \tColorBrewer colors for chroma.js\n  \n  \tCopyright (c) 2002 Cynthia Brewer, Mark Harrower, and The \n  \tPennsylvania State University.\n  \n  \tLicensed under the Apache License, Version 2.0 (the \"License\"); \n  \tyou may not use this file except in compliance with the License.\n  \tYou may obtain a copy of the License at\t\n  \thttp://www.apache.org/licenses/LICENSE-2.0\n  \n  \tUnless required by applicable law or agreed to in writing, software distributed\n  \tunder the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n  \tCONDITIONS OF ANY KIND, either express or implied. See the License for the\n  \tspecific language governing permissions and limitations under the License.\n  \n      @preserve\n   */\n\n  chroma.brewer = brewer = {\n    OrRd: ['#fff7ec', '#fee8c8', '#fdd49e', '#fdbb84', '#fc8d59', '#ef6548', '#d7301f', '#b30000', '#7f0000'],\n    PuBu: ['#fff7fb', '#ece7f2', '#d0d1e6', '#a6bddb', '#74a9cf', '#3690c0', '#0570b0', '#045a8d', '#023858'],\n    BuPu: ['#f7fcfd', '#e0ecf4', '#bfd3e6', '#9ebcda', '#8c96c6', '#8c6bb1', '#88419d', '#810f7c', '#4d004b'],\n    Oranges: ['#fff5eb', '#fee6ce', '#fdd0a2', '#fdae6b', '#fd8d3c', '#f16913', '#d94801', '#a63603', '#7f2704'],\n    BuGn: ['#f7fcfd', '#e5f5f9', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45', '#006d2c', '#00441b'],\n    YlOrBr: ['#ffffe5', '#fff7bc', '#fee391', '#fec44f', '#fe9929', '#ec7014', '#cc4c02', '#993404', '#662506'],\n    YlGn: ['#ffffe5', '#f7fcb9', '#d9f0a3', '#addd8e', '#78c679', '#41ab5d', '#238443', '#006837', '#004529'],\n    Reds: ['#fff5f0', '#fee0d2', '#fcbba1', '#fc9272', '#fb6a4a', '#ef3b2c', '#cb181d', '#a50f15', '#67000d'],\n    RdPu: ['#fff7f3', '#fde0dd', '#fcc5c0', '#fa9fb5', '#f768a1', '#dd3497', '#ae017e', '#7a0177', '#49006a'],\n    Greens: ['#f7fcf5', '#e5f5e0', '#c7e9c0', '#a1d99b', '#74c476', '#41ab5d', '#238b45', '#006d2c', '#00441b'],\n    YlGnBu: ['#ffffd9', '#edf8b1', '#c7e9b4', '#7fcdbb', '#41b6c4', '#1d91c0', '#225ea8', '#253494', '#081d58'],\n    Purples: ['#fcfbfd', '#efedf5', '#dadaeb', '#bcbddc', '#9e9ac8', '#807dba', '#6a51a3', '#54278f', '#3f007d'],\n    GnBu: ['#f7fcf0', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081'],\n    Greys: ['#ffffff', '#f0f0f0', '#d9d9d9', '#bdbdbd', '#969696', '#737373', '#525252', '#252525', '#000000'],\n    YlOrRd: ['#ffffcc', '#ffeda0', '#fed976', '#feb24c', '#fd8d3c', '#fc4e2a', '#e31a1c', '#bd0026', '#800026'],\n    PuRd: ['#f7f4f9', '#e7e1ef', '#d4b9da', '#c994c7', '#df65b0', '#e7298a', '#ce1256', '#980043', '#67001f'],\n    Blues: ['#f7fbff', '#deebf7', '#c6dbef', '#9ecae1', '#6baed6', '#4292c6', '#2171b5', '#08519c', '#08306b'],\n    PuBuGn: ['#fff7fb', '#ece2f0', '#d0d1e6', '#a6bddb', '#67a9cf', '#3690c0', '#02818a', '#016c59', '#014636'],\n    Viridis: ['#440154', '#482777', '#3f4a8a', '#31678e', '#26838f', '#1f9d8a', '#6cce5a', '#b6de2b', '#fee825'],\n    Spectral: ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#e6f598', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2'],\n    RdYlGn: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#d9ef8b', '#a6d96a', '#66bd63', '#1a9850', '#006837'],\n    RdBu: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#f7f7f7', '#d1e5f0', '#92c5de', '#4393c3', '#2166ac', '#053061'],\n    PiYG: ['#8e0152', '#c51b7d', '#de77ae', '#f1b6da', '#fde0ef', '#f7f7f7', '#e6f5d0', '#b8e186', '#7fbc41', '#4d9221', '#276419'],\n    PRGn: ['#40004b', '#762a83', '#9970ab', '#c2a5cf', '#e7d4e8', '#f7f7f7', '#d9f0d3', '#a6dba0', '#5aae61', '#1b7837', '#00441b'],\n    RdYlBu: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee090', '#ffffbf', '#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695'],\n    BrBG: ['#543005', '#8c510a', '#bf812d', '#dfc27d', '#f6e8c3', '#f5f5f5', '#c7eae5', '#80cdc1', '#35978f', '#01665e', '#003c30'],\n    RdGy: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#ffffff', '#e0e0e0', '#bababa', '#878787', '#4d4d4d', '#1a1a1a'],\n    PuOr: ['#7f3b08', '#b35806', '#e08214', '#fdb863', '#fee0b6', '#f7f7f7', '#d8daeb', '#b2abd2', '#8073ac', '#542788', '#2d004b'],\n    Set2: ['#66c2a5', '#fc8d62', '#8da0cb', '#e78ac3', '#a6d854', '#ffd92f', '#e5c494', '#b3b3b3'],\n    Accent: ['#7fc97f', '#beaed4', '#fdc086', '#ffff99', '#386cb0', '#f0027f', '#bf5b17', '#666666'],\n    Set1: ['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'],\n    Set3: ['#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#b3de69', '#fccde5', '#d9d9d9', '#bc80bd', '#ccebc5', '#ffed6f'],\n    Dark2: ['#1b9e77', '#d95f02', '#7570b3', '#e7298a', '#66a61e', '#e6ab02', '#a6761d', '#666666'],\n    Paired: ['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99', '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928'],\n    Pastel2: ['#b3e2cd', '#fdcdac', '#cbd5e8', '#f4cae4', '#e6f5c9', '#fff2ae', '#f1e2cc', '#cccccc'],\n    Pastel1: ['#fbb4ae', '#b3cde3', '#ccebc5', '#decbe4', '#fed9a6', '#ffffcc', '#e5d8bd', '#fddaec', '#f2f2f2']\n  };\n\n  (function() {\n    var key, results;\n    results = [];\n    for (key in brewer) {\n      results.push(brewer[key.toLowerCase()] = brewer[key]);\n    }\n    return results;\n  })();\n\n\n  /**\n  \tX11 color names\n  \n  \thttp://www.w3.org/TR/css3-color/#svg-color\n   */\n\n  w3cx11 = {\n    aliceblue: '#f0f8ff',\n    antiquewhite: '#faebd7',\n    aqua: '#00ffff',\n    aquamarine: '#7fffd4',\n    azure: '#f0ffff',\n    beige: '#f5f5dc',\n    bisque: '#ffe4c4',\n    black: '#000000',\n    blanchedalmond: '#ffebcd',\n    blue: '#0000ff',\n    blueviolet: '#8a2be2',\n    brown: '#a52a2a',\n    burlywood: '#deb887',\n    cadetblue: '#5f9ea0',\n    chartreuse: '#7fff00',\n    chocolate: '#d2691e',\n    coral: '#ff7f50',\n    cornflower: '#6495ed',\n    cornflowerblue: '#6495ed',\n    cornsilk: '#fff8dc',\n    crimson: '#dc143c',\n    cyan: '#00ffff',\n    darkblue: '#00008b',\n    darkcyan: '#008b8b',\n    darkgoldenrod: '#b8860b',\n    darkgray: '#a9a9a9',\n    darkgreen: '#006400',\n    darkgrey: '#a9a9a9',\n    darkkhaki: '#bdb76b',\n    darkmagenta: '#8b008b',\n    darkolivegreen: '#556b2f',\n    darkorange: '#ff8c00',\n    darkorchid: '#9932cc',\n    darkred: '#8b0000',\n    darksalmon: '#e9967a',\n    darkseagreen: '#8fbc8f',\n    darkslateblue: '#483d8b',\n    darkslategray: '#2f4f4f',\n    darkslategrey: '#2f4f4f',\n    darkturquoise: '#00ced1',\n    darkviolet: '#9400d3',\n    deeppink: '#ff1493',\n    deepskyblue: '#00bfff',\n    dimgray: '#696969',\n    dimgrey: '#696969',\n    dodgerblue: '#1e90ff',\n    firebrick: '#b22222',\n    floralwhite: '#fffaf0',\n    forestgreen: '#228b22',\n    fuchsia: '#ff00ff',\n    gainsboro: '#dcdcdc',\n    ghostwhite: '#f8f8ff',\n    gold: '#ffd700',\n    goldenrod: '#daa520',\n    gray: '#808080',\n    green: '#008000',\n    greenyellow: '#adff2f',\n    grey: '#808080',\n    honeydew: '#f0fff0',\n    hotpink: '#ff69b4',\n    indianred: '#cd5c5c',\n    indigo: '#4b0082',\n    ivory: '#fffff0',\n    khaki: '#f0e68c',\n    laserlemon: '#ffff54',\n    lavender: '#e6e6fa',\n    lavenderblush: '#fff0f5',\n    lawngreen: '#7cfc00',\n    lemonchiffon: '#fffacd',\n    lightblue: '#add8e6',\n    lightcoral: '#f08080',\n    lightcyan: '#e0ffff',\n    lightgoldenrod: '#fafad2',\n    lightgoldenrodyellow: '#fafad2',\n    lightgray: '#d3d3d3',\n    lightgreen: '#90ee90',\n    lightgrey: '#d3d3d3',\n    lightpink: '#ffb6c1',\n    lightsalmon: '#ffa07a',\n    lightseagreen: '#20b2aa',\n    lightskyblue: '#87cefa',\n    lightslategray: '#778899',\n    lightslategrey: '#778899',\n    lightsteelblue: '#b0c4de',\n    lightyellow: '#ffffe0',\n    lime: '#00ff00',\n    limegreen: '#32cd32',\n    linen: '#faf0e6',\n    magenta: '#ff00ff',\n    maroon: '#800000',\n    maroon2: '#7f0000',\n    maroon3: '#b03060',\n    mediumaquamarine: '#66cdaa',\n    mediumblue: '#0000cd',\n    mediumorchid: '#ba55d3',\n    mediumpurple: '#9370db',\n    mediumseagreen: '#3cb371',\n    mediumslateblue: '#7b68ee',\n    mediumspringgreen: '#00fa9a',\n    mediumturquoise: '#48d1cc',\n    mediumvioletred: '#c71585',\n    midnightblue: '#191970',\n    mintcream: '#f5fffa',\n    mistyrose: '#ffe4e1',\n    moccasin: '#ffe4b5',\n    navajowhite: '#ffdead',\n    navy: '#000080',\n    oldlace: '#fdf5e6',\n    olive: '#808000',\n    olivedrab: '#6b8e23',\n    orange: '#ffa500',\n    orangered: '#ff4500',\n    orchid: '#da70d6',\n    palegoldenrod: '#eee8aa',\n    palegreen: '#98fb98',\n    paleturquoise: '#afeeee',\n    palevioletred: '#db7093',\n    papayawhip: '#ffefd5',\n    peachpuff: '#ffdab9',\n    peru: '#cd853f',\n    pink: '#ffc0cb',\n    plum: '#dda0dd',\n    powderblue: '#b0e0e6',\n    purple: '#800080',\n    purple2: '#7f007f',\n    purple3: '#a020f0',\n    rebeccapurple: '#663399',\n    red: '#ff0000',\n    rosybrown: '#bc8f8f',\n    royalblue: '#4169e1',\n    saddlebrown: '#8b4513',\n    salmon: '#fa8072',\n    sandybrown: '#f4a460',\n    seagreen: '#2e8b57',\n    seashell: '#fff5ee',\n    sienna: '#a0522d',\n    silver: '#c0c0c0',\n    skyblue: '#87ceeb',\n    slateblue: '#6a5acd',\n    slategray: '#708090',\n    slategrey: '#708090',\n    snow: '#fffafa',\n    springgreen: '#00ff7f',\n    steelblue: '#4682b4',\n    tan: '#d2b48c',\n    teal: '#008080',\n    thistle: '#d8bfd8',\n    tomato: '#ff6347',\n    turquoise: '#40e0d0',\n    violet: '#ee82ee',\n    wheat: '#f5deb3',\n    white: '#ffffff',\n    whitesmoke: '#f5f5f5',\n    yellow: '#ffff00',\n    yellowgreen: '#9acd32'\n  };\n\n  chroma.colors = colors = w3cx11;\n\n  lab2rgb = function() {\n    var a, args, b, g, l, r, x, y, z;\n    args = unpack(arguments);\n    l = args[0], a = args[1], b = args[2];\n    y = (l + 16) / 116;\n    x = isNaN(a) ? y : y + a / 500;\n    z = isNaN(b) ? y : y - b / 200;\n    y = LAB_CONSTANTS.Yn * lab_xyz(y);\n    x = LAB_CONSTANTS.Xn * lab_xyz(x);\n    z = LAB_CONSTANTS.Zn * lab_xyz(z);\n    r = xyz_rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z);\n    g = xyz_rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z);\n    b = xyz_rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z);\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  xyz_rgb = function(r) {\n    return 255 * (r <= 0.00304 ? 12.92 * r : 1.055 * pow(r, 1 / 2.4) - 0.055);\n  };\n\n  lab_xyz = function(t) {\n    if (t > LAB_CONSTANTS.t1) {\n      return t * t * t;\n    } else {\n      return LAB_CONSTANTS.t2 * (t - LAB_CONSTANTS.t0);\n    }\n  };\n\n  LAB_CONSTANTS = {\n    Kn: 18,\n    Xn: 0.950470,\n    Yn: 1,\n    Zn: 1.088830,\n    t0: 0.137931034,\n    t1: 0.206896552,\n    t2: 0.12841855,\n    t3: 0.008856452\n  };\n\n  rgb2lab = function() {\n    var b, g, r, ref, ref1, x, y, z;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    ref1 = rgb2xyz(r, g, b), x = ref1[0], y = ref1[1], z = ref1[2];\n    return [116 * y - 16, 500 * (x - y), 200 * (y - z)];\n  };\n\n  rgb_xyz = function(r) {\n    if ((r /= 255) <= 0.04045) {\n      return r / 12.92;\n    } else {\n      return pow((r + 0.055) / 1.055, 2.4);\n    }\n  };\n\n  xyz_lab = function(t) {\n    if (t > LAB_CONSTANTS.t3) {\n      return pow(t, 1 / 3);\n    } else {\n      return t / LAB_CONSTANTS.t2 + LAB_CONSTANTS.t0;\n    }\n  };\n\n  rgb2xyz = function() {\n    var b, g, r, ref, x, y, z;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = rgb_xyz(r);\n    g = rgb_xyz(g);\n    b = rgb_xyz(b);\n    x = xyz_lab((0.4124564 * r + 0.3575761 * g + 0.1804375 * b) / LAB_CONSTANTS.Xn);\n    y = xyz_lab((0.2126729 * r + 0.7151522 * g + 0.0721750 * b) / LAB_CONSTANTS.Yn);\n    z = xyz_lab((0.0193339 * r + 0.1191920 * g + 0.9503041 * b) / LAB_CONSTANTS.Zn);\n    return [x, y, z];\n  };\n\n  chroma.lab = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['lab']), function(){});\n  };\n\n  _input.lab = lab2rgb;\n\n  Color.prototype.lab = function() {\n    return rgb2lab(this._rgb);\n  };\n\n  bezier = function(colors) {\n    var I, I0, I1, c, lab0, lab1, lab2, lab3, ref, ref1, ref2;\n    colors = (function() {\n      var len, o, results;\n      results = [];\n      for (o = 0, len = colors.length; o < len; o++) {\n        c = colors[o];\n        results.push(chroma(c));\n      }\n      return results;\n    })();\n    if (colors.length === 2) {\n      ref = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref[0], lab1 = ref[1];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push(lab0[i] + t * (lab1[i] - lab0[i]));\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 3) {\n      ref1 = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref1[0], lab1 = ref1[1], lab2 = ref1[2];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push((1 - t) * (1 - t) * lab0[i] + 2 * (1 - t) * t * lab1[i] + t * t * lab2[i]);\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 4) {\n      ref2 = (function() {\n        var len, o, results;\n        results = [];\n        for (o = 0, len = colors.length; o < len; o++) {\n          c = colors[o];\n          results.push(c.lab());\n        }\n        return results;\n      })(), lab0 = ref2[0], lab1 = ref2[1], lab2 = ref2[2], lab3 = ref2[3];\n      I = function(t) {\n        var i, lab;\n        lab = (function() {\n          var o, results;\n          results = [];\n          for (i = o = 0; o <= 2; i = ++o) {\n            results.push((1 - t) * (1 - t) * (1 - t) * lab0[i] + 3 * (1 - t) * (1 - t) * t * lab1[i] + 3 * (1 - t) * t * t * lab2[i] + t * t * t * lab3[i]);\n          }\n          return results;\n        })();\n        return chroma.lab.apply(chroma, lab);\n      };\n    } else if (colors.length === 5) {\n      I0 = bezier(colors.slice(0, 3));\n      I1 = bezier(colors.slice(2, 5));\n      I = function(t) {\n        if (t < 0.5) {\n          return I0(t * 2);\n        } else {\n          return I1((t - 0.5) * 2);\n        }\n      };\n    }\n    return I;\n  };\n\n  chroma.bezier = function(colors) {\n    var f;\n    f = bezier(colors);\n    f.scale = function() {\n      return chroma.scale(f);\n    };\n    return f;\n  };\n\n  chroma.cubehelix = function(start, rotations, hue, gamma, lightness) {\n    var dh, dl, f;\n    if (start == null) {\n      start = 300;\n    }\n    if (rotations == null) {\n      rotations = -1.5;\n    }\n    if (hue == null) {\n      hue = 1;\n    }\n    if (gamma == null) {\n      gamma = 1;\n    }\n    if (lightness == null) {\n      lightness = [0, 1];\n    }\n    dh = 0;\n    if (type(lightness) === 'array') {\n      dl = lightness[1] - lightness[0];\n    } else {\n      dl = 0;\n      lightness = [lightness, lightness];\n    }\n    f = function(fract) {\n      var a, amp, b, cos_a, g, h, l, r, sin_a;\n      a = TWOPI * ((start + 120) / 360 + rotations * fract);\n      l = pow(lightness[0] + dl * fract, gamma);\n      h = dh !== 0 ? hue[0] + fract * dh : hue;\n      amp = h * l * (1 - l) / 2;\n      cos_a = cos(a);\n      sin_a = sin(a);\n      r = l + amp * (-0.14861 * cos_a + 1.78277 * sin_a);\n      g = l + amp * (-0.29227 * cos_a - 0.90649 * sin_a);\n      b = l + amp * (+1.97294 * cos_a);\n      return chroma(clip_rgb([r * 255, g * 255, b * 255, 1]));\n    };\n    f.start = function(s) {\n      if (s == null) {\n        return start;\n      }\n      start = s;\n      return f;\n    };\n    f.rotations = function(r) {\n      if (r == null) {\n        return rotations;\n      }\n      rotations = r;\n      return f;\n    };\n    f.gamma = function(g) {\n      if (g == null) {\n        return gamma;\n      }\n      gamma = g;\n      return f;\n    };\n    f.hue = function(h) {\n      if (h == null) {\n        return hue;\n      }\n      hue = h;\n      if (type(hue) === 'array') {\n        dh = hue[1] - hue[0];\n        if (dh === 0) {\n          hue = hue[1];\n        }\n      } else {\n        dh = 0;\n      }\n      return f;\n    };\n    f.lightness = function(h) {\n      if (h == null) {\n        return lightness;\n      }\n      if (type(h) === 'array') {\n        lightness = h;\n        dl = h[1] - h[0];\n      } else {\n        lightness = [h, h];\n        dl = 0;\n      }\n      return f;\n    };\n    f.scale = function() {\n      return chroma.scale(f);\n    };\n    f.hue(hue);\n    return f;\n  };\n\n  chroma.random = function() {\n    var code, digits, i, o;\n    digits = '0123456789abcdef';\n    code = '#';\n    for (i = o = 0; o < 6; i = ++o) {\n      code += digits.charAt(floor(Math.random() * 16));\n    }\n    return new Color(code);\n  };\n\n  _interpolators = [];\n\n  interpolate = function(col1, col2, f, m) {\n    var interpol, len, o, res;\n    if (f == null) {\n      f = 0.5;\n    }\n    if (m == null) {\n      m = 'rgb';\n    }\n\n    /*\n    interpolates between colors\n    f = 0 --> me\n    f = 1 --> col\n     */\n    if (type(col1) !== 'object') {\n      col1 = chroma(col1);\n    }\n    if (type(col2) !== 'object') {\n      col2 = chroma(col2);\n    }\n    for (o = 0, len = _interpolators.length; o < len; o++) {\n      interpol = _interpolators[o];\n      if (m === interpol[0]) {\n        res = interpol[1](col1, col2, f, m);\n        break;\n      }\n    }\n    if (res == null) {\n      throw \"color mode \" + m + \" is not supported\";\n    }\n    return res.alpha(col1.alpha() + f * (col2.alpha() - col1.alpha()));\n  };\n\n  chroma.interpolate = interpolate;\n\n  Color.prototype.interpolate = function(col2, f, m) {\n    return interpolate(this, col2, f, m);\n  };\n\n  chroma.mix = interpolate;\n\n  Color.prototype.mix = Color.prototype.interpolate;\n\n  _input.rgb = function() {\n    var k, ref, results, v;\n    ref = unpack(arguments);\n    results = [];\n    for (k in ref) {\n      v = ref[k];\n      results.push(v);\n    }\n    return results;\n  };\n\n  chroma.rgb = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['rgb']), function(){});\n  };\n\n  Color.prototype.rgb = function(round) {\n    if (round == null) {\n      round = true;\n    }\n    if (round) {\n      return this._rgb.map(Math.round).slice(0, 3);\n    } else {\n      return this._rgb.slice(0, 3);\n    }\n  };\n\n  Color.prototype.rgba = function(round) {\n    if (round == null) {\n      round = true;\n    }\n    if (!round) {\n      return this._rgb.slice(0);\n    }\n    return [Math.round(this._rgb[0]), Math.round(this._rgb[1]), Math.round(this._rgb[2]), this._rgb[3]];\n  };\n\n  _guess_formats.push({\n    p: 3,\n    test: function(n) {\n      var a;\n      a = unpack(arguments);\n      if (type(a) === 'array' && a.length === 3) {\n        return 'rgb';\n      }\n      if (a.length === 4 && type(a[3]) === \"number\" && a[3] >= 0 && a[3] <= 1) {\n        return 'rgb';\n      }\n    }\n  });\n\n  _input.lrgb = _input.rgb;\n\n  interpolate_lrgb = function(col1, col2, f, m) {\n    var xyz0, xyz1;\n    xyz0 = col1._rgb;\n    xyz1 = col2._rgb;\n    return new Color(sqrt(pow(xyz0[0], 2) * (1 - f) + pow(xyz1[0], 2) * f), sqrt(pow(xyz0[1], 2) * (1 - f) + pow(xyz1[1], 2) * f), sqrt(pow(xyz0[2], 2) * (1 - f) + pow(xyz1[2], 2) * f), m);\n  };\n\n  _average_lrgb = function(colors) {\n    var col, f, len, o, rgb, xyz;\n    f = 1 / colors.length;\n    xyz = [0, 0, 0, 0];\n    for (o = 0, len = colors.length; o < len; o++) {\n      col = colors[o];\n      rgb = col._rgb;\n      xyz[0] += pow(rgb[0], 2) * f;\n      xyz[1] += pow(rgb[1], 2) * f;\n      xyz[2] += pow(rgb[2], 2) * f;\n      xyz[3] += rgb[3] * f;\n    }\n    xyz[0] = sqrt(xyz[0]);\n    xyz[1] = sqrt(xyz[1]);\n    xyz[2] = sqrt(xyz[2]);\n    if (xyz[3] > 1) {\n      xyz[3] = 1;\n    }\n    return new Color(clip_rgb(xyz));\n  };\n\n  _interpolators.push(['lrgb', interpolate_lrgb]);\n\n  chroma.average = function(colors, mode) {\n    var A, alpha, c, cnt, dx, dy, first, i, l, len, o, xyz, xyz2;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    l = colors.length;\n    colors = colors.map(function(c) {\n      return chroma(c);\n    });\n    first = colors.splice(0, 1)[0];\n    if (mode === 'lrgb') {\n      return _average_lrgb(colors);\n    }\n    xyz = first.get(mode);\n    cnt = [];\n    dx = 0;\n    dy = 0;\n    for (i in xyz) {\n      xyz[i] = xyz[i] || 0;\n      cnt.push(isNaN(xyz[i]) ? 0 : 1);\n      if (mode.charAt(i) === 'h' && !isNaN(xyz[i])) {\n        A = xyz[i] / 180 * PI;\n        dx += cos(A);\n        dy += sin(A);\n      }\n    }\n    alpha = first.alpha();\n    for (o = 0, len = colors.length; o < len; o++) {\n      c = colors[o];\n      xyz2 = c.get(mode);\n      alpha += c.alpha();\n      for (i in xyz) {\n        if (!isNaN(xyz2[i])) {\n          cnt[i] += 1;\n          if (mode.charAt(i) === 'h') {\n            A = xyz2[i] / 180 * PI;\n            dx += cos(A);\n            dy += sin(A);\n          } else {\n            xyz[i] += xyz2[i];\n          }\n        }\n      }\n    }\n    for (i in xyz) {\n      if (mode.charAt(i) === 'h') {\n        A = atan2(dy / cnt[i], dx / cnt[i]) / PI * 180;\n        while (A < 0) {\n          A += 360;\n        }\n        while (A >= 360) {\n          A -= 360;\n        }\n        xyz[i] = A;\n      } else {\n        xyz[i] = xyz[i] / cnt[i];\n      }\n    }\n    return chroma(xyz, mode).alpha(alpha / l);\n  };\n\n  hex2rgb = function(hex) {\n    var a, b, g, r, rgb, u;\n    if (hex.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)) {\n      if (hex.length === 4 || hex.length === 7) {\n        hex = hex.substr(1);\n      }\n      if (hex.length === 3) {\n        hex = hex.split(\"\");\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n      }\n      u = parseInt(hex, 16);\n      r = u >> 16;\n      g = u >> 8 & 0xFF;\n      b = u & 0xFF;\n      return [r, g, b, 1];\n    }\n    if (hex.match(/^#?([A-Fa-f0-9]{8})$/)) {\n      if (hex.length === 9) {\n        hex = hex.substr(1);\n      }\n      u = parseInt(hex, 16);\n      r = u >> 24 & 0xFF;\n      g = u >> 16 & 0xFF;\n      b = u >> 8 & 0xFF;\n      a = round((u & 0xFF) / 0xFF * 100) / 100;\n      return [r, g, b, a];\n    }\n    if ((_input.css != null) && (rgb = _input.css(hex))) {\n      return rgb;\n    }\n    throw \"unknown color: \" + hex;\n  };\n\n  rgb2hex = function(channels, mode) {\n    var a, b, g, hxa, r, str, u;\n    if (mode == null) {\n      mode = 'auto';\n    }\n    r = channels[0], g = channels[1], b = channels[2], a = channels[3];\n    if (mode === 'auto') {\n      mode = a < 1 ? 'rgba' : 'rgb';\n    }\n    r = Math.round(r);\n    g = Math.round(g);\n    b = Math.round(b);\n    u = r << 16 | g << 8 | b;\n    str = \"000000\" + u.toString(16);\n    str = str.substr(str.length - 6);\n    hxa = '0' + round(a * 255).toString(16);\n    hxa = hxa.substr(hxa.length - 2);\n    return \"#\" + (function() {\n      switch (mode.toLowerCase()) {\n        case 'rgba':\n          return str + hxa;\n        case 'argb':\n          return hxa + str;\n        default:\n          return str;\n      }\n    })();\n  };\n\n  _input.hex = function(h) {\n    return hex2rgb(h);\n  };\n\n  chroma.hex = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hex']), function(){});\n  };\n\n  Color.prototype.hex = function(mode) {\n    if (mode == null) {\n      mode = 'auto';\n    }\n    return rgb2hex(this._rgb, mode);\n  };\n\n  _guess_formats.push({\n    p: 4,\n    test: function(n) {\n      if (arguments.length === 1 && type(n) === \"string\") {\n        return 'hex';\n      }\n    }\n  });\n\n  hsl2rgb = function() {\n    var args, b, c, g, h, i, l, o, r, ref, s, t1, t2, t3;\n    args = unpack(arguments);\n    h = args[0], s = args[1], l = args[2];\n    if (s === 0) {\n      r = g = b = l * 255;\n    } else {\n      t3 = [0, 0, 0];\n      c = [0, 0, 0];\n      t2 = l < 0.5 ? l * (1 + s) : l + s - l * s;\n      t1 = 2 * l - t2;\n      h /= 360;\n      t3[0] = h + 1 / 3;\n      t3[1] = h;\n      t3[2] = h - 1 / 3;\n      for (i = o = 0; o <= 2; i = ++o) {\n        if (t3[i] < 0) {\n          t3[i] += 1;\n        }\n        if (t3[i] > 1) {\n          t3[i] -= 1;\n        }\n        if (6 * t3[i] < 1) {\n          c[i] = t1 + (t2 - t1) * 6 * t3[i];\n        } else if (2 * t3[i] < 1) {\n          c[i] = t2;\n        } else if (3 * t3[i] < 2) {\n          c[i] = t1 + (t2 - t1) * ((2 / 3) - t3[i]) * 6;\n        } else {\n          c[i] = t1;\n        }\n      }\n      ref = [round(c[0] * 255), round(c[1] * 255), round(c[2] * 255)], r = ref[0], g = ref[1], b = ref[2];\n    }\n    if (args.length > 3) {\n      return [r, g, b, args[3]];\n    } else {\n      return [r, g, b];\n    }\n  };\n\n  rgb2hsl = function(r, g, b) {\n    var h, l, min, ref, s;\n    if (r !== void 0 && r.length >= 3) {\n      ref = r, r = ref[0], g = ref[1], b = ref[2];\n    }\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    l = (max + min) / 2;\n    if (max === min) {\n      s = 0;\n      h = Number.NaN;\n    } else {\n      s = l < 0.5 ? (max - min) / (max + min) : (max - min) / (2 - max - min);\n    }\n    if (r === max) {\n      h = (g - b) / (max - min);\n    } else if (g === max) {\n      h = 2 + (b - r) / (max - min);\n    } else if (b === max) {\n      h = 4 + (r - g) / (max - min);\n    }\n    h *= 60;\n    if (h < 0) {\n      h += 360;\n    }\n    return [h, s, l];\n  };\n\n  chroma.hsl = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsl']), function(){});\n  };\n\n  _input.hsl = hsl2rgb;\n\n  Color.prototype.hsl = function() {\n    return rgb2hsl(this._rgb);\n  };\n\n  hsv2rgb = function() {\n    var args, b, f, g, h, i, p, q, r, ref, ref1, ref2, ref3, ref4, ref5, s, t, v;\n    args = unpack(arguments);\n    h = args[0], s = args[1], v = args[2];\n    v *= 255;\n    if (s === 0) {\n      r = g = b = v;\n    } else {\n      if (h === 360) {\n        h = 0;\n      }\n      if (h > 360) {\n        h -= 360;\n      }\n      if (h < 0) {\n        h += 360;\n      }\n      h /= 60;\n      i = floor(h);\n      f = h - i;\n      p = v * (1 - s);\n      q = v * (1 - s * f);\n      t = v * (1 - s * (1 - f));\n      switch (i) {\n        case 0:\n          ref = [v, t, p], r = ref[0], g = ref[1], b = ref[2];\n          break;\n        case 1:\n          ref1 = [q, v, p], r = ref1[0], g = ref1[1], b = ref1[2];\n          break;\n        case 2:\n          ref2 = [p, v, t], r = ref2[0], g = ref2[1], b = ref2[2];\n          break;\n        case 3:\n          ref3 = [p, q, v], r = ref3[0], g = ref3[1], b = ref3[2];\n          break;\n        case 4:\n          ref4 = [t, p, v], r = ref4[0], g = ref4[1], b = ref4[2];\n          break;\n        case 5:\n          ref5 = [v, p, q], r = ref5[0], g = ref5[1], b = ref5[2];\n      }\n    }\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hsv = function() {\n    var b, delta, g, h, min, r, ref, s, v;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    delta = max - min;\n    v = max / 255.0;\n    if (max === 0) {\n      h = Number.NaN;\n      s = 0;\n    } else {\n      s = delta / max;\n      if (r === max) {\n        h = (g - b) / delta;\n      }\n      if (g === max) {\n        h = 2 + (b - r) / delta;\n      }\n      if (b === max) {\n        h = 4 + (r - g) / delta;\n      }\n      h *= 60;\n      if (h < 0) {\n        h += 360;\n      }\n    }\n    return [h, s, v];\n  };\n\n  chroma.hsv = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsv']), function(){});\n  };\n\n  _input.hsv = hsv2rgb;\n\n  Color.prototype.hsv = function() {\n    return rgb2hsv(this._rgb);\n  };\n\n  num2rgb = function(num) {\n    var b, g, r;\n    if (type(num) === \"number\" && num >= 0 && num <= 0xFFFFFF) {\n      r = num >> 16;\n      g = (num >> 8) & 0xFF;\n      b = num & 0xFF;\n      return [r, g, b, 1];\n    }\n    console.warn(\"unknown num color: \" + num);\n    return [0, 0, 0, 1];\n  };\n\n  rgb2num = function() {\n    var b, g, r, ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    return (r << 16) + (g << 8) + b;\n  };\n\n  chroma.num = function(num) {\n    return new Color(num, 'num');\n  };\n\n  Color.prototype.num = function(mode) {\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    return rgb2num(this._rgb, mode);\n  };\n\n  _input.num = num2rgb;\n\n  _guess_formats.push({\n    p: 1,\n    test: function(n) {\n      if (arguments.length === 1 && type(n) === \"number\" && n >= 0 && n <= 0xFFFFFF) {\n        return 'num';\n      }\n    }\n  });\n\n  hcg2rgb = function() {\n    var _c, _g, args, b, c, f, g, h, i, p, q, r, ref, ref1, ref2, ref3, ref4, ref5, t, v;\n    args = unpack(arguments);\n    h = args[0], c = args[1], _g = args[2];\n    c = c / 100;\n    g = g / 100 * 255;\n    _c = c * 255;\n    if (c === 0) {\n      r = g = b = _g;\n    } else {\n      if (h === 360) {\n        h = 0;\n      }\n      if (h > 360) {\n        h -= 360;\n      }\n      if (h < 0) {\n        h += 360;\n      }\n      h /= 60;\n      i = floor(h);\n      f = h - i;\n      p = _g * (1 - c);\n      q = p + _c * (1 - f);\n      t = p + _c * f;\n      v = p + _c;\n      switch (i) {\n        case 0:\n          ref = [v, t, p], r = ref[0], g = ref[1], b = ref[2];\n          break;\n        case 1:\n          ref1 = [q, v, p], r = ref1[0], g = ref1[1], b = ref1[2];\n          break;\n        case 2:\n          ref2 = [p, v, t], r = ref2[0], g = ref2[1], b = ref2[2];\n          break;\n        case 3:\n          ref3 = [p, q, v], r = ref3[0], g = ref3[1], b = ref3[2];\n          break;\n        case 4:\n          ref4 = [t, p, v], r = ref4[0], g = ref4[1], b = ref4[2];\n          break;\n        case 5:\n          ref5 = [v, p, q], r = ref5[0], g = ref5[1], b = ref5[2];\n      }\n    }\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hcg = function() {\n    var _g, b, c, delta, g, h, min, r, ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    min = Math.min(r, g, b);\n    max = Math.max(r, g, b);\n    delta = max - min;\n    c = delta * 100 / 255;\n    _g = min / (255 - delta) * 100;\n    if (delta === 0) {\n      h = Number.NaN;\n    } else {\n      if (r === max) {\n        h = (g - b) / delta;\n      }\n      if (g === max) {\n        h = 2 + (b - r) / delta;\n      }\n      if (b === max) {\n        h = 4 + (r - g) / delta;\n      }\n      h *= 60;\n      if (h < 0) {\n        h += 360;\n      }\n    }\n    return [h, c, _g];\n  };\n\n  chroma.hcg = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hcg']), function(){});\n  };\n\n  _input.hcg = hcg2rgb;\n\n  Color.prototype.hcg = function() {\n    return rgb2hcg(this._rgb);\n  };\n\n  css2rgb = function(css) {\n    var aa, ab, hsl, i, m, o, rgb, w;\n    css = css.toLowerCase();\n    if ((chroma.colors != null) && chroma.colors[css]) {\n      return hex2rgb(chroma.colors[css]);\n    }\n    if (m = css.match(/rgb\\(\\s*(\\-?\\d+),\\s*(\\-?\\d+)\\s*,\\s*(\\-?\\d+)\\s*\\)/)) {\n      rgb = m.slice(1, 4);\n      for (i = o = 0; o <= 2; i = ++o) {\n        rgb[i] = +rgb[i];\n      }\n      rgb[3] = 1;\n    } else if (m = css.match(/rgba\\(\\s*(\\-?\\d+),\\s*(\\-?\\d+)\\s*,\\s*(\\-?\\d+)\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      rgb = m.slice(1, 5);\n      for (i = w = 0; w <= 3; i = ++w) {\n        rgb[i] = +rgb[i];\n      }\n    } else if (m = css.match(/rgb\\(\\s*(\\-?\\d+(?:\\.\\d+)?)%,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*\\)/)) {\n      rgb = m.slice(1, 4);\n      for (i = aa = 0; aa <= 2; i = ++aa) {\n        rgb[i] = round(rgb[i] * 2.55);\n      }\n      rgb[3] = 1;\n    } else if (m = css.match(/rgba\\(\\s*(\\-?\\d+(?:\\.\\d+)?)%,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      rgb = m.slice(1, 5);\n      for (i = ab = 0; ab <= 2; i = ++ab) {\n        rgb[i] = round(rgb[i] * 2.55);\n      }\n      rgb[3] = +rgb[3];\n    } else if (m = css.match(/hsl\\(\\s*(\\-?\\d+(?:\\.\\d+)?),\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*\\)/)) {\n      hsl = m.slice(1, 4);\n      hsl[1] *= 0.01;\n      hsl[2] *= 0.01;\n      rgb = hsl2rgb(hsl);\n      rgb[3] = 1;\n    } else if (m = css.match(/hsla\\(\\s*(\\-?\\d+(?:\\.\\d+)?),\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(\\-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)/)) {\n      hsl = m.slice(1, 4);\n      hsl[1] *= 0.01;\n      hsl[2] *= 0.01;\n      rgb = hsl2rgb(hsl);\n      rgb[3] = +m[4];\n    }\n    return rgb;\n  };\n\n  rgb2css = function(rgba) {\n    var mode;\n    mode = rgba[3] < 1 ? 'rgba' : 'rgb';\n    if (mode === 'rgb') {\n      return mode + '(' + rgba.slice(0, 3).map(round).join(',') + ')';\n    } else if (mode === 'rgba') {\n      return mode + '(' + rgba.slice(0, 3).map(round).join(',') + ',' + rgba[3] + ')';\n    } else {\n\n    }\n  };\n\n  rnd = function(a) {\n    return round(a * 100) / 100;\n  };\n\n  hsl2css = function(hsl, alpha) {\n    var mode;\n    mode = alpha < 1 ? 'hsla' : 'hsl';\n    hsl[0] = rnd(hsl[0] || 0);\n    hsl[1] = rnd(hsl[1] * 100) + '%';\n    hsl[2] = rnd(hsl[2] * 100) + '%';\n    if (mode === 'hsla') {\n      hsl[3] = alpha;\n    }\n    return mode + '(' + hsl.join(',') + ')';\n  };\n\n  _input.css = function(h) {\n    return css2rgb(h);\n  };\n\n  chroma.css = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['css']), function(){});\n  };\n\n  Color.prototype.css = function(mode) {\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    if (mode.slice(0, 3) === 'rgb') {\n      return rgb2css(this._rgb);\n    } else if (mode.slice(0, 3) === 'hsl') {\n      return hsl2css(this.hsl(), this.alpha());\n    }\n  };\n\n  _input.named = function(name) {\n    return hex2rgb(w3cx11[name]);\n  };\n\n  _guess_formats.push({\n    p: 5,\n    test: function(n) {\n      if (arguments.length === 1 && (w3cx11[n] != null)) {\n        return 'named';\n      }\n    }\n  });\n\n  Color.prototype.name = function(n) {\n    var h, k;\n    if (arguments.length) {\n      if (w3cx11[n]) {\n        this._rgb = hex2rgb(w3cx11[n]);\n      }\n      this._rgb[3] = 1;\n      this;\n    }\n    h = this.hex('rgb');\n    for (k in w3cx11) {\n      if (h === w3cx11[k]) {\n        return k;\n      }\n    }\n    return h;\n  };\n\n  lch2lab = function() {\n\n    /*\n    Convert from a qualitative parameter h and a quantitative parameter l to a 24-bit pixel.\n    These formulas were invented by David Dalrymple to obtain maximum contrast without going\n    out of gamut if the parameters are in the range 0-1.\n    \n    A saturation multiplier was added by Gregor Aisch\n     */\n    var c, h, l, ref;\n    ref = unpack(arguments), l = ref[0], c = ref[1], h = ref[2];\n    h = h * DEG2RAD;\n    return [l, cos(h) * c, sin(h) * c];\n  };\n\n  lch2rgb = function() {\n    var L, a, args, b, c, g, h, l, r, ref, ref1;\n    args = unpack(arguments);\n    l = args[0], c = args[1], h = args[2];\n    ref = lch2lab(l, c, h), L = ref[0], a = ref[1], b = ref[2];\n    ref1 = lab2rgb(L, a, b), r = ref1[0], g = ref1[1], b = ref1[2];\n    return [r, g, b, args.length > 3 ? args[3] : 1];\n  };\n\n  lab2lch = function() {\n    var a, b, c, h, l, ref;\n    ref = unpack(arguments), l = ref[0], a = ref[1], b = ref[2];\n    c = sqrt(a * a + b * b);\n    h = (atan2(b, a) * RAD2DEG + 360) % 360;\n    if (round(c * 10000) === 0) {\n      h = Number.NaN;\n    }\n    return [l, c, h];\n  };\n\n  rgb2lch = function() {\n    var a, b, g, l, r, ref, ref1;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    ref1 = rgb2lab(r, g, b), l = ref1[0], a = ref1[1], b = ref1[2];\n    return lab2lch(l, a, b);\n  };\n\n  chroma.lch = function() {\n    var args;\n    args = unpack(arguments);\n    return new Color(args, 'lch');\n  };\n\n  chroma.hcl = function() {\n    var args;\n    args = unpack(arguments);\n    return new Color(args, 'hcl');\n  };\n\n  _input.lch = lch2rgb;\n\n  _input.hcl = function() {\n    var c, h, l, ref;\n    ref = unpack(arguments), h = ref[0], c = ref[1], l = ref[2];\n    return lch2rgb([l, c, h]);\n  };\n\n  Color.prototype.lch = function() {\n    return rgb2lch(this._rgb);\n  };\n\n  Color.prototype.hcl = function() {\n    return rgb2lch(this._rgb).reverse();\n  };\n\n  rgb2cmyk = function(mode) {\n    var b, c, f, g, k, m, r, ref, y;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = r / 255;\n    g = g / 255;\n    b = b / 255;\n    k = 1 - Math.max(r, Math.max(g, b));\n    f = k < 1 ? 1 / (1 - k) : 0;\n    c = (1 - r - k) * f;\n    m = (1 - g - k) * f;\n    y = (1 - b - k) * f;\n    return [c, m, y, k];\n  };\n\n  cmyk2rgb = function() {\n    var alpha, args, b, c, g, k, m, r, y;\n    args = unpack(arguments);\n    c = args[0], m = args[1], y = args[2], k = args[3];\n    alpha = args.length > 4 ? args[4] : 1;\n    if (k === 1) {\n      return [0, 0, 0, alpha];\n    }\n    r = c >= 1 ? 0 : 255 * (1 - c) * (1 - k);\n    g = m >= 1 ? 0 : 255 * (1 - m) * (1 - k);\n    b = y >= 1 ? 0 : 255 * (1 - y) * (1 - k);\n    return [r, g, b, alpha];\n  };\n\n  _input.cmyk = function() {\n    return cmyk2rgb(unpack(arguments));\n  };\n\n  chroma.cmyk = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['cmyk']), function(){});\n  };\n\n  Color.prototype.cmyk = function() {\n    return rgb2cmyk(this._rgb);\n  };\n\n  _input.gl = function() {\n    var i, k, o, rgb, v;\n    rgb = (function() {\n      var ref, results;\n      ref = unpack(arguments);\n      results = [];\n      for (k in ref) {\n        v = ref[k];\n        results.push(v);\n      }\n      return results;\n    }).apply(this, arguments);\n    for (i = o = 0; o <= 2; i = ++o) {\n      rgb[i] *= 255;\n    }\n    return rgb;\n  };\n\n  chroma.gl = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['gl']), function(){});\n  };\n\n  Color.prototype.gl = function() {\n    var rgb;\n    rgb = this._rgb;\n    return [rgb[0] / 255, rgb[1] / 255, rgb[2] / 255, rgb[3]];\n  };\n\n  rgb2luminance = function(r, g, b) {\n    var ref;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    r = luminance_x(r);\n    g = luminance_x(g);\n    b = luminance_x(b);\n    return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n  };\n\n  luminance_x = function(x) {\n    x /= 255;\n    if (x <= 0.03928) {\n      return x / 12.92;\n    } else {\n      return pow((x + 0.055) / 1.055, 2.4);\n    }\n  };\n\n  interpolate_rgb = function(col1, col2, f, m) {\n    var xyz0, xyz1;\n    xyz0 = col1._rgb;\n    xyz1 = col2._rgb;\n    return new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);\n  };\n\n  _interpolators.push(['rgb', interpolate_rgb]);\n\n  Color.prototype.luminance = function(lum, mode) {\n    var cur_lum, eps, max_iter, rgba, test;\n    if (mode == null) {\n      mode = 'rgb';\n    }\n    if (!arguments.length) {\n      return rgb2luminance(this._rgb);\n    }\n    rgba = this._rgb;\n    if (lum === 0) {\n      rgba = [0, 0, 0, this._rgb[3]];\n    } else if (lum === 1) {\n      rgba = [255, 255, 255, this[3]];\n    } else {\n      cur_lum = rgb2luminance(this._rgb);\n      eps = 1e-7;\n      max_iter = 20;\n      test = function(l, h) {\n        var lm, m;\n        m = l.interpolate(h, 0.5, mode);\n        lm = m.luminance();\n        if (Math.abs(lum - lm) < eps || !max_iter--) {\n          return m;\n        }\n        if (lm > lum) {\n          return test(l, m);\n        }\n        return test(m, h);\n      };\n      if (cur_lum > lum) {\n        rgba = test(chroma('black'), this).rgba();\n      } else {\n        rgba = test(this, chroma('white')).rgba();\n      }\n    }\n    return chroma(rgba).alpha(this.alpha());\n  };\n\n  temperature2rgb = function(kelvin) {\n    var b, g, r, temp;\n    temp = kelvin / 100;\n    if (temp < 66) {\n      r = 255;\n      g = -155.25485562709179 - 0.44596950469579133 * (g = temp - 2) + 104.49216199393888 * log(g);\n      b = temp < 20 ? 0 : -254.76935184120902 + 0.8274096064007395 * (b = temp - 10) + 115.67994401066147 * log(b);\n    } else {\n      r = 351.97690566805693 + 0.114206453784165 * (r = temp - 55) - 40.25366309332127 * log(r);\n      g = 325.4494125711974 + 0.07943456536662342 * (g = temp - 50) - 28.0852963507957 * log(g);\n      b = 255;\n    }\n    return [r, g, b];\n  };\n\n  rgb2temperature = function() {\n    var b, eps, g, maxTemp, minTemp, r, ref, rgb, temp;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    minTemp = 1000;\n    maxTemp = 40000;\n    eps = 0.4;\n    while (maxTemp - minTemp > eps) {\n      temp = (maxTemp + minTemp) * 0.5;\n      rgb = temperature2rgb(temp);\n      if ((rgb[2] / rgb[0]) >= (b / r)) {\n        maxTemp = temp;\n      } else {\n        minTemp = temp;\n      }\n    }\n    return round(temp);\n  };\n\n  chroma.temperature = chroma.kelvin = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['temperature']), function(){});\n  };\n\n  _input.temperature = _input.kelvin = _input.K = temperature2rgb;\n\n  Color.prototype.temperature = function() {\n    return rgb2temperature(this._rgb);\n  };\n\n  Color.prototype.kelvin = Color.prototype.temperature;\n\n  chroma.contrast = function(a, b) {\n    var l1, l2, ref, ref1;\n    if ((ref = type(a)) === 'string' || ref === 'number') {\n      a = new Color(a);\n    }\n    if ((ref1 = type(b)) === 'string' || ref1 === 'number') {\n      b = new Color(b);\n    }\n    l1 = a.luminance();\n    l2 = b.luminance();\n    if (l1 > l2) {\n      return (l1 + 0.05) / (l2 + 0.05);\n    } else {\n      return (l2 + 0.05) / (l1 + 0.05);\n    }\n  };\n\n  chroma.distance = function(a, b, mode) {\n    var d, i, l1, l2, ref, ref1, sum_sq;\n    if (mode == null) {\n      mode = 'lab';\n    }\n    if ((ref = type(a)) === 'string' || ref === 'number') {\n      a = new Color(a);\n    }\n    if ((ref1 = type(b)) === 'string' || ref1 === 'number') {\n      b = new Color(b);\n    }\n    l1 = a.get(mode);\n    l2 = b.get(mode);\n    sum_sq = 0;\n    for (i in l1) {\n      d = (l1[i] || 0) - (l2[i] || 0);\n      sum_sq += d * d;\n    }\n    return Math.sqrt(sum_sq);\n  };\n\n  chroma.deltaE = function(a, b, L, C) {\n    var L1, L2, a1, a2, b1, b2, c1, c2, c4, dH2, delA, delB, delC, delL, f, h1, ref, ref1, ref2, ref3, sc, sh, sl, t, v1, v2, v3;\n    if (L == null) {\n      L = 1;\n    }\n    if (C == null) {\n      C = 1;\n    }\n    if ((ref = type(a)) === 'string' || ref === 'number') {\n      a = new Color(a);\n    }\n    if ((ref1 = type(b)) === 'string' || ref1 === 'number') {\n      b = new Color(b);\n    }\n    ref2 = a.lab(), L1 = ref2[0], a1 = ref2[1], b1 = ref2[2];\n    ref3 = b.lab(), L2 = ref3[0], a2 = ref3[1], b2 = ref3[2];\n    c1 = sqrt(a1 * a1 + b1 * b1);\n    c2 = sqrt(a2 * a2 + b2 * b2);\n    sl = L1 < 16.0 ? 0.511 : (0.040975 * L1) / (1.0 + 0.01765 * L1);\n    sc = (0.0638 * c1) / (1.0 + 0.0131 * c1) + 0.638;\n    h1 = c1 < 0.000001 ? 0.0 : (atan2(b1, a1) * 180.0) / PI;\n    while (h1 < 0) {\n      h1 += 360;\n    }\n    while (h1 >= 360) {\n      h1 -= 360;\n    }\n    t = (h1 >= 164.0) && (h1 <= 345.0) ? 0.56 + abs(0.2 * cos((PI * (h1 + 168.0)) / 180.0)) : 0.36 + abs(0.4 * cos((PI * (h1 + 35.0)) / 180.0));\n    c4 = c1 * c1 * c1 * c1;\n    f = sqrt(c4 / (c4 + 1900.0));\n    sh = sc * (f * t + 1.0 - f);\n    delL = L1 - L2;\n    delC = c1 - c2;\n    delA = a1 - a2;\n    delB = b1 - b2;\n    dH2 = delA * delA + delB * delB - delC * delC;\n    v1 = delL / (L * sl);\n    v2 = delC / (C * sc);\n    v3 = sh;\n    return sqrt(v1 * v1 + v2 * v2 + (dH2 / (v3 * v3)));\n  };\n\n  Color.prototype.get = function(modechan) {\n    var channel, i, me, mode, ref, src;\n    me = this;\n    ref = modechan.split('.'), mode = ref[0], channel = ref[1];\n    src = me[mode]();\n    if (channel) {\n      i = mode.indexOf(channel);\n      if (i > -1) {\n        return src[i];\n      } else {\n        return console.warn('unknown channel ' + channel + ' in mode ' + mode);\n      }\n    } else {\n      return src;\n    }\n  };\n\n  Color.prototype.set = function(modechan, value) {\n    var channel, i, me, mode, ref, src;\n    me = this;\n    ref = modechan.split('.'), mode = ref[0], channel = ref[1];\n    if (channel) {\n      src = me[mode]();\n      i = mode.indexOf(channel);\n      if (i > -1) {\n        if (type(value) === 'string') {\n          switch (value.charAt(0)) {\n            case '+':\n              src[i] += +value;\n              break;\n            case '-':\n              src[i] += +value;\n              break;\n            case '*':\n              src[i] *= +(value.substr(1));\n              break;\n            case '/':\n              src[i] /= +(value.substr(1));\n              break;\n            default:\n              src[i] = +value;\n          }\n        } else {\n          src[i] = value;\n        }\n      } else {\n        console.warn('unknown channel ' + channel + ' in mode ' + mode);\n      }\n    } else {\n      src = value;\n    }\n    return chroma(src, mode).alpha(me.alpha());\n  };\n\n  Color.prototype.clipped = function() {\n    return this._rgb._clipped || false;\n  };\n\n  Color.prototype.alpha = function(a) {\n    if (arguments.length) {\n      return chroma.rgb([this._rgb[0], this._rgb[1], this._rgb[2], a]);\n    }\n    return this._rgb[3];\n  };\n\n  Color.prototype.darken = function(amount) {\n    var lab, me;\n    if (amount == null) {\n      amount = 1;\n    }\n    me = this;\n    lab = me.lab();\n    lab[0] -= LAB_CONSTANTS.Kn * amount;\n    return chroma.lab(lab).alpha(me.alpha());\n  };\n\n  Color.prototype.brighten = function(amount) {\n    if (amount == null) {\n      amount = 1;\n    }\n    return this.darken(-amount);\n  };\n\n  Color.prototype.darker = Color.prototype.darken;\n\n  Color.prototype.brighter = Color.prototype.brighten;\n\n  Color.prototype.saturate = function(amount) {\n    var lch, me;\n    if (amount == null) {\n      amount = 1;\n    }\n    me = this;\n    lch = me.lch();\n    lch[1] += amount * LAB_CONSTANTS.Kn;\n    if (lch[1] < 0) {\n      lch[1] = 0;\n    }\n    return chroma.lch(lch).alpha(me.alpha());\n  };\n\n  Color.prototype.desaturate = function(amount) {\n    if (amount == null) {\n      amount = 1;\n    }\n    return this.saturate(-amount);\n  };\n\n  Color.prototype.premultiply = function() {\n    var a, rgb;\n    rgb = this.rgb();\n    a = this.alpha();\n    return chroma(rgb[0] * a, rgb[1] * a, rgb[2] * a, a);\n  };\n\n  blend = function(bottom, top, mode) {\n    if (!blend[mode]) {\n      throw 'unknown blend mode ' + mode;\n    }\n    return blend[mode](bottom, top);\n  };\n\n  blend_f = function(f) {\n    return function(bottom, top) {\n      var c0, c1;\n      c0 = chroma(top).rgb();\n      c1 = chroma(bottom).rgb();\n      return chroma(f(c0, c1), 'rgb');\n    };\n  };\n\n  each = function(f) {\n    return function(c0, c1) {\n      var i, o, out;\n      out = [];\n      for (i = o = 0; o <= 3; i = ++o) {\n        out[i] = f(c0[i], c1[i]);\n      }\n      return out;\n    };\n  };\n\n  normal = function(a, b) {\n    return a;\n  };\n\n  multiply = function(a, b) {\n    return a * b / 255;\n  };\n\n  darken = function(a, b) {\n    if (a > b) {\n      return b;\n    } else {\n      return a;\n    }\n  };\n\n  lighten = function(a, b) {\n    if (a > b) {\n      return a;\n    } else {\n      return b;\n    }\n  };\n\n  screen = function(a, b) {\n    return 255 * (1 - (1 - a / 255) * (1 - b / 255));\n  };\n\n  overlay = function(a, b) {\n    if (b < 128) {\n      return 2 * a * b / 255;\n    } else {\n      return 255 * (1 - 2 * (1 - a / 255) * (1 - b / 255));\n    }\n  };\n\n  burn = function(a, b) {\n    return 255 * (1 - (1 - b / 255) / (a / 255));\n  };\n\n  dodge = function(a, b) {\n    if (a === 255) {\n      return 255;\n    }\n    a = 255 * (b / 255) / (1 - a / 255);\n    if (a > 255) {\n      return 255;\n    } else {\n      return a;\n    }\n  };\n\n  blend.normal = blend_f(each(normal));\n\n  blend.multiply = blend_f(each(multiply));\n\n  blend.screen = blend_f(each(screen));\n\n  blend.overlay = blend_f(each(overlay));\n\n  blend.darken = blend_f(each(darken));\n\n  blend.lighten = blend_f(each(lighten));\n\n  blend.dodge = blend_f(each(dodge));\n\n  blend.burn = blend_f(each(burn));\n\n  chroma.blend = blend;\n\n  chroma.analyze = function(data) {\n    var len, o, r, val;\n    r = {\n      min: Number.MAX_VALUE,\n      max: Number.MAX_VALUE * -1,\n      sum: 0,\n      values: [],\n      count: 0\n    };\n    for (o = 0, len = data.length; o < len; o++) {\n      val = data[o];\n      if ((val != null) && !isNaN(val)) {\n        r.values.push(val);\n        r.sum += val;\n        if (val < r.min) {\n          r.min = val;\n        }\n        if (val > r.max) {\n          r.max = val;\n        }\n        r.count += 1;\n      }\n    }\n    r.domain = [r.min, r.max];\n    r.limits = function(mode, num) {\n      return chroma.limits(r, mode, num);\n    };\n    return r;\n  };\n\n  chroma.scale = function(colors, positions) {\n    var _classes, _colorCache, _colors, _correctLightness, _domain, _fixed, _gamma, _max, _min, _mode, _nacol, _out, _padding, _pos, _spread, _useCache, classifyValue, f, getClass, getColor, resetCache, setColors, tmap;\n    _mode = 'rgb';\n    _nacol = chroma('#ccc');\n    _spread = 0;\n    _fixed = false;\n    _domain = [0, 1];\n    _pos = [];\n    _padding = [0, 0];\n    _classes = false;\n    _colors = [];\n    _out = false;\n    _min = 0;\n    _max = 1;\n    _correctLightness = false;\n    _colorCache = {};\n    _useCache = true;\n    _gamma = 1;\n    setColors = function(colors) {\n      var c, col, o, ref, ref1, w;\n      if (colors == null) {\n        colors = ['#fff', '#000'];\n      }\n      if ((colors != null) && type(colors) === 'string' && (chroma.brewer != null)) {\n        colors = chroma.brewer[colors] || chroma.brewer[colors.toLowerCase()] || colors;\n      }\n      if (type(colors) === 'array') {\n        if (colors.length === 1) {\n          colors = [colors[0], colors[0]];\n        }\n        colors = colors.slice(0);\n        for (c = o = 0, ref = colors.length - 1; 0 <= ref ? o <= ref : o >= ref; c = 0 <= ref ? ++o : --o) {\n          col = colors[c];\n          if (type(col) === \"string\") {\n            colors[c] = chroma(col);\n          }\n        }\n        _pos.length = 0;\n        for (c = w = 0, ref1 = colors.length - 1; 0 <= ref1 ? w <= ref1 : w >= ref1; c = 0 <= ref1 ? ++w : --w) {\n          _pos.push(c / (colors.length - 1));\n        }\n      }\n      resetCache();\n      return _colors = colors;\n    };\n    getClass = function(value) {\n      var i, n;\n      if (_classes != null) {\n        n = _classes.length - 1;\n        i = 0;\n        while (i < n && value >= _classes[i]) {\n          i++;\n        }\n        return i - 1;\n      }\n      return 0;\n    };\n    tmap = function(t) {\n      return t;\n    };\n    classifyValue = function(value) {\n      var i, maxc, minc, n, val;\n      val = value;\n      if (_classes.length > 2) {\n        n = _classes.length - 1;\n        i = getClass(value);\n        minc = _classes[0] + (_classes[1] - _classes[0]) * (0 + _spread * 0.5);\n        maxc = _classes[n - 1] + (_classes[n] - _classes[n - 1]) * (1 - _spread * 0.5);\n        val = _min + ((_classes[i] + (_classes[i + 1] - _classes[i]) * 0.5 - minc) / (maxc - minc)) * (_max - _min);\n      }\n      return val;\n    };\n    getColor = function(val, bypassMap) {\n      var c, col, i, k, o, p, ref, t;\n      if (bypassMap == null) {\n        bypassMap = false;\n      }\n      if (isNaN(val) || val === null) {\n        return _nacol;\n      }\n      if (!bypassMap) {\n        if (_classes && _classes.length > 2) {\n          c = getClass(val);\n          t = c / (_classes.length - 2);\n        } else if (_max !== _min) {\n          t = (val - _min) / (_max - _min);\n        } else {\n          t = 1;\n        }\n      } else {\n        t = val;\n      }\n      if (!bypassMap) {\n        t = tmap(t);\n      }\n      if (_gamma !== 1) {\n        t = pow(t, _gamma);\n      }\n      t = _padding[0] + (t * (1 - _padding[0] - _padding[1]));\n      t = Math.min(1, Math.max(0, t));\n      k = Math.floor(t * 10000);\n      if (_useCache && _colorCache[k]) {\n        col = _colorCache[k];\n      } else {\n        if (type(_colors) === 'array') {\n          for (i = o = 0, ref = _pos.length - 1; 0 <= ref ? o <= ref : o >= ref; i = 0 <= ref ? ++o : --o) {\n            p = _pos[i];\n            if (t <= p) {\n              col = _colors[i];\n              break;\n            }\n            if (t >= p && i === _pos.length - 1) {\n              col = _colors[i];\n              break;\n            }\n            if (t > p && t < _pos[i + 1]) {\n              t = (t - p) / (_pos[i + 1] - p);\n              col = chroma.interpolate(_colors[i], _colors[i + 1], t, _mode);\n              break;\n            }\n          }\n        } else if (type(_colors) === 'function') {\n          col = _colors(t);\n        }\n        if (_useCache) {\n          _colorCache[k] = col;\n        }\n      }\n      return col;\n    };\n    resetCache = function() {\n      return _colorCache = {};\n    };\n    setColors(colors);\n    f = function(v) {\n      var c;\n      c = chroma(getColor(v));\n      if (_out && c[_out]) {\n        return c[_out]();\n      } else {\n        return c;\n      }\n    };\n    f.classes = function(classes) {\n      var d;\n      if (classes != null) {\n        if (type(classes) === 'array') {\n          _classes = classes;\n          _domain = [classes[0], classes[classes.length - 1]];\n        } else {\n          d = chroma.analyze(_domain);\n          if (classes === 0) {\n            _classes = [d.min, d.max];\n          } else {\n            _classes = chroma.limits(d, 'e', classes);\n          }\n        }\n        return f;\n      }\n      return _classes;\n    };\n    f.domain = function(domain) {\n      var c, d, k, len, o, ref, w;\n      if (!arguments.length) {\n        return _domain;\n      }\n      _min = domain[0];\n      _max = domain[domain.length - 1];\n      _pos = [];\n      k = _colors.length;\n      if (domain.length === k && _min !== _max) {\n        for (o = 0, len = domain.length; o < len; o++) {\n          d = domain[o];\n          _pos.push((d - _min) / (_max - _min));\n        }\n      } else {\n        for (c = w = 0, ref = k - 1; 0 <= ref ? w <= ref : w >= ref; c = 0 <= ref ? ++w : --w) {\n          _pos.push(c / (k - 1));\n        }\n      }\n      _domain = [_min, _max];\n      return f;\n    };\n    f.mode = function(_m) {\n      if (!arguments.length) {\n        return _mode;\n      }\n      _mode = _m;\n      resetCache();\n      return f;\n    };\n    f.range = function(colors, _pos) {\n      setColors(colors, _pos);\n      return f;\n    };\n    f.out = function(_o) {\n      _out = _o;\n      return f;\n    };\n    f.spread = function(val) {\n      if (!arguments.length) {\n        return _spread;\n      }\n      _spread = val;\n      return f;\n    };\n    f.correctLightness = function(v) {\n      if (v == null) {\n        v = true;\n      }\n      _correctLightness = v;\n      resetCache();\n      if (_correctLightness) {\n        tmap = function(t) {\n          var L0, L1, L_actual, L_diff, L_ideal, max_iter, pol, t0, t1;\n          L0 = getColor(0, true).lab()[0];\n          L1 = getColor(1, true).lab()[0];\n          pol = L0 > L1;\n          L_actual = getColor(t, true).lab()[0];\n          L_ideal = L0 + (L1 - L0) * t;\n          L_diff = L_actual - L_ideal;\n          t0 = 0;\n          t1 = 1;\n          max_iter = 20;\n          while (Math.abs(L_diff) > 1e-2 && max_iter-- > 0) {\n            (function() {\n              if (pol) {\n                L_diff *= -1;\n              }\n              if (L_diff < 0) {\n                t0 = t;\n                t += (t1 - t) * 0.5;\n              } else {\n                t1 = t;\n                t += (t0 - t) * 0.5;\n              }\n              L_actual = getColor(t, true).lab()[0];\n              return L_diff = L_actual - L_ideal;\n            })();\n          }\n          return t;\n        };\n      } else {\n        tmap = function(t) {\n          return t;\n        };\n      }\n      return f;\n    };\n    f.padding = function(p) {\n      if (p != null) {\n        if (type(p) === 'number') {\n          p = [p, p];\n        }\n        _padding = p;\n        return f;\n      } else {\n        return _padding;\n      }\n    };\n    f.colors = function(numColors, out) {\n      var dd, dm, i, o, ref, result, results, samples, w;\n      if (arguments.length < 2) {\n        out = 'hex';\n      }\n      result = [];\n      if (arguments.length === 0) {\n        result = _colors.slice(0);\n      } else if (numColors === 1) {\n        result = [f(0.5)];\n      } else if (numColors > 1) {\n        dm = _domain[0];\n        dd = _domain[1] - dm;\n        result = (function() {\n          results = [];\n          for (var o = 0; 0 <= numColors ? o < numColors : o > numColors; 0 <= numColors ? o++ : o--){ results.push(o); }\n          return results;\n        }).apply(this).map(function(i) {\n          return f(dm + i / (numColors - 1) * dd);\n        });\n      } else {\n        colors = [];\n        samples = [];\n        if (_classes && _classes.length > 2) {\n          for (i = w = 1, ref = _classes.length; 1 <= ref ? w < ref : w > ref; i = 1 <= ref ? ++w : --w) {\n            samples.push((_classes[i - 1] + _classes[i]) * 0.5);\n          }\n        } else {\n          samples = _domain;\n        }\n        result = samples.map(function(v) {\n          return f(v);\n        });\n      }\n      if (chroma[out]) {\n        result = result.map(function(c) {\n          return c[out]();\n        });\n      }\n      return result;\n    };\n    f.cache = function(c) {\n      if (c != null) {\n        _useCache = c;\n        return f;\n      } else {\n        return _useCache;\n      }\n    };\n    f.gamma = function(g) {\n      if (g != null) {\n        _gamma = g;\n        return f;\n      } else {\n        return _gamma;\n      }\n    };\n    f.nodata = function(d) {\n      if (d != null) {\n        _nacol = chroma(d);\n        return f;\n      } else {\n        return _nacol;\n      }\n    };\n    return f;\n  };\n\n  if (chroma.scales == null) {\n    chroma.scales = {};\n  }\n\n  chroma.scales.cool = function() {\n    return chroma.scale([chroma.hsl(180, 1, .9), chroma.hsl(250, .7, .4)]);\n  };\n\n  chroma.scales.hot = function() {\n    return chroma.scale(['#000', '#f00', '#ff0', '#fff'], [0, .25, .75, 1]).mode('rgb');\n  };\n\n  chroma.analyze = function(data, key, filter) {\n    var add, k, len, o, r, val, visit;\n    r = {\n      min: Number.MAX_VALUE,\n      max: Number.MAX_VALUE * -1,\n      sum: 0,\n      values: [],\n      count: 0\n    };\n    if (filter == null) {\n      filter = function() {\n        return true;\n      };\n    }\n    add = function(val) {\n      if ((val != null) && !isNaN(val)) {\n        r.values.push(val);\n        r.sum += val;\n        if (val < r.min) {\n          r.min = val;\n        }\n        if (val > r.max) {\n          r.max = val;\n        }\n        r.count += 1;\n      }\n    };\n    visit = function(val, k) {\n      if (filter(val, k)) {\n        if ((key != null) && type(key) === 'function') {\n          return add(key(val));\n        } else if ((key != null) && type(key) === 'string' || type(key) === 'number') {\n          return add(val[key]);\n        } else {\n          return add(val);\n        }\n      }\n    };\n    if (type(data) === 'array') {\n      for (o = 0, len = data.length; o < len; o++) {\n        val = data[o];\n        visit(val);\n      }\n    } else {\n      for (k in data) {\n        val = data[k];\n        visit(val, k);\n      }\n    }\n    r.domain = [r.min, r.max];\n    r.limits = function(mode, num) {\n      return chroma.limits(r, mode, num);\n    };\n    return r;\n  };\n\n  chroma.limits = function(data, mode, num) {\n    var aa, ab, ac, ad, ae, af, ag, ah, ai, aj, ak, al, am, assignments, best, centroids, cluster, clusterSizes, dist, i, j, kClusters, limits, max_log, min, min_log, mindist, n, nb_iters, newCentroids, o, p, pb, pr, ref, ref1, ref10, ref11, ref12, ref13, ref14, ref2, ref3, ref4, ref5, ref6, ref7, ref8, ref9, repeat, sum, tmpKMeansBreaks, v, value, values, w;\n    if (mode == null) {\n      mode = 'equal';\n    }\n    if (num == null) {\n      num = 7;\n    }\n    if (type(data) === 'array') {\n      data = chroma.analyze(data);\n    }\n    min = data.min;\n    max = data.max;\n    sum = data.sum;\n    values = data.values.sort(function(a, b) {\n      return a - b;\n    });\n    if (num === 1) {\n      return [min, max];\n    }\n    limits = [];\n    if (mode.substr(0, 1) === 'c') {\n      limits.push(min);\n      limits.push(max);\n    }\n    if (mode.substr(0, 1) === 'e') {\n      limits.push(min);\n      for (i = o = 1, ref = num - 1; 1 <= ref ? o <= ref : o >= ref; i = 1 <= ref ? ++o : --o) {\n        limits.push(min + (i / num) * (max - min));\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'l') {\n      if (min <= 0) {\n        throw 'Logarithmic scales are only possible for values > 0';\n      }\n      min_log = Math.LOG10E * log(min);\n      max_log = Math.LOG10E * log(max);\n      limits.push(min);\n      for (i = w = 1, ref1 = num - 1; 1 <= ref1 ? w <= ref1 : w >= ref1; i = 1 <= ref1 ? ++w : --w) {\n        limits.push(pow(10, min_log + (i / num) * (max_log - min_log)));\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'q') {\n      limits.push(min);\n      for (i = aa = 1, ref2 = num - 1; 1 <= ref2 ? aa <= ref2 : aa >= ref2; i = 1 <= ref2 ? ++aa : --aa) {\n        p = (values.length - 1) * i / num;\n        pb = floor(p);\n        if (pb === p) {\n          limits.push(values[pb]);\n        } else {\n          pr = p - pb;\n          limits.push(values[pb] * (1 - pr) + values[pb + 1] * pr);\n        }\n      }\n      limits.push(max);\n    } else if (mode.substr(0, 1) === 'k') {\n\n      /*\n      implementation based on\n      http://code.google.com/p/figue/source/browse/trunk/figue.js#336\n      simplified for 1-d input values\n       */\n      n = values.length;\n      assignments = new Array(n);\n      clusterSizes = new Array(num);\n      repeat = true;\n      nb_iters = 0;\n      centroids = null;\n      centroids = [];\n      centroids.push(min);\n      for (i = ab = 1, ref3 = num - 1; 1 <= ref3 ? ab <= ref3 : ab >= ref3; i = 1 <= ref3 ? ++ab : --ab) {\n        centroids.push(min + (i / num) * (max - min));\n      }\n      centroids.push(max);\n      while (repeat) {\n        for (j = ac = 0, ref4 = num - 1; 0 <= ref4 ? ac <= ref4 : ac >= ref4; j = 0 <= ref4 ? ++ac : --ac) {\n          clusterSizes[j] = 0;\n        }\n        for (i = ad = 0, ref5 = n - 1; 0 <= ref5 ? ad <= ref5 : ad >= ref5; i = 0 <= ref5 ? ++ad : --ad) {\n          value = values[i];\n          mindist = Number.MAX_VALUE;\n          for (j = ae = 0, ref6 = num - 1; 0 <= ref6 ? ae <= ref6 : ae >= ref6; j = 0 <= ref6 ? ++ae : --ae) {\n            dist = abs(centroids[j] - value);\n            if (dist < mindist) {\n              mindist = dist;\n              best = j;\n            }\n          }\n          clusterSizes[best]++;\n          assignments[i] = best;\n        }\n        newCentroids = new Array(num);\n        for (j = af = 0, ref7 = num - 1; 0 <= ref7 ? af <= ref7 : af >= ref7; j = 0 <= ref7 ? ++af : --af) {\n          newCentroids[j] = null;\n        }\n        for (i = ag = 0, ref8 = n - 1; 0 <= ref8 ? ag <= ref8 : ag >= ref8; i = 0 <= ref8 ? ++ag : --ag) {\n          cluster = assignments[i];\n          if (newCentroids[cluster] === null) {\n            newCentroids[cluster] = values[i];\n          } else {\n            newCentroids[cluster] += values[i];\n          }\n        }\n        for (j = ah = 0, ref9 = num - 1; 0 <= ref9 ? ah <= ref9 : ah >= ref9; j = 0 <= ref9 ? ++ah : --ah) {\n          newCentroids[j] *= 1 / clusterSizes[j];\n        }\n        repeat = false;\n        for (j = ai = 0, ref10 = num - 1; 0 <= ref10 ? ai <= ref10 : ai >= ref10; j = 0 <= ref10 ? ++ai : --ai) {\n          if (newCentroids[j] !== centroids[i]) {\n            repeat = true;\n            break;\n          }\n        }\n        centroids = newCentroids;\n        nb_iters++;\n        if (nb_iters > 200) {\n          repeat = false;\n        }\n      }\n      kClusters = {};\n      for (j = aj = 0, ref11 = num - 1; 0 <= ref11 ? aj <= ref11 : aj >= ref11; j = 0 <= ref11 ? ++aj : --aj) {\n        kClusters[j] = [];\n      }\n      for (i = ak = 0, ref12 = n - 1; 0 <= ref12 ? ak <= ref12 : ak >= ref12; i = 0 <= ref12 ? ++ak : --ak) {\n        cluster = assignments[i];\n        kClusters[cluster].push(values[i]);\n      }\n      tmpKMeansBreaks = [];\n      for (j = al = 0, ref13 = num - 1; 0 <= ref13 ? al <= ref13 : al >= ref13; j = 0 <= ref13 ? ++al : --al) {\n        tmpKMeansBreaks.push(kClusters[j][0]);\n        tmpKMeansBreaks.push(kClusters[j][kClusters[j].length - 1]);\n      }\n      tmpKMeansBreaks = tmpKMeansBreaks.sort(function(a, b) {\n        return a - b;\n      });\n      limits.push(tmpKMeansBreaks[0]);\n      for (i = am = 1, ref14 = tmpKMeansBreaks.length - 1; am <= ref14; i = am += 2) {\n        v = tmpKMeansBreaks[i];\n        if (!isNaN(v) && limits.indexOf(v) === -1) {\n          limits.push(v);\n        }\n      }\n    }\n    return limits;\n  };\n\n  hsi2rgb = function(h, s, i) {\n\n    /*\n    borrowed from here:\n    http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/hsi2rgb.cpp\n     */\n    var args, b, g, r;\n    args = unpack(arguments);\n    h = args[0], s = args[1], i = args[2];\n    if (isNaN(h)) {\n      h = 0;\n    }\n    h /= 360;\n    if (h < 1 / 3) {\n      b = (1 - s) / 3;\n      r = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      g = 1 - (b + r);\n    } else if (h < 2 / 3) {\n      h -= 1 / 3;\n      r = (1 - s) / 3;\n      g = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      b = 1 - (r + g);\n    } else {\n      h -= 2 / 3;\n      g = (1 - s) / 3;\n      b = (1 + s * cos(TWOPI * h) / cos(PITHIRD - TWOPI * h)) / 3;\n      r = 1 - (g + b);\n    }\n    r = limit(i * r * 3);\n    g = limit(i * g * 3);\n    b = limit(i * b * 3);\n    return [r * 255, g * 255, b * 255, args.length > 3 ? args[3] : 1];\n  };\n\n  rgb2hsi = function() {\n\n    /*\n    borrowed from here:\n    http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/rgb2hsi.cpp\n     */\n    var b, g, h, i, min, r, ref, s;\n    ref = unpack(arguments), r = ref[0], g = ref[1], b = ref[2];\n    TWOPI = Math.PI * 2;\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    min = Math.min(r, g, b);\n    i = (r + g + b) / 3;\n    s = 1 - min / i;\n    if (s === 0) {\n      h = 0;\n    } else {\n      h = ((r - g) + (r - b)) / 2;\n      h /= Math.sqrt((r - g) * (r - g) + (r - b) * (g - b));\n      h = Math.acos(h);\n      if (b > g) {\n        h = TWOPI - h;\n      }\n      h /= TWOPI;\n    }\n    return [h * 360, s, i];\n  };\n\n  chroma.hsi = function() {\n    return (function(func, args, ctor) {\n      ctor.prototype = func.prototype;\n      var child = new ctor, result = func.apply(child, args);\n      return Object(result) === result ? result : child;\n    })(Color, slice.call(arguments).concat(['hsi']), function(){});\n  };\n\n  _input.hsi = hsi2rgb;\n\n  Color.prototype.hsi = function() {\n    return rgb2hsi(this._rgb);\n  };\n\n  interpolate_hsx = function(col1, col2, f, m) {\n    var dh, hue, hue0, hue1, lbv, lbv0, lbv1, res, sat, sat0, sat1, xyz0, xyz1;\n    if (m === 'hsl') {\n      xyz0 = col1.hsl();\n      xyz1 = col2.hsl();\n    } else if (m === 'hsv') {\n      xyz0 = col1.hsv();\n      xyz1 = col2.hsv();\n    } else if (m === 'hcg') {\n      xyz0 = col1.hcg();\n      xyz1 = col2.hcg();\n    } else if (m === 'hsi') {\n      xyz0 = col1.hsi();\n      xyz1 = col2.hsi();\n    } else if (m === 'lch' || m === 'hcl') {\n      m = 'hcl';\n      xyz0 = col1.hcl();\n      xyz1 = col2.hcl();\n    }\n    if (m.substr(0, 1) === 'h') {\n      hue0 = xyz0[0], sat0 = xyz0[1], lbv0 = xyz0[2];\n      hue1 = xyz1[0], sat1 = xyz1[1], lbv1 = xyz1[2];\n    }\n    if (!isNaN(hue0) && !isNaN(hue1)) {\n      if (hue1 > hue0 && hue1 - hue0 > 180) {\n        dh = hue1 - (hue0 + 360);\n      } else if (hue1 < hue0 && hue0 - hue1 > 180) {\n        dh = hue1 + 360 - hue0;\n      } else {\n        dh = hue1 - hue0;\n      }\n      hue = hue0 + f * dh;\n    } else if (!isNaN(hue0)) {\n      hue = hue0;\n      if ((lbv1 === 1 || lbv1 === 0) && m !== 'hsv') {\n        sat = sat0;\n      }\n    } else if (!isNaN(hue1)) {\n      hue = hue1;\n      if ((lbv0 === 1 || lbv0 === 0) && m !== 'hsv') {\n        sat = sat1;\n      }\n    } else {\n      hue = Number.NaN;\n    }\n    if (sat == null) {\n      sat = sat0 + f * (sat1 - sat0);\n    }\n    lbv = lbv0 + f * (lbv1 - lbv0);\n    return res = chroma[m](hue, sat, lbv);\n  };\n\n  _interpolators = _interpolators.concat((function() {\n    var len, o, ref, results;\n    ref = ['hsv', 'hsl', 'hsi', 'hcl', 'lch', 'hcg'];\n    results = [];\n    for (o = 0, len = ref.length; o < len; o++) {\n      m = ref[o];\n      results.push([m, interpolate_hsx]);\n    }\n    return results;\n  })());\n\n  interpolate_num = function(col1, col2, f, m) {\n    var n1, n2;\n    n1 = col1.num();\n    n2 = col2.num();\n    return chroma.num(n1 + (n2 - n1) * f, 'num');\n  };\n\n  _interpolators.push(['num', interpolate_num]);\n\n  interpolate_lab = function(col1, col2, f, m) {\n    var res, xyz0, xyz1;\n    xyz0 = col1.lab();\n    xyz1 = col2.lab();\n    return res = new Color(xyz0[0] + f * (xyz1[0] - xyz0[0]), xyz0[1] + f * (xyz1[1] - xyz0[1]), xyz0[2] + f * (xyz1[2] - xyz0[2]), m);\n  };\n\n  _interpolators.push(['lab', interpolate_lab]);\n\n}).call(this);\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\n// Singleton `WeakMap`s to store metadata for td/th elements, as well as the\n// datagrids themselves for each `<perspective-viewer>`\nexport const METADATA_MAP = new WeakMap();\n\n// Output runtime debug info like FPS.\nexport const DEBUG = true;\n\n// The largest size virtual <div> in (px) that Chrome can support without\n// glitching.\nconst isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\nexport const BROWSER_MAX_HEIGHT = isFirefox ? 5000000 : 10000000;\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\n/******************************************************************************\n *\n * Profling\n *\n */\n\nlet AVG = 0,\n    TOTAL = 0,\n    START = performance.now();\n\nexport function get_draw_fps() {\n    const now = performance.now();\n    const elapsed = now - START;\n    const avg = AVG;\n    const real_fps = (TOTAL * 1000) / elapsed;\n    const virtual_fps = 1000 / avg;\n    const num_frames = TOTAL;\n    AVG = 0;\n    TOTAL = 0;\n    START = now;\n    return { avg, real_fps, virtual_fps, num_frames, elapsed };\n}\n\nexport function log_perf(x) {\n    AVG = (AVG * TOTAL + x) / (TOTAL + 1);\n    TOTAL += 1;\n}\n\n/******************************************************************************\n *\n * Utils\n *\n */\n\n/**\n * A class method decorate for memoizing method results.  Only works on one\n * arg.\n */\nexport function memoize(_target, _property, descriptor) {\n    const cache = new Map();\n    const func = descriptor.value;\n    descriptor.value = new_func;\n    return descriptor;\n    function new_func(arg) {\n        if (cache.has(arg)) {\n            return cache.get(arg);\n        } else {\n            const res = func.call(this, arg);\n            cache.set(arg, res);\n            return res;\n        }\n    }\n}\n\n/**\n * Identical to a non-tagger template literal, this is only used to indicate to\n * babel that this string should be HTML-minified on production builds.\n */\nexport const html = (strings, ...args) =>\n    strings\n        .map((str, i) => [str, args[i]])\n        .flat()\n        .filter((a) => !!a)\n        .join(\"\");\n\nconst invertPromise = () => {\n    let _resolve;\n    const promise = new Promise((resolve) => {\n        _resolve = resolve;\n    });\n    promise.resolve = _resolve;\n    return promise;\n};\nconst TAGS = new Map();\n\nexport async function flush_tag(tag) {\n    await new Promise(requestAnimationFrame);\n    return await TAGS.get(tag);\n}\n\nexport async function throttle_tag(tag, f) {\n    if (TAGS.has(tag)) {\n        await TAGS.get(tag);\n        if (TAGS.has(tag)) {\n            await TAGS.get(tag);\n            return;\n        }\n    }\n\n    TAGS.set(tag, invertPromise());\n    try {\n        return await f();\n    } finally {\n        const l = TAGS.get(tag);\n        TAGS.delete(tag);\n        l.resolve();\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport { log_perf, html, throttle_tag, flush_tag } from \"./utils\";\nimport { DEBUG, BROWSER_MAX_HEIGHT } from \"./constants\";\n\nimport container_css from \"../../dist/css/container.css\";\nimport sub_cell_offsets from \"../../dist/css/sub-cell-offsets.css\";\n\n/**\n * Handles the virtual scroll pane, as well as the double buffering\n * of the underlying <table>. This DOM structure looks a little like\n * this:\n *\n *     +------------------------+      <- regular-table\n *     | +----------------------|------<- div.rt-virtual-panel\n *     | | +------------------+ |      <- div.rt-scroll-table-clip\n *     | | | +----------------|-|--+   <- table             |\n *     | | | | 1  A  Alabama  | |  |                        |\n *     | | | | 2  B  Arizona  | |  |                        |\n *     | | | | 3  C  Arkansas | |  |                        |\n *     | | | | 4  D  Californi| |  |                        |\n *     | | | | 5  E  Colorado | |  |                        |\n *     | | +------------------+ |  |                        |\n *     +------------------------+  |                        |\n *       |   | 8  H  District of C |                        |\n *       |   +---------------------+                        |\n *       |                                                  |\n *       |                                                  |\n *       |                                                  |\n *       |                                                  |\n *       |                                                  |\n *       +--------------------------------------------------+\n *\n * `overflow: auto` is applied to `.rt-scroll-container`, and `.rt-virtual-pane`\n * is sized to match the estimated \"virtual\" size of the `table`;  estimated,\n * because it's true size can't be known until all columns dimensions are known,\n * which may be deferred in the case of auto-sized tables.\n *\n * Double buffering can be enabled on \"column scroll\", \"row scroll\" and/or\n * \"column schema change\".  When enabled and a redraw is requested for the case,\n * the existing table is cloned with `cloneNode()` and swapped with the real\n * `table`, which is then updated offscreen and swapped back in.  While this is\n * much slower to render, it prevents draw-in.\n *\n * @class RegularVirtualTableViewModel\n */\nexport class RegularVirtualTableViewModel extends HTMLElement {\n    /**\n     * Create the DOM for this `shadowRoot`.\n     *\n     * TODO deprecated\n     * `MATERIAL_STYLE` is needed both here, and in the document `<head>`, due\n     * to double buffering, which may read incorrect position/size values as the\n     * double buffered `<table>` is rendered in the shadow DOM before being\n     * swapped in.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     */\n    create_shadow_dom() {\n        this.attachShadow({ mode: \"open\" });\n        const slot = `<slot></slot>`;\n\n        // nosemgrep\n        this.shadowRoot.innerHTML = html`\n            <style>\n                ${container_css}\n            </style>\n            <style>\n                ${sub_cell_offsets}\n            </style>\n            <div class=\"rt-virtual-panel\"></div>\n            <div class=\"rt-scroll-table-clip\">\n                ${slot}\n            </div>\n        `;\n\n        const [, style, virtual_panel, table_clip] = this.shadowRoot.children;\n        this._sub_cell_style = style;\n        this._table_clip = table_clip;\n        this._virtual_panel = virtual_panel;\n        this._setup_virtual_scroll();\n    }\n\n    _setup_virtual_scroll() {\n        if (this._table_clip) {\n            if (this._virtual_mode === \"both\" || this._virtual_mode === \"vertical\") {\n                this._table_clip.style.top = \"0px\";\n            } else {\n                this._table_clip.style.removeProperty(\"top\");\n            }\n\n            if (this._virtual_mode === \"both\" || this._virtual_mode === \"horizontal\") {\n                this._table_clip.style.left = \"0px\";\n            } else {\n                this._table_clip.style.removeProperty(\"left\");\n            }\n\n            if (this._virtual_mode !== \"both\") {\n                this._table_clip.style.contain = \"none\";\n            } else {\n                this._table_clip.style.removeProperty(\"contain\");\n            }\n        }\n    }\n\n    /**\n     * Calculates the `viewport` argument for perspective's `to_columns` method.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} nrows\n     * @returns\n     */\n    _calculate_viewport(nrows, num_columns) {\n        const { start_row, end_row } = this._calculate_row_range(nrows);\n        const { start_col, end_col } = this._calculate_column_range(num_columns);\n        this._nrows = nrows;\n        return { start_col, end_col, start_row, end_row };\n    }\n\n    /**\n     * Calculate `start_row` and `end_row` for the viewport.  We do this by\n     * first calculating `total_scroll_height`, the px height of the\n     * scrollable page, from the `_virtual_panel.offsetHeight`.\n     *\n     *    0px +------------+-------------+  - virtual_panel.offsetHeight\n     *        |            |  .          |  . 600px\n     *        |  viewport  |  .          |  .\n     *        |            |  .          |  .\n     *  200px +------------+  - height   |  .  - total_scroll_height\n     *        |                 200px    |  .  . 400px\n     *        |                          |  .  .\n     *        |                          |  .  .\n     *        |                          |  .  .\n     *        |                          |  .  .\n     *  600px +--------------------------+  -  -\n     *\n     *  `percent_scroll` can be calculated from this value and `scrollTop`,\n     *  which we can then apply to the new calculated height to preserve scroll\n     *  position when the height has changed since previous render.\n     *\n     *    0px +--------------------------+  -\n     *        |                          |  .\n     *        |                          |  .\n     *        |                          |  . scrollable area\n     *  300px +------------+             |  .\n     *        |            |             |  .\n     *  - - - |  viewport  | - - - - - - |  - total_scroll_height\n     *        |            |             |    400px\n     *  500px +------------+             |\n     *        |                          |\n     *  600px +--------------------------+\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} nrows\n     * @returns\n     */\n    _calculate_row_range(nrows) {\n        const { height } = this._container_size;\n        const row_height = this._column_sizes.row_height || 19;\n        const header_levels = this._view_cache.config.column_pivots.length;\n        const total_scroll_height = Math.max(1, this._virtual_panel.offsetHeight - this.clientHeight);\n        const percent_scroll = Math.max(Math.ceil(this.scrollTop), 0) / total_scroll_height;\n        const virtual_panel_row_height = height / row_height - header_levels;\n        const relative_nrows = nrows || 0;\n        const scroll_rows = Math.max(0, Math.ceil(relative_nrows - virtual_panel_row_height));\n        const start_row = scroll_rows * percent_scroll;\n        const end_row = Math.max(0, Math.min(start_row + virtual_panel_row_height, nrows));\n        return { start_row, end_row };\n    }\n\n    _calc_start_column() {\n        const scroll_index_offset = this._view_cache.config.row_pivots.length;\n        let start_col = 0;\n        let offset_width = 0;\n        let diff = 0;\n        while (offset_width < this.scrollLeft) {\n            const new_val = this._column_sizes.indices[start_col + scroll_index_offset];\n            diff = this.scrollLeft - offset_width;\n            start_col += 1;\n            offset_width += new_val !== undefined ? new_val : 60;\n        }\n\n        start_col += diff / (this._column_sizes.indices[start_col + scroll_index_offset - 1] || 60);\n        return Math.max(0, start_col - 1);\n    }\n\n    /**\n     * Calculates `start_col` and `end_col` for the viewport - most of the\n     * details of which are actually calculated in `_max_column`, the equivalent\n     * of `total_scroll_height` from `_calculate_row_range`.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @returns\n     */\n    _calculate_column_range(num_columns) {\n        if (this._virtual_mode === \"none\" || this._virtual_mode === \"vertical\") {\n            return { start_col: 0, end_col: Infinity };\n        } else {\n            const start_col = this._calc_start_column();\n            const vis_cols = this.table_model.num_columns() || Math.min(num_columns, Math.ceil(this._container_size.width / 60));\n            let end_col = start_col + vis_cols + 1;\n            return { start_col, end_col };\n        }\n    }\n\n    /**\n     * Calculates the minimum possible starting column index for which the last\n     * column is completely visible (e.g. not occluded by the container clip).\n     * This is assumed to be the # of columns until the column widths are\n     * calculated as they are scrolled into view by the user, which requires\n     * special synchronization with _update_virtual_panel_width`\n     * as the scrollable width will change as the user scrolls left to right.\n     *\n     * Once `_column_sizes.indices` has enough column widths populated from\n     * user scrolling, it calulates the cumulative sum of column widths from\n     * last visible column backwards, until the sum is larger than the viewport\n     * px width, which is 1 below the max scroll column\n     *\n     *               width = 290   = 210     = 100    = 0\n     *   0px               V       V         V        500px\n     *   +-----------------+-------+---------+--------+\n     *   | ..ol B) (Col C) | Col D | Col E   | Col F  |\n     *   |                 | 80px  | 110px   | 100px  |\n     *   |                 |       |         |        |\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @returns\n     */\n    _max_scroll_column(num_columns) {\n        let width = 0;\n        if (this._view_cache.config.row_pivots.length > 0) {\n            for (const w of this._column_sizes.indices.slice(0, this._view_cache.config.row_pivots.length)) {\n                width += w;\n            }\n        }\n        let scroll_index_offset = this._view_cache.config.row_pivots.length;\n        let max_scroll_column = num_columns;\n        while (width < this._container_size.width && max_scroll_column >= 0) {\n            max_scroll_column--;\n            width += this._column_sizes.indices[max_scroll_column + scroll_index_offset] || 60;\n        }\n\n        return Math.min(num_columns - 1, max_scroll_column + 1);\n    }\n\n    /**\n     * Determines whether the viewport is identical in row and column axes to\n     * the previous viewport rendered, for throttling identical render requests,\n     * e.g. when the logical (row-wise) viewport does not change, but the pixel\n     * viewport has moved a few px.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} {start_col, end_col, start_row, end_row}\n     * @returns\n     */\n    _validate_viewport({ start_col, end_col, start_row, end_row }) {\n        start_row = Math.floor(start_row);\n        end_row = Math.ceil(end_row);\n        start_col = Math.floor(start_col);\n        end_col = Math.ceil(end_col);\n        const invalid_column = this._start_col !== start_col;\n        const invalid_row = this._start_row !== start_row || this._end_row !== end_row || this._end_col !== end_col;\n        this._start_col = start_col;\n        this._end_col = end_col;\n        this._start_row = start_row;\n        this._end_row = end_row;\n        return { invalid_column, invalid_row };\n    }\n\n    _calc_scrollable_column_width(num_columns) {\n        let scroll_index_offset = this._view_cache.config.row_pivots.length;\n        const max_scroll_column = this._max_scroll_column(num_columns);\n        let cidx = scroll_index_offset,\n            virtual_width = 0;\n\n        while (cidx < max_scroll_column + scroll_index_offset) {\n            virtual_width += this._column_sizes.indices[cidx] || 60;\n            cidx++;\n        }\n\n        return virtual_width;\n    }\n\n    /**\n     * Updates the `virtual_panel` width based on view state.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} invalid\n     */\n    _update_virtual_panel_width(invalid, num_columns) {\n        if (invalid) {\n            if (this._virtual_mode === \"vertical\" || this._virtual_mode === \"none\") {\n                this._virtual_panel.style.width = this._column_sizes.indices.reduce((x, y) => x + y, 0) + \"px\";\n            } else {\n                const virtual_width = this._calc_scrollable_column_width(num_columns);\n                if (virtual_width !== 0) {\n                    const panel_width = this._container_size.width + virtual_width + 2;\n                    this._virtual_panel.style.width = panel_width + \"px\";\n                } else {\n                    this._virtual_panel.style.width = \"1px\";\n                }\n            }\n        }\n    }\n\n    /**\n     * Updates the `virtual_panel` height based on the view state.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} nrows\n     */\n    _update_virtual_panel_height(nrows) {\n        const { row_height = 19 } = this._column_sizes;\n        const header_height = this._view_cache.config.column_pivots.length * row_height;\n        let virtual_panel_px_size;\n        if (this._virtual_mode === \"horizontal\" || this._virtual_mode === \"none\") {\n            virtual_panel_px_size = nrows * row_height + header_height;\n        } else {\n            //const {height} = this._container_size;\n            // TODO use cached height?\n            const zoom_factor = this.clientHeight / (this._table_clip.offsetHeight - header_height);\n            virtual_panel_px_size = Math.min(BROWSER_MAX_HEIGHT, nrows * row_height * zoom_factor);\n        }\n        this._virtual_panel.style.height = `${virtual_panel_px_size}px`;\n    }\n\n    /**\n     * Draws this virtual panel, given an object of render options that allow\n     * the implementor to fine tune the individual render frames based on the\n     * interaction and previous render state.\n     *\n     * @public\n     * @memberof RegularVirtualTableViewModel\n     * @param {DrawOptions} [options]\n     * @param {boolean} [options.invalid_viewport=true]\n     * @param {boolean} [options.preserve_width=false]\n     * @param {boolean} [options.throttle=true]\n     */\n    async draw(options = {}) {\n        if (typeof options.throttle !== \"undefined\" && !options.throttle) {\n            return await internal_draw.call(this, options);\n        } else {\n            return await throttle_tag(this, () => internal_draw.call(this, options));\n        }\n    }\n\n    async _draw_flush() {\n        await flush_tag(this);\n    }\n\n    update_sub_cell_offset(viewport) {\n        const y_offset = this._column_sizes.row_height * (viewport.start_row % 1) || 0;\n        const x_offset = this._column_sizes.indices[(this.table_model._row_headers_length || 0) + Math.floor(viewport.start_col)] * (viewport.start_col % 1) || 0;\n        let style = this._sub_cell_style.sheet?.cssRules[0].style;\n        if (style) {\n            style.setProperty(`--regular-table--clip-x`, `${x_offset}px`);\n            style.setProperty(`--regular-table--clip-y`, `${y_offset}px`);\n            style.setProperty(`--regular-table--transform-x`, `-${x_offset}px`);\n            style.setProperty(`--regular-table--transform-y`, `-${y_offset}px`);\n        }\n    }\n}\n\nasync function internal_draw(options) {\n    const __debug_start_time__ = DEBUG && performance.now();\n    const { invalid_viewport = true, preserve_width = false } = options;\n    const { num_columns, num_rows, row_height } = await this._view_cache.view(0, 0, 0, 0);\n    this._container_size = {\n        width: this._virtual_mode === \"none\" || this._virtual_mode === \"vertical\" ? Infinity : this._table_clip.clientWidth,\n        height: this._virtual_mode === \"none\" || this._virtual_mode === \"horizontal\" ? Infinity : this._table_clip.clientHeight,\n    };\n\n    this._update_virtual_panel_height(num_rows);\n    if (!preserve_width) {\n        this._update_virtual_panel_width(invalid_viewport, num_columns);\n    }\n    const viewport = this._calculate_viewport(num_rows, num_columns);\n    const { invalid_row, invalid_column } = this._validate_viewport(viewport);\n    if (this._invalid_schema || invalid_row || invalid_column || invalid_viewport) {\n        let autosize_cells = [],\n            needs_sub_cell_update = true;\n        for await (let last_cells of this.table_model.draw(this._container_size, this._view_cache, this._selected_id, preserve_width, viewport, num_columns)) {\n            if (last_cells !== undefined) {\n                autosize_cells = autosize_cells.concat(last_cells);\n            }\n\n            // We want to perform this before the next event loop so there\n            // is no scroll jitter, but only on the first iteration as\n            // subsequent viewports are incorrect.\n            if (needs_sub_cell_update) {\n                this.update_sub_cell_offset(viewport);\n                needs_sub_cell_update = false;\n            }\n\n            this._is_styling = true;\n            const callbacks = this._style_callbacks;\n            for (const callback of callbacks) {\n                await callback({ detail: this });\n            }\n\n            this._is_styling = false;\n            if (!this._invalidated && last_cells !== undefined) {\n                break;\n            }\n\n            this._invalidated = false;\n        }\n\n        this.table_model.autosize_cells(autosize_cells, row_height);\n        this.table_model.header.reset_header_cache();\n        if (!preserve_width) {\n            this._update_virtual_panel_width(this._invalid_schema || invalid_column, num_columns);\n        }\n        this._invalid_schema = false;\n    } else {\n        this.update_sub_cell_offset(viewport);\n    }\n\n    if (DEBUG) {\n        log_perf(performance.now() - __debug_start_time__);\n    }\n}\n\n/**\n * Options for the draw method.\n *\n * @public\n * @typedef DrawOptions\n * @type {object}\n * @property {boolean} [invalid_viewport]\n * @property {boolean} [preserve_width]\n */\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport { METADATA_MAP } from \"./constants\";\nimport { RegularVirtualTableViewModel } from \"./scroll_panel\";\nimport { throttle_tag } from \"./utils\";\n\n/**\n * WHen enabled, override iOS overscroll behavior by emulating scroll position\n * in JavaScript.  This prevents \"bounce\" on edges, but it also removes scroll\n * inertia.  This waspreviously enabled by default in `regular-table<=0.4.3`,\n * but this version also had bugged (exaggerated) position calculation.\n * As `0.5.0` introduces sub-cell scrolling by defualt, this is now disabled by\n * default as well.\n */\nconst IOS_DISABLE_OVERSCROLL = false;\n\n/**\n *\n *\n * @class RegularViewEventModel\n * @extends {RegularVirtualTableViewModel}\n */\nexport class RegularViewEventModel extends RegularVirtualTableViewModel {\n    register_listeners() {\n        // // TODO see `_on_click_or_dblclick` method jsdoc\n        // this.addEventListener(\"dblclick\", this._on_dblclick.bind(this));\n\n        this.addEventListener(\"mousedown\", this._on_click_or_dblclick.bind(this));\n        this.addEventListener(\"scroll\", this._on_scroll.bind(this), {\n            passive: true,\n        });\n\n        this._register_glitch_scroll_listeners();\n    }\n\n    /**\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     * @returns\n     */\n    async _on_scroll(event) {\n        event.stopPropagation();\n        await this.draw({ invalid_viewport: false });\n        this.dispatchEvent(new CustomEvent(\"regular-table-scroll\"));\n    }\n\n    /**\n     * Modern and mobile browsers implement complex scroll behavior to\n     * implement fancy touch and intertia effects;  these must be intercepted\n     * and disabled to achieve clean virtual scrolling in the presence of a\n     * `fixed` element.\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     */\n    _register_glitch_scroll_listeners() {\n        this.addEventListener(\"mousewheel\", this._on_mousewheel.bind(this));\n        if (IOS_DISABLE_OVERSCROLL) {\n            this.addEventListener(\"touchmove\", this._on_touchmove.bind(this));\n            this.addEventListener(\"touchstart\", this._on_touchstart.bind(this), {\n                passive: true,\n            });\n        }\n    }\n    /**\n     * Mousewheel must precalculate in addition to `_on_scroll` to prevent\n     * visual artifacts due to scrolling \"inertia\" on modern browsers.\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     * @param {*} event\n     */\n    _on_mousewheel(event) {\n        if (!window.safari) {\n            // **** Apple\n            return;\n        }\n\n        const { clientWidth, clientHeight, scrollTop, scrollLeft } = this;\n        event.preventDefault();\n        event.returnValue = false;\n        const total_scroll_height = Math.max(1, this._virtual_panel.offsetHeight - clientHeight);\n        const total_scroll_width = Math.max(1, this._virtual_panel.offsetWidth - clientWidth);\n        this.scrollTop = Math.max(0, Math.min(total_scroll_height, scrollTop + event.deltaY));\n        this.scrollLeft = Math.max(0, Math.min(total_scroll_width, scrollLeft + event.deltaX));\n        this._on_scroll(event);\n    }\n\n    /**\n     * Touchmove/touchstart must precalculate in addition to `_on_scroll` to\n     * prevent visual artifacts due to scrolling \"inertia\" on mobile browsers.\n     * This has the unfortunate side-effect of disabling scroll intertia.\n     *\n     * @internal\n     * @private\n     * @memberof RegularViewEventModel\n     * @param {*} event\n     * @returns\n     */\n    _on_touchmove(event) {\n        event.stopPropagation();\n        event.preventDefault();\n        event.returnValue = false;\n        const { clientWidth, clientHeight } = this;\n        const total_scroll_height = Math.max(1, this._virtual_panel.offsetHeight - clientHeight);\n        const total_scroll_width = Math.max(1, this._virtual_panel.offsetWidth - clientWidth);\n        this.scrollTop = Math.min(total_scroll_height, this._memo_scroll_top + (this._memo_touch_startY - event.touches[0].pageY));\n        this.scrollLeft = Math.min(total_scroll_width, this._memo_scroll_left + (this._memo_touch_startX - event.touches[0].pageX));\n        this._on_scroll(event);\n    }\n\n    _on_touchstart(event) {\n        this._memo_touch_startY = event.touches[0].pageY;\n        this._memo_touch_startX = event.touches[0].pageX;\n        this._memo_scroll_top = this.scrollTop;\n        this._memo_scroll_left = this.scrollLeft;\n    }\n\n    /**\n     * Handles double-click header width override reset.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @returns\n     */\n    async _on_dblclick(event) {\n        let element = event.target;\n        while (element.tagName !== \"TD\" && element.tagName !== \"TH\") {\n            element = element.parentElement;\n            if (!this.contains(element)) {\n                return;\n            }\n        }\n\n        const is_resize = event.target.classList.contains(\"rt-column-resize\");\n        const metadata = METADATA_MAP.get(element);\n        if (is_resize) {\n            event.stopImmediatePropagation();\n            // await new Promise(queueMicrotask);\n            element.style.minWidth = \"\";\n            element.style.maxWidth = \"\";\n            if (event.shiftKey) {\n                this._column_sizes.override = [];\n                this._column_sizes.auto = [];\n                this._column_sizes.indices = [];\n            } else {\n                this._column_sizes.override[metadata.size_key] = undefined;\n                this._column_sizes.auto[metadata.size_key] = undefined;\n                this._column_sizes.indices[metadata.size_key] = undefined;\n            }\n\n            for (const row of event.shiftKey ? [this.table_model.header.cells[this.table_model.header.cells.length - 1], ...this.table_model.body.cells] : this.table_model.body.cells) {\n                for (const td of event.shiftKey ? row : [row[metadata._virtual_x]]) {\n                    if (!td) {\n                        continue;\n                    }\n\n                    td.style.minWidth = \"\";\n                    td.style.maxWidth = \"\";\n                    td.classList.remove(\"rt-cell-clip\");\n                }\n            }\n\n            await this.draw();\n        }\n    }\n\n    /**\n     * Dispatches all click events to other handlers, depending on\n     * `event.target`.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @returns\n     */\n    async _on_click(event) {\n        if (event.button !== 0) {\n            return;\n        }\n\n        let element = event.target;\n        while (element.tagName !== \"TD\" && element.tagName !== \"TH\") {\n            element = element.parentElement;\n            if (!this.contains(element)) {\n                return;\n            }\n        }\n\n        const is_resize = event.target.classList.contains(\"rt-column-resize\");\n        const metadata = METADATA_MAP.get(element);\n        if (is_resize) {\n            this._on_resize_column(event, element, metadata);\n            event.stopImmediatePropagation();\n        }\n    }\n\n    /**\n     * `dblclick` event does not work reliably for some reason so dispatch this\n     * event in JavaScript instead.\n     * @param {`*`} event\n     */\n    async _on_click_or_dblclick(event) {\n        const now = performance.now();\n        if (this._last_clicked_time && now - this._last_clicked_time < 500) {\n            this._last_clicked_time = now;\n            await this._on_dblclick(event);\n        } else {\n            this._last_clicked_time = now;\n            await this._on_click(event);\n        }\n    }\n\n    /**\n     * Regular event for column resize.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @param {*} element\n     * @param {*} metadata\n     */\n    _on_resize_column(event, element, metadata) {\n        const { _virtual_x, size_key } = metadata;\n        const start = event.pageX;\n        const header_x = _virtual_x + element.colSpan - 1;\n        const header_element = this.table_model.header.get_column_header(header_x);\n        const width = this._column_sizes.indices[size_key];\n        const move = (event) => throttle_tag(this, async () => await this._on_resize_column_move(event, header_element, start, width, size_key, header_x));\n        const up = () => {\n            document.removeEventListener(\"mousemove\", move);\n            document.removeEventListener(\"mouseup\", up);\n            const override_width = this._column_sizes.override[size_key];\n            const should_redraw = this._column_sizes.indices[size_key] !== override_width;\n            this._column_sizes.indices[size_key] = override_width;\n            if (should_redraw) {\n                this.draw();\n            }\n        };\n\n        document.addEventListener(\"mousemove\", move);\n        document.addEventListener(\"mouseup\", up);\n    }\n\n    /**\n     * Regular event for mouse movement when resizing a column.\n     *\n     * @internal\n     * @private\n     * @memberof RegularVirtualTableViewModel\n     * @param {*} event\n     * @param {*} th\n     * @param {*} start\n     * @param {*} width\n     * @param {*} metadata\n     */\n    async _on_resize_column_move(event, th, start, width, size_key, virtual_x) {\n        await new Promise(requestAnimationFrame);\n        const diff = event.pageX - start;\n        const override_width = Math.max(1, width + diff);\n        this._column_sizes.override[size_key] = override_width;\n\n        // If the column is smaller, new columns may need to be fetched, so\n        // redraw, else just update the DOM widths as if redrawn.\n        if (diff < 0) {\n            await this.draw({ preserve_width: true, throttle: false });\n        } else {\n            th.style.minWidth = override_width + \"px\";\n            th.style.maxWidth = override_width + \"px\";\n            const auto_width = this._column_sizes.auto[size_key];\n            for (const row of this.table_model.body.cells) {\n                const td = row[virtual_x];\n                if (td) {\n                    td.style.maxWidth = td.style.minWidth = override_width + \"px\";\n                    td.classList.toggle(\"rt-cell-clip\", auto_width > override_width);\n                }\n            }\n        }\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport { METADATA_MAP } from \"./constants\";\n\n/******************************************************************************\n *\n * View Model\n *\n */\n\nclass ElemFactory {\n    constructor(name) {\n        this._name = name;\n        this._elements = [];\n        this._index = 0;\n    }\n\n    reset() {\n        this._index = 0;\n    }\n\n    get() {\n        if (!this._elements[this._index]) {\n            this._elements[this._index] = document.createElement(this._name);\n        }\n\n        const elem = this._elements[this._index];\n        this._index += 1;\n        return elem;\n    }\n}\n\nexport class ViewModel {\n    constructor(column_sizes, container, table) {\n        this._column_sizes = column_sizes;\n        this._container = container;\n        this._span_factory = new ElemFactory(\"span\");\n        this.table = table;\n        this.cells = [];\n        this.rows = [];\n    }\n\n    num_columns() {\n        return this._get_row(Math.max(0, this.rows.length - 1)).row_container.length;\n    }\n\n    num_rows() {\n        return this.cells.length;\n    }\n\n    _set_metadata(td, metadata) {\n        METADATA_MAP.set(td, metadata);\n    }\n\n    _get_or_create_metadata(td) {\n        if (td === undefined) {\n            return {};\n        } else if (METADATA_MAP.has(td)) {\n            return METADATA_MAP.get(td);\n        } else {\n            const metadata = {};\n            METADATA_MAP.set(td, metadata);\n            return metadata;\n        }\n    }\n\n    _replace_cell(ridx, cidx) {\n        const { tr, row_container } = this._get_row(ridx);\n        let td = row_container[cidx];\n        if (td) {\n            tr.removeChild(td);\n            row_container.splice(cidx, 1, undefined);\n        }\n        return td;\n    }\n\n    _fetch_cell(ridx, cidx) {\n        if (ridx < 0 || cidx < 0) {\n            return;\n        }\n\n        return this.cells[ridx]?.[cidx];\n    }\n\n    _get_row(ridx) {\n        let tr = this.rows[ridx];\n        if (!tr) {\n            tr = this.rows[ridx] = document.createElement(\"tr\");\n            this.table.appendChild(tr);\n        }\n\n        let row_container = this.cells[ridx];\n        if (!row_container) {\n            row_container = this.cells[ridx] = [];\n        }\n\n        return { tr, row_container };\n    }\n\n    _get_cell(tag = \"TD\", ridx, cidx) {\n        const { tr, row_container } = this._get_row(ridx);\n        let td = row_container[cidx];\n        if (!td) {\n            if (cidx < row_container.length) {\n                td = row_container[cidx] = document.createElement(tag);\n                tr.insertBefore(\n                    td,\n                    row_container.slice(cidx + 1).find((x) => x)\n                );\n            } else {\n                td = row_container[cidx] = document.createElement(tag);\n                tr.appendChild(td);\n            }\n        }\n        if (td.tagName !== tag) {\n            const new_td = document.createElement(tag);\n            tr.replaceChild(new_td, td);\n            this.cells[ridx].splice(cidx, 1, new_td);\n            td = new_td;\n        }\n        return td;\n    }\n\n    _clean_columns(cidx) {\n        for (let i = 0; i < this.rows.length; i++) {\n            const tr = this.rows[i];\n            const row_container = this.cells[i];\n            this.cells[i] = row_container.slice(0, cidx[i] || cidx);\n            const idx = this.cells[i].filter((x) => x !== undefined).length;\n            while (tr.children[idx]) {\n                tr.removeChild(tr.children[idx]);\n            }\n        }\n    }\n\n    _clean_rows(ridx) {\n        while (this.table.children[ridx]) {\n            this.table.removeChild(this.table.children[ridx]);\n        }\n        this.rows = this.rows.slice(0, ridx);\n        this.cells = this.cells.slice(0, ridx);\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport { ViewModel } from \"./view_model\";\n\n/**\n * <thead> view model.  This model accumulates state in the form of\n * column_sizes, which leverages <tables> autosize behavior across\n * virtual pages.\n *\n * @class RegularHeaderViewModel\n */\nexport class RegularHeaderViewModel extends ViewModel {\n    constructor(...args) {\n        super(...args);\n        this._group_header_cache = [];\n        this._offset_cache = [];\n    }\n\n    _draw_group_th(offset_cache, d, column) {\n        const th = this._get_cell(\"TH\", d, offset_cache[d] || 0);\n        offset_cache[d] += 1;\n        th.removeAttribute(\"colspan\");\n        th.style.minWidth = \"0\";\n\n        th.textContent = \"\";\n        if (column instanceof HTMLElement) {\n            th.appendChild(column);\n        } else {\n            const span = this._span_factory.get(\"span\");\n            span.textContent = column;\n            th.appendChild(span);\n        }\n\n        const resizeSpan = this._span_factory.get(\"span\");\n        resizeSpan.className = \"rt-column-resize\";\n        th.appendChild(resizeSpan);\n\n        return th;\n    }\n\n    _draw_group(column, column_name, th) {\n        const metadata = this._get_or_create_metadata(th);\n        metadata.column_header = column;\n        metadata.value = column_name;\n        metadata.value = column_name;\n        return metadata;\n    }\n\n    _draw_th(column, column_name, th, cidx, size_key) {\n        const metadata = this._get_or_create_metadata(th);\n        metadata.column_header = column;\n        metadata.value = column_name;\n        metadata.size_key = size_key.length ? size_key[0] : size_key; // FIXME\n\n        if (!(size_key.length > 1)) {\n            const override_width = this._column_sizes.override[metadata.size_key];\n            const auto_width = this._column_sizes.auto[metadata.size_key];\n            if (override_width) {\n                th.classList.toggle(\"rt-cell-clip\", auto_width > override_width);\n                th.style.minWidth = override_width + \"px\";\n                th.style.maxWidth = override_width + \"px\";\n            } else if (auto_width) {\n                th.classList.remove(\"rt-cell-clip\");\n                th.style.maxWidth = \"\";\n                th.style.minWidth = auto_width + \"px\";\n            } else {\n                th.style.maxWidth = \"\";\n                th.style.maxWidth = \"\";\n            }\n        }\n\n        return metadata;\n    }\n\n    get_column_header(cidx) {\n        return this._get_cell(\"TH\", this.num_rows() - 1, cidx);\n    }\n\n    draw(alias, parts, colspan, x, size_key, x0, _virtual_x, column_header_merge_depth, merge_headers) {\n        const header_levels = parts?.length; //config.column_pivots.length + 1;\n        if (header_levels === 0) return;\n        let th, metadata, column_name;\n        let output = undefined;\n        column_header_merge_depth = typeof column_header_merge_depth === \"undefined\" ? header_levels - 1 : column_header_merge_depth;\n        for (let d = 0; d < header_levels; d++) {\n            column_name = parts[d] ? parts[d] : \"\";\n            this._offset_cache[d] = this._offset_cache[d] || 0;\n\n            if (d < column_header_merge_depth) {\n                if (merge_headers && this._group_header_cache?.[d]?.[0]?.value === column_name) {\n                    th = this._group_header_cache[d][1];\n                    this._group_header_cache[d][2] += 1;\n                    if (colspan === 1) {\n                        this._group_header_cache[d][0].row_header_x = size_key;\n                    }\n                    th.setAttribute(\"colspan\", this._group_header_cache[d][2]);\n                } else {\n                    th = this._draw_group_th(this._offset_cache, d, column_name);\n                    metadata = this._draw_group(parts, column_name, th);\n                    this._group_header_cache[d] = [metadata, th, 1];\n                }\n            } else {\n                th = this._draw_group_th(this._offset_cache, d, column_name);\n\n                // Update the group header's metadata such that each group\n                // header has the same metadata coordinates of its rightmost\n                // column.\n                metadata = this._draw_th(alias || parts, column_name, th, x, size_key);\n                if (typeof output === \"undefined\") {\n                    output = { th, metadata };\n                }\n\n                for (const [group_meta] of this._group_header_cache) {\n                    group_meta.size_key = metadata.size_key;\n                }\n                th.removeAttribute(\"colspan\");\n            }\n\n            this._get_row(d).tr.classList.toggle(\"rt-autosize\", d === column_header_merge_depth);\n            th.classList.toggle(\"rt-group-corner\", x === undefined);\n            if (metadata) {\n                metadata.x = typeof x === \"undefined\" ? x : Math.floor(x);\n                metadata.column_header_y = d;\n                metadata.x0 = Math.floor(x0);\n                metadata._virtual_x = _virtual_x;\n                if (colspan === 1) {\n                    metadata.row_header_x = size_key;\n                }\n            }\n        }\n\n        this._clean_rows(this._offset_cache.length);\n        output = output || { th, metadata };\n        return output;\n    }\n\n    clean() {\n        this._clean_columns(this._offset_cache);\n    }\n\n    reset_header_cache() {\n        this._offset_cache = [];\n        this._group_header_cache = [];\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport { ViewModel } from \"./view_model\";\n\n/**\n * <tbody> view model.\n *\n * @class RegularBodyViewModel\n */\nexport class RegularBodyViewModel extends ViewModel {\n    _draw_td(tagName, ridx, val, cidx, { column_name }, { ridx_offset }, size_key) {\n        const td = this._get_cell(tagName, ridx, cidx);\n        const metadata = this._get_or_create_metadata(td);\n        metadata.y = ridx + Math.floor(ridx_offset);\n        metadata.size_key = size_key;\n        if (tagName === \"TD\") {\n            metadata.column_header = column_name;\n        }\n        const override_width = this._column_sizes.override[metadata.size_key];\n        if (override_width) {\n            const auto_width = this._column_sizes.auto[metadata.size_key];\n            td.classList.toggle(\"rt-cell-clip\", auto_width > override_width);\n            td.style.minWidth = override_width + \"px\";\n            td.style.maxWidth = override_width + \"px\";\n        } else {\n            td.classList.remove(\"rt-cell-clip\");\n            td.style.minWidth = \"\";\n            td.style.maxWidth = \"\";\n        }\n\n        if (metadata.value !== val) {\n            if (val instanceof HTMLElement) {\n                td.textContent = \"\";\n                td.appendChild(val);\n            } else {\n                td.textContent = val;\n            }\n        }\n\n        metadata.value = val;\n        return { td, metadata };\n    }\n\n    draw(container_height, column_state, view_state, th = false, x, x0, size_key, merge_headers) {\n        const { cidx, column_data, row_headers, column_data_listener_metadata } = column_state;\n        let { row_height } = view_state;\n        let metadata;\n        const ridx_offset = [],\n            tds = [];\n        let ridx = 0;\n        const cidx_offset = [];\n        for (let i = 0; i < (th ? view_state.row_headers_length : 1); i++) {\n            ridx = 0;\n\n            for (const val of column_data) {\n                const id = row_headers?.[ridx];\n                let obj;\n                if (th) {\n                    const row_header = val[i];\n                    const prev_row = this._fetch_cell(ridx - (ridx_offset[i] || 1), cidx + i);\n                    const prev_row_metadata = this._get_or_create_metadata(prev_row);\n\n                    const prev_col = this._fetch_cell(ridx, cidx + i - (cidx_offset[ridx] || 1));\n                    const prev_col_metadata = this._get_or_create_metadata(prev_col);\n\n                    if (merge_headers && prev_col && (prev_col_metadata.value === row_header || row_header === undefined) && !prev_col.hasAttribute(\"rowspan\")) {\n                        cidx_offset[ridx] = cidx_offset[ridx] ? cidx_offset[ridx] + 1 : 2;\n                        prev_col.setAttribute(\"colspan\", cidx_offset[ridx]);\n                        this._replace_cell(ridx, cidx + i);\n                    } else if (merge_headers && prev_row && prev_row_metadata.value === row_header && !prev_row.hasAttribute(\"colspan\")) {\n                        ridx_offset[i] = ridx_offset[i] ? ridx_offset[i] + 1 : 2;\n                        prev_row.setAttribute(\"rowspan\", ridx_offset[i]);\n                        this._replace_cell(ridx, cidx + i);\n                    } else {\n                        obj = this._draw_td(\"TH\", ridx, row_header, cidx + i, column_state, view_state, i);\n                        obj.td.style.display = \"\";\n                        obj.td.removeAttribute(\"rowspan\");\n                        obj.td.removeAttribute(\"colspan\");\n                        obj.metadata.row_header = val;\n                        obj.metadata.row_header_x = i;\n                        obj.metadata.y0 = Math.floor(view_state.ridx_offset);\n                        obj.metadata.y1 = Math.ceil(view_state.y1);\n                        obj.metadata._virtual_x = i;\n                        if (typeof x0 !== \"undefined\") {\n                            obj.metadata.x0 = Math.floor(x0);\n                        }\n                        ridx_offset[i] = 1;\n                        cidx_offset[ridx] = 1;\n                        tds[i] = obj;\n                    }\n                } else {\n                    obj = this._draw_td(\"TD\", ridx, val, cidx, column_state, view_state, size_key);\n                    if (column_data_listener_metadata) {\n                        obj.metadata.user = column_data_listener_metadata[ridx];\n                    }\n\n                    obj.metadata.x = typeof x === \"undefined\" ? x : Math.floor(x);\n                    obj.metadata.x1 = Math.ceil(view_state.x1);\n                    obj.metadata.row_header = id || [];\n                    obj.metadata.y0 = Math.floor(view_state.ridx_offset);\n                    obj.metadata.y1 = Math.ceil(view_state.y1);\n                    obj.metadata.dx = Math.floor(x - x0);\n                    obj.metadata.dy = obj.metadata.y - Math.floor(obj.metadata.y0);\n                    obj.metadata._virtual_x = cidx;\n                    if (typeof x0 !== \"undefined\") {\n                        obj.metadata.x0 = Math.floor(x0);\n                    }\n\n                    tds[0] = obj;\n                }\n\n                ridx++;\n                metadata = obj ? obj.metadata : metadata;\n                row_height = row_height || obj?.td.offsetHeight;\n                if (ridx * row_height > container_height) {\n                    break;\n                }\n            }\n        }\n        this._clean_rows(ridx);\n        return { tds, ridx, metadata, row_height };\n    }\n\n    clean({ ridx, cidx }) {\n        this._clean_rows(ridx);\n        this._clean_columns(cidx);\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport { RegularHeaderViewModel } from \"./thead\";\nimport { RegularBodyViewModel } from \"./tbody\";\nimport { html } from \"./utils\";\n\n/**\n * <table> view model.  In order to handle unknown column width when `draw()`\n * is called, this model will iteratively fetch more data to fill in columns\n * until the page is complete, and makes some column viewport estimations\n * when this information is not availble.\n *\n * @class RegularTableViewModel\n */\nexport class RegularTableViewModel {\n    constructor(table_clip, column_sizes, element) {\n        this.clear(element);\n        const [table] = element.children;\n        const [thead, tbody] = table.children;\n        this.table = table;\n        this._column_sizes = column_sizes;\n        this.header = new RegularHeaderViewModel(column_sizes, table_clip, thead);\n        this.body = new RegularBodyViewModel(column_sizes, table_clip, tbody);\n        this.fragment = document.createDocumentFragment();\n    }\n\n    num_columns() {\n        return this.header.num_columns();\n    }\n\n    clear(element) {\n        // nosemgrep\n        element.innerHTML = html`\n            <table cellspacing=\"0\">\n                <thead></thead>\n                <tbody></tbody>\n            </table>\n        `;\n    }\n\n    /**\n     * Calculate amendments to auto size from this render pass.\n     *\n     * @param {*} last_cells\n     * @param {*} {columns, column_pivots}\n     * @memberof RegularTableViewModel\n     */\n    autosize_cells(last_cells, override_row_height) {\n        while (last_cells.length > 0) {\n            const [cell, metadata] = last_cells.pop();\n            const box = cell.getBoundingClientRect();\n            this._column_sizes.row_height = override_row_height || Math.max(10, Math.min(this._column_sizes.row_height || box.height, box.height));\n            this._column_sizes.indices[metadata.size_key] = box.width;\n            const is_override = this._column_sizes.override[metadata.size_key] !== undefined;\n            if (box.width && !is_override) {\n                this._column_sizes.auto[metadata.size_key] = box.width;\n            }\n\n            if (cell.style.minWidth === \"0px\") {\n                cell.style.minWidth = `${box.width}px`;\n            }\n        }\n    }\n\n    async *draw(container_size, view_cache, selected_id, preserve_width, viewport, num_columns) {\n        const { width: container_width, height: container_height } = container_size;\n        const { view, config } = view_cache;\n        let { data, row_headers, column_headers, metadata: data_listener_metadata, column_header_merge_depth, merge_headers = \"both\" } = await view(\n            Math.floor(viewport.start_col),\n            Math.floor(viewport.start_row),\n            Math.ceil(viewport.end_col),\n            Math.ceil(viewport.end_row)\n        );\n\n        const merge_row_headers = merge_headers === \"both\" || merge_headers === \"row\";\n        const merge_column_headers = merge_headers === \"both\" || merge_headers === \"column\";\n\n        const { start_row: ridx_offset = 0, start_col: x0 = 0, end_col: x1 = 0, end_row: y1 = 0 } = viewport;\n\n        // pad row_headers for embedded renderer\n        // TODO maybe dont need this - perspective compat\n        if (row_headers) {\n            this._row_headers_length = row_headers.reduce((max, x) => Math.max(max, x.length), 0);\n            row_headers = row_headers.map((x) => {\n                x.length = this._row_headers_length;\n                return x;\n            });\n        }\n\n        view_cache.config.column_pivots = Array.from(Array(column_headers?.[0]?.length || 0).keys());\n        view_cache.config.row_pivots = Array.from(Array(row_headers?.[0]?.length || 0).keys());\n        const sub_cell_offset = this._column_sizes.indices[(this._row_headers_length || 0) + Math.floor(viewport.start_col)] || 0;\n\n        const view_state = {\n            viewport_width: 0,\n            selected_id,\n            ridx_offset,\n            sub_cell_offset,\n            x0: x0,\n            x1: x1,\n            y1: y1,\n            row_height: this._column_sizes.row_height,\n            row_headers_length: this._row_headers_length,\n        };\n\n        let cont_body,\n            _virtual_x = 0,\n            last_cells = [],\n            first_col = true;\n        if (row_headers?.length > 0) {\n            const column_name = config.row_pivots.join(\",\");\n\n            const column_state = {\n                column_name,\n                cidx: 0,\n                column_data: row_headers,\n                row_headers,\n                first_col,\n            };\n            const size_key = _virtual_x + Math.floor(x0);\n            cont_body = this.body.draw(container_height, column_state, { ...view_state, x0: 0 }, true, undefined, undefined, size_key, merge_row_headers);\n            const cont_heads = [];\n            for (let i = 0; i < view_cache.config.row_pivots.length; i++) {\n                const header = this.header.draw(column_name, Array(view_cache.config.column_pivots.length).fill(\"\"), 1, undefined, i, x0, i, column_header_merge_depth, merge_column_headers);\n                if (!!header) {\n                    cont_heads.push(header);\n                }\n            }\n            first_col = false;\n            view_state.viewport_width += cont_heads.reduce((total, { th }, i) => total + (this._column_sizes.indices[i] || th.offsetWidth), 0);\n            view_state.row_height = view_state.row_height || cont_body.row_height;\n            _virtual_x = row_headers[0].length;\n            if (!preserve_width) {\n                for (let i = 0; i < view_cache.config.row_pivots.length; i++) {\n                    const { td, metadata } = cont_body.tds[i] || {};\n                    const { th, metadata: hmetadata } = cont_heads[i] || {};\n                    if (!!td || !!th) {\n                        last_cells.push([th || td, hmetadata || metadata]);\n                    }\n                }\n            }\n        }\n\n        try {\n            let dcidx = 0;\n            const num_visible_columns = num_columns - viewport.start_col;\n            while (dcidx < num_visible_columns) {\n                // If there is no column for this data, our pre-fetch viewport\n                // estimate was wrong and we'll need to do a mid-render fetch\n                // to get more data.\n                if (!data[dcidx]) {\n                    let missing_cidx = Math.max(viewport.end_col, 0);\n                    viewport.start_col = missing_cidx;\n\n                    // Calculate a new data window width based on how large the\n                    // columns drawn so far take up.  This can either be\n                    // summed if we've drawn/measured these columns before,\n                    // or estimated by avg if the missing columns have never\n                    // been seen by the renderer.\n                    let end_col_offset = 0,\n                        size_extension = 0;\n                    while (this._column_sizes.indices.length > _virtual_x + x0 + end_col_offset + 1 && size_extension + view_state.viewport_width < container_width) {\n                        end_col_offset++;\n                        size_extension += this._column_sizes.indices[_virtual_x + x0 + end_col_offset];\n                    }\n\n                    if (size_extension + view_state.viewport_width < container_width) {\n                        const estimate = Math.min(num_columns, missing_cidx + 5); //Math.ceil(((dcidx + end_col_offset) * container_width) / (view_state.viewport_width + size_extension) + 1);\n                        viewport.end_col = Math.max(1, Math.min(num_columns, estimate));\n                    } else {\n                        viewport.end_col = Math.max(1, Math.min(num_columns, missing_cidx + end_col_offset));\n                    }\n\n                    // Fetch the new data window extension and append it to the\n                    // cached data page and continue.\n                    const new_col_req = view(Math.floor(viewport.start_col), Math.floor(viewport.start_row), Math.ceil(viewport.end_col), Math.ceil(viewport.end_row));\n                    yield undefined;\n                    const new_col = await new_col_req;\n\n                    if (typeof new_col.column_header_merge_depth !== \"undefined\") {\n                        column_header_merge_depth = new_col.column_header_merge_depth;\n                    }\n\n                    if (typeof new_col.merge_headers !== \"undefined\") {\n                        merge_headers = new_col.merge_headers;\n                    }\n\n                    if (new_col.data.length === 0) {\n                        // The viewport is size 0, first the estimate, then the\n                        // first-pass render, so really actually abort now.\n                        yield last_cells;\n                        return;\n                    }\n\n                    viewport.end_col = viewport.start_col + new_col.data.length;\n                    for (let i = 0; i < new_col.data.length; i++) {\n                        data[dcidx + i] = new_col.data[i];\n                        if (new_col.metadata) {\n                            data_listener_metadata[dcidx + i] = new_col.metadata[i];\n                        }\n\n                        if (column_headers) {\n                            column_headers[dcidx + i] = new_col.column_headers?.[i];\n                        }\n                    }\n                }\n\n                const column_name = column_headers?.[dcidx] || \"\";\n                const column_data = data[dcidx];\n                const column_data_listener_metadata = data_listener_metadata?.[dcidx];\n                const column_state = {\n                    column_name,\n                    cidx: _virtual_x,\n                    column_data,\n                    column_data_listener_metadata,\n                    row_headers,\n                    first_col,\n                };\n\n                const x = dcidx + x0;\n                const size_key = _virtual_x + Math.floor(x0);\n                const cont_head = this.header.draw(undefined, column_name, undefined, x, size_key, x0, _virtual_x, column_header_merge_depth, merge_column_headers);\n                cont_body = this.body.draw(container_height, column_state, view_state, false, x, x0, size_key, merge_row_headers);\n                first_col = false;\n                if (!preserve_width) {\n                    for (const { td, metadata } of cont_body.tds) {\n                        last_cells.push([cont_head?.th || td, cont_head?.metadata || metadata]);\n                    }\n                }\n\n                const last_measured_col_width = this._column_sizes.indices[_virtual_x + Math.floor(x0)];\n                if (last_measured_col_width) {\n                    view_state.viewport_width += last_measured_col_width;\n                } else {\n                    // This is probably wrong since the column has yet to be\n                    // styled, but we'll use it as an estimate and recalc after.\n                    view_state.viewport_width += cont_head?.th?.offsetWidth || cont_body.tds.reduce((x, y) => x + y.td?.offsetWidth, 0);\n                }\n\n                view_state.row_height = view_state.row_height || cont_body.row_height;\n                _virtual_x++;\n                dcidx++;\n\n                if (view_state.viewport_width - view_state.sub_cell_offset > container_width) {\n                    this.body.clean({\n                        ridx: cont_body?.ridx || 0,\n                        cidx: _virtual_x,\n                    });\n                    this.header.clean();\n                    yield last_cells;\n\n                    // If we make it here, this draw() call was invalidated by\n                    // a call to `invalidate()` within a `StyleListener`, so\n                    // recalculate the cumulative width and keep drawing if\n                    // necessary.  Note `last_cells` is a list of 2-tuples but\n                    // we only bind the first var because _eslint_.\n                    view_state.viewport_width = 0;\n                    for (let [td] of last_cells) {\n                        view_state.viewport_width += td.offsetWidth;\n                    }\n\n                    // If there are still enough columns to fill the screen,\n                    // completely end the iteration here, otherwise\n                    // continue iterating to draw another column.\n                    if (view_state.viewport_width - view_state.sub_cell_offset > container_width) {\n                        return;\n                    }\n                }\n            }\n            this.body.clean({ ridx: cont_body?.ridx || 0, cidx: _virtual_x });\n            this.header.clean();\n            yield last_cells;\n        } finally {\n            this.body.clean({ ridx: cont_body?.ridx || 0, cidx: _virtual_x });\n            this.header.clean();\n            this.body._span_factory.reset();\n            this.header._span_factory.reset();\n        }\n    }\n}\n", "/******************************************************************************\n *\n * Copyright (c) 2020, the Regular Table Authors.\n *\n * This file is part of the Regular Table library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport { METADATA_MAP } from \"./constants\";\nimport { RegularViewEventModel } from \"./events\";\nimport { RegularTableViewModel } from \"./table\";\nimport { get_draw_fps } from \"./utils\";\n\nconst VIRTUAL_MODES = [\"both\", \"horizontal\", \"vertical\", \"none\"];\n\n/**\n * The `<regular-table>` custom element.\n *\n * This module has no exports, but importing it has a side effect: the\n * `RegularTableElement` class is registered as a custom element, after which\n * it can be used as a standard DOM element.\n *\n * The documentation in this module defines the instance structure of a\n * `<regular-table>` DOM object instantiated typically, through HTML or any\n * relevent DOM method e.g. `document.createElement(\"perspective-viewer\")` or\n * `document.getElementsByTagName(\"perspective-viewer\")`.\n *\n * @public\n * @extends HTMLElement\n */\nclass RegularTableElement extends RegularViewEventModel {\n    constructor() {\n        super();\n        /** @private */\n        this._column_sizes = { auto: [], override: [], indices: [] };\n        /** @private */\n        this._style_callbacks = [];\n        /** @private */\n        this._initialized = false;\n    }\n\n    /* eslint-disable */\n    /**\n     * For internal use by the Custom Elements API: \"Invoked each time the\n     * custom element is appended into a document-connected element\".\n     * Ref: https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements#Using_the_lifecycle_callbacks\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    /* eslint-enable */\n    connectedCallback() {\n        if (!this._initialized) {\n            this.create_shadow_dom();\n            this.register_listeners();\n            this.setAttribute(\"tabindex\", \"0\");\n\n            this._initialized = true;\n            this.table_model = new RegularTableViewModel(this._table_clip, this._column_sizes, this);\n        }\n    }\n\n    /**\n     * Reset the viewport of this regular table.\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    _reset_viewport() {\n        /** @private @type {number} */\n        this._start_row = undefined;\n        /** @private @type {number} */\n        this._end_row = undefined;\n        /** @private @type {number} */\n        this._start_col = undefined;\n        /** @private @type {number} */\n        this._end_col = undefined;\n    }\n\n    /**\n     * Reset the scroll position of this regular table back to the origin.\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    _reset_scroll() {\n        this._column_sizes.indices = [];\n        this.scrollTop = 0;\n        this.scrollLeft = 0;\n        this._reset_viewport();\n    }\n\n    /**\n     * Reset column autosizing, such that column sizes will be recalculated\n     * on the next draw() call.\n     *\n     * @internal\n     * @protected\n     * @memberof RegularTableElement\n     */\n    _resetAutoSize() {\n        this._column_sizes.auto = [];\n        this._column_sizes.override = [];\n        this._column_sizes.indices = [];\n\n        for (let i = 0; i < this.table_model.header.num_columns(); i++) {\n            const th = this.table_model.header.get_column_header(i);\n            th.style.minWidth = \"\";\n            th.style.maxWidth = \"\";\n        }\n    }\n\n    /**\n     * Clears the current renderer `<table>`.\n     *\n     * @public\n     * @memberof RegularTableElement\n     */\n    clear() {\n        this.table_model = new RegularTableViewModel(this._table_clip, this._column_sizes, this);\n    }\n\n    /**\n     * Adds a style listener callback. The style listeners are called\n     * whenever the <table> is re-rendered, such as through API invocations\n     * of draw() and user-initiated events such as scrolling. Within this\n     * optionally async callback, you can select <td>, <th>, etc. elements\n     * via regular DOM API methods like querySelectorAll().\n     *\n     * Example:\n     * const unsubscribe = table.addStyleListener(() => {\n     *     for (const td of table.querySelectorAll(\"td\")) {\n     *         td.setAttribute(\"contenteditable\", true);\n     *     }\n     * });\n     *\n     * setTimeout(() => {\n     *     unsubscribe();\n     * }, 1000);\n     * @public\n     * @memberof RegularTableElement\n     * @param {function({detail: RegularTableElement}): void} styleListener - A\n     * (possibly async) function that styles the inner <table>.\n     * @returns {function(): void} A function to remove this style listener.\n     */\n    addStyleListener(styleListener) {\n        this._style_callbacks = this._style_callbacks.concat(styleListener);\n\n        let isSubscribed = true;\n\n        const unsubscribe = () => {\n            if (!isSubscribed) {\n                return;\n            }\n            isSubscribed = false;\n\n            const callbacks = (this._style_callbacks = this._style_callbacks.slice());\n            const index = callbacks.indexOf(styleListener);\n            callbacks.splice(index, 1);\n        };\n        return unsubscribe;\n    }\n\n    /**\n     * When called within the execution scope of a function registered to this\n     * `<regular-table>` as a `StyleListener`, invalidate this draw's\n     * dimensions and attempt to draw more columns.  Useful if your\n     * `StyleListener` changes a cells dimensions, otherwise `<regular-table>`\n     * may not draw enough columns to fill the screen.\n     *\n     * @public\n     * @memberof RegularTableElement\n     */\n    invalidate() {\n        if (!this._is_styling) {\n            throw new Error(\"Cannot call `invalidate()` outside of a `StyleListener`\");\n        }\n        /** @private */\n        this._invalidated = true;\n    }\n\n    /**\n     * Returns the `MetaData` object associated with a `<td>` or `<th>`.  When\n     * your `StyleListener` is invoked, use this method to look up additional\n     * `MetaData` about any `HTMLTableCellElement` in the rendered `<table>`.\n     *\n     * Example:\n     * const elems = document.querySelector(\"td:last-child td:last_child\");\n     * const metadata = table.getMeta(elems);\n     * console.log(`Viewport corner is ${metadata.x}, ${metadata.y}`);\n     *\n     * const header = table.getMeta({row_header_x: 1, y: 3}).row_header;\n     * @public\n     * @memberof RegularTableElement\n     * @param {HTMLTableCellElement|Partial<MetaData>} element - The child\n     * element of this `<regular-table>` for which to look up metadata, or a\n     * coordinates-like object to refer to metadata by logical position.\n     * @returns {MetaData} The metadata associated with the element.\n     */\n    getMeta(element) {\n        if (typeof element === \"undefined\") {\n            return;\n        } else if (element instanceof HTMLElement) {\n            return METADATA_MAP.get(element);\n        } else if (element.row_header_x >= 0) {\n            if (element.row_header_x < this._view_cache.config.row_pivots.length) {\n                const td = this.table_model.body._fetch_cell(element.y, element.row_header_x);\n                return this.getMeta(td);\n            }\n        } else if (element.column_header_y >= 0) {\n            if (element.column_header_y < this._view_cache.config.column_pivots.length) {\n                const td = this.table_model.body._fetch_cell(element.column_header_y, element.y);\n                return this.getMeta(td);\n            }\n        } else {\n            return this.getMeta(this.table_model.body._fetch_cell(element.dy, element.dx + this.table_model._row_headers_length));\n        }\n    }\n\n    /**\n     * Get performance statistics about this `<regular-table>`.  Calling this\n     * method resets the internal state, which makes it convenient to measure\n     * performance at regular intervals (see example).\n     *\n     * Example:\n     * const table = document.getElementById(\"my_regular_table\");\n     * setInterval(() => {\n     *     const {real_fps} = table.getDrawFPS();\n     *     console.log(`Measured ${fps} fps`)\n     * });\n     * @public\n     * @memberof RegularTableElement\n     * @returns {Performance} Performance data aggregated since the last\n     * call to `getDrawFPS()`.\n     */\n    getDrawFPS() {\n        return get_draw_fps();\n    }\n\n    /**\n     * Call this method to set the `scrollLeft` and `scrollTop` for this\n     * `<regular-table>` by calculating the position of this `scrollLeft`\n     * and `scrollTop` relative to the underlying widths of its columns\n     * and heights of its rows.\n     *\n     * Example:\n     * table.scrollToCell(1, 3, 10, 30);\n     * @public\n     * @memberof RegularTableElement\n     * @param {number} x - The left most `x` index column to scroll into view.\n     * @param {number} y - The top most `y` index row to scroll into view.\n     */\n    async scrollToCell(x, y) {\n        if (!this._view_cache) {\n            console.warn(\"data listener not configured\");\n            return;\n        }\n\n        const viewport_row_height = this._column_sizes.row_height || 19;\n        const header_height = this._view_cache.config.column_pivots.length * viewport_row_height;\n        const body_height = this._table_clip.offsetHeight - header_height;\n        const row_height_offset = body_height % viewport_row_height;\n        let real_row_height = (this._virtual_panel.offsetHeight - row_height_offset) / this._nrows;\n        this.scrollTop = Math.ceil(real_row_height * y);\n\n        let scroll_left = 0;\n        while (x > 0) {\n            x--;\n            scroll_left += this._column_sizes.indices[x + this._view_cache.config.row_pivots.length] || 60;\n        }\n\n        this.scrollLeft = Math.ceil(scroll_left);\n        await new Promise(requestAnimationFrame);\n        await this._draw_flush();\n    }\n\n    /**\n     * Call this method to set `DataListener` for this `<regular-table>`,\n     * which will be called whenever a new data slice is needed to render.\n     * Calls to `draw()` will fail if no `DataListener` has been set\n     *\n     * Example:\n     * table.setDataListener((x0, y0, x1, y1) => {\n     *     return {\n     *         num_rows: num_rows = DATA[0].length,\n     *         num_columns: DATA.length,\n     *         data: DATA.slice(x0, x1).map(col => col.slice(y0, y1))\n     *     };\n     * })\n     * @public\n     * @memberof RegularTableElement\n     * @param {DataListener} dataListener\n     * `dataListener` is called by to request a rectangular section of data\n     * for a virtual viewport, (x0, y0, x1, y1), and returns a `DataReponse`\n     * object.\n     * @param {Object} options\n     * @param {(\"both\"|\"horizontal\"|\"vertical\"|\"none\")} options.virtual_mode\n     * The `virtual_mode` options flag may be one of \"both\", \"horizontal\",\n     * \"vertical\", or \"none\" indicating which dimensions of the table should be\n     * virtualized (vs. rendering completely).\n     */\n    setDataListener(dataListener, { virtual_mode = \"both\" } = {}) {\n        let schema = {};\n        let config = {\n            row_pivots: [],\n            column_pivots: [],\n        };\n\n        console.assert(VIRTUAL_MODES.indexOf(virtual_mode) > -1, `Unknown virtual_mode ${virtual_mode};  valid options are \"both\" (default), \"horizontal\", \"vertical\" or \"none\"`);\n        /** @private */\n        this._virtual_mode = virtual_mode;\n        /** @private */\n        this._invalid_schema = true;\n        /** @private */\n        this._view_cache = { view: dataListener, config, schema };\n        this._setup_virtual_scroll();\n    }\n\n    /**\n     * This func only exists to provide hints to doc compulation tools.\n     * Should never be run, and even if it is the body of the func will\n     * never execute.\n     *\n     * @internal\n     * @private\n     * @memberof RegularTableElement\n     */\n    __noop_jsdoc_hints() {\n        if (false) {\n            /**\n             * Draws this virtual panel, given an object of render options that\n             * allow the implementor to fine tune the individual render frames\n             * based on the interaction and previous render state.\n             *\n             * @public\n             * @type {(opt?: DrawOptions) => void}\n             * @memberof RegularTableElement\n             * */\n            this.draw = null;\n        }\n    }\n}\n\nif (document.createElement(\"regular-table\").constructor === HTMLElement) {\n    window.customElements.define(\"regular-table\", RegularTableElement);\n}\n\n/**\n * An object with performance statistics about calls to\n * `draw()` from some time interval (captured in milliseconds by the\n * `elapsed` proprty).\n *\n * @public\n * @typedef Performance\n * @type {object}\n * @property {number} avg - Avergage milliseconds per call.\n * @property {number} real_fps - `num_frames` / `elapsed`\n * @property {number} virtual_fps - `elapsed` / `avg`\n * @property {number} num_frames - Number of frames rendered.\n * @property {number} elapsed - Number of milliseconds since last call\n * to `getDrawFPS()`.\n */\n\n/**\n * An object describing virtual rendering metadata about an\n * `HTMLTableCellElement`, use this object to map rendered `<th>` or `<td>`\n * elements back to your `data`, `row_headers` or `column_headers` within\n * listener functions for `addStyleListener()` and `addEventListener()`.\n *\n * Example:\n *\n * MetaData                     (x = 0, column_header_y = 0))\n *                              *-------------------------------------+\n *                              |                                     |\n *                              |                                     |\n *                              +-------------------------------------+\n * (row_header_x = 0, y = 0)    (x = 0, y = 0)\n * *------------------------+   *-------------------------------------+\n * |                        |   |                                     |\n * |                        |   |      (x0, y0)                       |\n * |                        |   |      *---------------*              |\n * |                        |   |      |               |              |\n * |                        |   |      |     * (x, y)  |              |\n * |                        |   |      |               |              |\n * |                        |   |      *---------------* (x1, y1)     |\n * |                        |   |                                     |\n * +------------------------+   +-------------------------------------+\n *\n * @public\n * @typedef MetaData\n * @type {object}\n * @property {number} [x] - The `x` index in your virtual data model.\n * property is only generated for `<td>`, `<th>` from `row_headers`.\n * @property {number} [y] - The `y` index in your virtual data model.\n * property is only generated for `<td>`, `<th>` from `row_headers`.\n * @property {number} [x0] - The `x` index of the viewport origin in\n * your data model, e.g. what was passed to `x0` when your\n * `dataListener` was invoked.\n * @property {number} [y0] - The `y` index of the viewport origin in\n * your data model, e.g. what was passed to `y0` when your\n * `dataListener` was invoked.\n * @property {number} [x1] - The `x` index of the viewport corner in\n * your data model, e.g. what was passed to `x1` when your\n * `dataListener` was invoked.\n * @property {number} [y1] - The `y` index of the viewport corner in\n * your data model, e.g. what was passed to `y1` when your\n * `dataListener` was invoked.\n * @property {number} [dx] - The `x` index in `DataResponse.data`, this\n * property is only generated for `<td>`, and `<th>` from `column_headers`.\n * @property {number} [dy] - The `y` index in `DataResponse.data`, this\n * property is only generated for `<td>`, `<th>` from `row_headers`.\n * @property {number} [column_header_y] - The `y` index in\n * `DataResponse.column_headers[x]`, this property is only generated for `<th>`\n * from `column_headers`.\n * @property {number} [row_header_x] - The `x` index in\n * `DataResponse.row_headers[y]`, this property is only generated for `<th>`\n * from `row_headers`.\n * @property {number} size_key - The unique index of this column in a full\n * `<table>`, which is `x` + (Total Row Header Columns).\n * @property {(string|HTMLElement)[]} [row_header] - The `Array` for this `y` in\n * `DataResponse.row_headers`, if it was provided.\n * @property {(string|HTMLElement)[]} [column_header] - The `Array` for this `x`\n * in `DataResponse.column_headers`, if it was provided.\n * @property {(string|HTMLElement)} [value] - The value dispalyed in the cell or\n * header.\n */\n\n/**\n * The `DataResponse` object describes a rectangular region of a virtual\n * data set, and some associated metadata.  `<regular-table>` will use this\n * object to render the `<table>`, though it may make multiple requests for\n * different regions to achieve a compelte render as it must estimate\n * certain dimensions.  You must construct a `DataResponse` object to\n * implement a `DataListener`.\n *\n * Example:\n * {\n *     \"num_rows\": 26,\n *     \"num_columns\": 3,\n *     \"data\": [\n *         [0, 1],\n *         [\"A\", \"B\"]\n *     ],\n *     \"row_headers\": [\n *         [\"Rowgroup 1\", \"Row 1\"],\n *         [\"Rowgroup 1\", \"Row 2\"]\n *     ],\n *     \"column_headers\": [\n *         [\"Colgroup 1\", \"Column 1\"],\n *         [\"Colgroup 1\", \"Column 2\"]\n *     ]\n * }\n * @public\n * @typedef DataResponse\n * @type {object}\n * @property {(string|HTMLElement)[][]} [column_headers] - A two dimensional\n * `Array` of column group headers, in specificity order.  No `<thead>`\n * will be generated if this property is not provided.\n * @property {(string|HTMLElement)[][]} [row_headers] - A two dimensional\n * `Array` of row group headers, in specificity order.  No `<th>`\n * elements within `<tbody>` will be generated if this property is not\n * provided.\n * @property {(string|HTMLElement)[][]} data - A two dimensional `Array`\n * representing a rectangular section of the underlying data set from\n * (x0, y0) to (x1, y1), arranged in columnar fashion such that\n * `data[x][y]` returns the `y`th row of the `x`th column of the slice.\n * @property {number} num_rows - Total number of rows in the underlying\n * data set.\n * @property {number} num_columns - Total number of columns in the\n * underlying data set.\n */\n\n/**\n * The `DataListener` is similar to a normal event listener function.\n * Unlike a normal event listener, it takes regular arguments (not an\n * `Event`); and returns a `Promise` for a `DataResponse` object for this\n * region (as opposed to returning `void` as a standard event listener).\n *\n * @public\n * @callback DataListener\n * @param {number} x0 - The origin `x` index (column).\n * @param {number} y0 - The origin `y` index (row).\n * @param {number} x1 - The corner `x` index (column).\n * @param {number} y1 - The corner `y` index (row).\n * @returns {Promise<DataResponse>} The resulting `DataResponse`.  Make sure\n * to `resolve` or `reject` the `Promise`, or your `<regular-table>` will\n * never render!\n */\n\n/**\n * Options for the draw method.\n *\n * @public\n * @typedef DrawOptions\n * @type {object}\n * @property {boolean} [invalid_viewport]\n * @property {boolean} [preserve_width]\n */\n\n/**\n * Public summary of table_model type.\n *\n * @public\n * @typedef TableModel\n * @type {object}\n * @property {ViewModel} header\n * @property {ViewModel} body\n * @property {() => number} num_columns\n */\n\n/**\n * Public summary of table_model.header and table_model.body base type.\n *\n * @public\n * @typedef ViewModel\n * @type {object}\n * @property {any} table\n * @property {any[]} cells\n * @property {any[]} rows\n * @property {() => number} num_columns\n * @property {() => number} num_rows\n */\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nfunction get_psp_type(metadata) {\n    if (metadata.x >= 0) {\n        return this._column_types[metadata.x];\n    } else {\n        return this._row_header_types[metadata.row_header_x - 1];\n    }\n}\n\nexport function style_selected_column(regularTable, viewer, selectedColumn) {\n    const group_header_trs = Array.from(\n        regularTable.children[0].children[0].children\n    );\n    const len = group_header_trs.length;\n    if (len <= 1) {\n        group_header_trs[0]?.removeAttribute(\"id\");\n    } else {\n        group_header_trs.forEach((tr, i) => {\n            let id =\n                i === len - 2\n                    ? \"psp-column-titles\"\n                    : i === len - 1\n                    ? \"psp-column-edit-buttons\"\n                    : null;\n            id ? tr.setAttribute(\"id\", id) : tr.removeAttribute(\"id\");\n        });\n    }\n\n    const settings_open = viewer.hasAttribute(\"settings\");\n    viewer.classList.toggle(\"psp-menu-open\", !!selectedColumn);\n\n    if (settings_open && len >= 2) {\n        // if settings_open, you will never have less than 2 trs unless the\n        // table is empty, but possibly more e.g. with group-by.\n        // edit and title are guaranteed to be the last two rows\n        let titles = Array.from(group_header_trs[len - 2].children);\n        let editBtns = Array.from(group_header_trs[len - 1].children);\n        if (titles && editBtns) {\n            // clear any sticky styles from tr changes\n            group_header_trs.slice(0, len - 2).forEach((tr) => {\n                Array.from(tr.children).forEach((th) => {\n                    th.classList.toggle(\"psp-menu-open\", false);\n                });\n            });\n\n            for (let i = 0; i < titles.length; i++) {\n                const title = titles[i];\n                const editBtn = editBtns[i];\n\n                let open = title.innerText === selectedColumn;\n                title.classList.toggle(\"psp-menu-open\", open);\n                editBtn.classList.toggle(\"psp-menu-open\", open);\n                if (this._config.columns.length > 1) {\n                    for (const r of regularTable.querySelectorAll(\"td\")) {\n                        const meta = regularTable.getMeta(r);\n                        const open =\n                            meta.column_header[\n                                meta.column_header.length - 2\n                            ] === selectedColumn;\n                        r.classList.toggle(\"psp-menu-open\", open);\n                    }\n                }\n            }\n        }\n    }\n}\n\nexport function column_header_style_listener(regularTable, viewer) {\n    let group_header_trs = Array.from(\n        regularTable.children[0].children[0].children\n    );\n\n    if (group_header_trs.length > 0) {\n        style_selected_column.call(\n            this,\n            regularTable,\n            viewer,\n            this._column_settings_selected_column\n        );\n\n        let [col_headers] = group_header_trs.splice(\n            this._config.split_by.length,\n            1\n        );\n\n        style_column_header_row.call(this, regularTable, col_headers, false);\n\n        let [style_menu_headers] = group_header_trs.splice(\n            this._config.split_by.length,\n            1\n        );\n\n        if (style_menu_headers) {\n            style_column_header_row.call(\n                this,\n                regularTable,\n                style_menu_headers,\n                true\n            );\n        }\n    }\n}\n\nfunction style_column_header_row(regularTable, col_headers, is_menu_row) {\n    // regular header styling\n    const header_depth = regularTable._view_cache.config.row_pivots.length - 1;\n    for (const td of col_headers?.children) {\n        const metadata = regularTable.getMeta(td);\n        const column_name =\n            metadata.column_header?.[this._config.split_by.length];\n        const sort = this._config.sort.find((x) => x[0] === column_name);\n        let needs_border = metadata.row_header_x === header_depth;\n        const is_corner = typeof metadata.x === \"undefined\";\n        needs_border =\n            needs_border ||\n            (metadata.x + 1) % this._config.columns.length === 0;\n        td.classList.toggle(\"psp-header-border\", needs_border);\n        td.classList.toggle(\"psp-header-group\", false);\n        td.classList.toggle(\"psp-header-leaf\", true);\n        td.classList.toggle(\"psp-is-top\", false);\n        td.classList.toggle(\"psp-header-corner\", is_corner);\n        td.classList.toggle(\n            \"psp-header-sort-asc\",\n            !is_menu_row && !!sort && sort[1] === \"asc\"\n        );\n        td.classList.toggle(\n            \"psp-header-sort-desc\",\n            !is_menu_row && !!sort && sort[1] === \"desc\"\n        );\n        td.classList.toggle(\n            \"psp-header-sort-col-asc\",\n            !is_menu_row && !!sort && sort[1] === \"col asc\"\n        );\n        td.classList.toggle(\n            \"psp-header-sort-col-desc\",\n            !is_menu_row && !!sort && sort[1] === \"col desc\"\n        );\n\n        let type = get_psp_type.call(this, metadata);\n        const is_numeric = type === \"integer\" || type === \"float\";\n        const is_string = type === \"string\";\n        const is_date = type === \"date\";\n        const is_datetime = type === \"datetime\";\n        td.classList.toggle(\"psp-align-right\", is_numeric);\n        td.classList.toggle(\"psp-align-left\", !is_numeric);\n\n        td.classList.toggle(\n            \"psp-menu-enabled\",\n            (is_string || is_numeric || is_date || is_datetime) &&\n                !is_corner &&\n                metadata.column_header_y == this._config.split_by.length + 1\n        );\n\n        td.classList.toggle(\n            \"psp-sort-enabled\",\n            (is_string || is_numeric || is_date || is_datetime) &&\n                !is_corner &&\n                metadata.column_header_y === this._config.split_by.length\n        );\n\n        td.classList.toggle(\n            \"psp-is-width-override\",\n            regularTable._column_sizes?.override[metadata.size_key] !==\n                undefined\n        );\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport function group_header_style_listener(regularTable) {\n    const header_depth = regularTable._view_cache.config.row_pivots.length - 1;\n    let group_header_trs = Array.from(\n        regularTable.children[0].children[0].children\n    );\n\n    const m = [];\n    let marked = new Set();\n    const table = regularTable.children[0];\n    for (let y = 0; y < group_header_trs.length; y++) {\n        let row = table.rows[y];\n        const tops = new Set();\n        for (let x = 0; x < row.cells.length; x++) {\n            const td = row.cells[x];\n            td.style.backgroundColor = \"\";\n            const metadata = regularTable.getMeta(td);\n            let needs_border =\n                metadata.row_header_x === header_depth || metadata.x >= 0;\n            td.classList.toggle(\"psp-align-right\", false);\n            td.classList.toggle(\"psp-align-left\", false);\n            td.classList.toggle(\"psp-header-group\", true);\n            td.classList.toggle(\"psp-header-leaf\", false);\n            td.classList.toggle(\"psp-header-border\", needs_border);\n            td.classList.toggle(\n                \"psp-header-group-corner\",\n                typeof metadata.x === \"undefined\"\n            );\n            td.classList.toggle(\"psp-color-mode-bar\", false);\n\n            td.classList.toggle(\"psp-header-sort-asc\", false);\n            td.classList.toggle(\"psp-header-sort-desc\", false);\n            td.classList.toggle(\"psp-header-sort-col-asc\", false);\n            td.classList.toggle(\"psp-header-sort-col-desc\", false);\n            td.classList.toggle(\"psp-sort-enabled\", false);\n\n            let cell = row.cells[x],\n                xx = x,\n                tx,\n                ty;\n\n            for (; m[y] && m[y][xx]; ++xx);\n            tops.add(xx);\n            for (tx = xx; tx < xx + cell.colSpan; ++tx) {\n                for (ty = y; ty < y + cell.rowSpan; ++ty) {\n                    if (!m[ty]) m[ty] = [];\n                    m[ty][tx] = true;\n                }\n            }\n\n            cell.classList.toggle(\"psp-is-top\", y === 0 || !marked.has(tx));\n        }\n        marked = tops;\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport const PRIVATE_PLUGIN_SYMBOL = Symbol(\"Plugin Symbol\");\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport function style_cell_flash(\n    metadata,\n    td,\n    [, , , , , pos_s, pos_e],\n    [, , , , , neg_s, neg_e],\n    is_settings_open\n) {\n    const id = this._ids?.[metadata.dy]?.join(\"|\");\n    const metadata_path = (\n        is_settings_open\n            ? metadata.column_header.slice(0, -1)\n            : metadata.column_header\n    ).join(\"|\");\n\n    if (\n        this.last_reverse_columns?.has(metadata_path) &&\n        this.last_reverse_ids?.has(id)\n    ) {\n        const row_idx = this.last_reverse_ids?.get(id);\n        const col_idx = this.last_reverse_columns.get(metadata_path);\n        if (!this._is_old_viewport) {\n            td.style.animation = \"\";\n        } else if (this.last_meta?.[col_idx]?.[row_idx] > metadata.user) {\n            td.style.setProperty(\"--pulse--background-color-start\", neg_s);\n            td.style.setProperty(\"--pulse--background-color-end\", neg_e);\n            if (td.style.animationName === \"pulse_neg\") {\n                td.style.animation = \"pulse_neg2 0.5s linear\";\n            } else {\n                td.style.animation = \"pulse_neg 0.5s linear\";\n            }\n        } else if (this.last_meta?.[col_idx]?.[row_idx] < metadata.user) {\n            td.style.setProperty(\"--pulse--background-color-start\", pos_s);\n            td.style.setProperty(\"--pulse--background-color-end\", pos_e);\n            if (td.style.animationName === \"pulse_pos\") {\n                td.style.animation = \"pulse_pos2 0.5s linear\";\n            } else {\n                td.style.animation = \"pulse_pos 0.5s linear\";\n            }\n        } else if (row_idx !== metadata.dy) {\n            td.style.animation = \"\";\n        }\n    } else {\n        td.style.animation = \"\";\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport chroma from \"chroma-js\";\n\nexport function blend(a, b) {\n    return chroma.mix(a, `rgb(${b[0]},${b[1]},${b[2]})`, 0.5).hex();\n}\n\n// AFAICT `chroma-js` has no alpha-aware blending? So we need a function to get\n// the color of a heatmap cell over the background.\nexport function rgbaToRgb([r, g, b, a], source = [255, 255, 255]) {\n    function f(i, c) {\n        return ((1 - a) * (source[i] / 255) + a * (c / 255)) * 255;\n    }\n\n    return [f(0, r), f(1, g), f(2, b)];\n}\n\n// Chroma does this but why bother?\nexport function infer_foreground_from_background([r, g, b]) {\n    // TODO Implement dark/light themes.\n    return Math.sqrt(r * r * 0.299 + g * g * 0.587 + b * b * 0.114) > 130\n        ? \"#161616\"\n        : \"#ffffff\";\n}\n\nfunction make_gradient(chromahex) {\n    const [r, g, b] = chromahex.rgb();\n    const [r1, g1, b1] = chromahex\n        .set(\"hsl.h\", (chromahex.get(\"hsl.h\") - 15) % 360)\n        .rgb();\n    const [r2, g2, b2] = chromahex\n        .set(\"hsl.h\", (chromahex.get(\"hsl.h\") + 15) % 360)\n        .rgb();\n    return `linear-gradient(to right top,rgb(${r1},${g1},${b1}),rgb(${r},${g},${b}) 50%,rgb(${r2},${g2},${b2}))`;\n}\n\nexport function make_color_record(color) {\n    const chroma_neg = chroma(color);\n    const _neg_grad = make_gradient(chroma_neg);\n    const rgb = chroma_neg.rgb();\n\n    return [\n        color,\n        ...rgb,\n        _neg_grad,\n        `rgba(${rgb[0]},${rgb[1]},${rgb[2]},1)`,\n        `rgba(${rgb[0]},${rgb[1]},${rgb[2]},0)`,\n    ];\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { style_cell_flash } from \"./cell_flash.js\";\nimport {\n    rgbaToRgb,\n    infer_foreground_from_background,\n} from \"../../color_utils.js\";\n\nexport function cell_style_numeric(plugin, td, metadata, is_settings_open) {\n    const is_positive = metadata.user > 0;\n    const is_negative = metadata.user < 0;\n\n    let pos_bg_color;\n    if (plugin?.pos_bg_color !== undefined) {\n        pos_bg_color = plugin.pos_bg_color;\n    } else {\n        pos_bg_color = this._pos_bg_color;\n    }\n\n    let neg_bg_color;\n    if (plugin?.neg_bg_color !== undefined) {\n        neg_bg_color = plugin.neg_bg_color;\n    } else {\n        neg_bg_color = this._neg_bg_color;\n    }\n\n    const bg_tuple = is_positive\n        ? pos_bg_color\n        : is_negative\n        ? neg_bg_color\n        : [\"\", ...this._plugin_background, \"\"];\n\n    {\n        const [hex, r, g, b, _gradhex] = bg_tuple;\n\n        td.style.position = \"\";\n        if (plugin?.number_bg_mode === \"color\") {\n            td.style.animation = \"\";\n            td.style.backgroundColor = hex;\n        } else if (plugin?.number_bg_mode === \"gradient\") {\n            const a = Math.max(\n                0,\n                Math.min(1, Math.abs(metadata.user / plugin.bg_gradient))\n            );\n            const source = this._plugin_background;\n            const foreground = infer_foreground_from_background(\n                rgbaToRgb([r, g, b, a], source)\n            );\n\n            td.style.animation = \"\";\n            td.style.color = foreground;\n            td.style.backgroundColor = `rgba(${r},${g},${b},${a})`;\n        } else if (plugin?.number_bg_mode === \"pulse\") {\n            // TODO!\n            style_cell_flash.call(\n                this,\n                metadata,\n                td,\n                pos_bg_color,\n                neg_bg_color,\n                is_settings_open\n            );\n            td.style.backgroundColor = \"\";\n        } else if (\n            plugin?.number_bg_mode === \"disabled\" ||\n            !plugin?.number_bg_mode\n        ) {\n            td.style.animation = \"\";\n            td.style.backgroundColor = \"\";\n        } else {\n            td.style.animation = \"\";\n            td.style.backgroundColor = \"\";\n        }\n    }\n\n    const [hex, r, g, b, gradhex] = (() => {\n        if (plugin?.pos_fg_color !== undefined) {\n            return is_positive\n                ? plugin.pos_fg_color\n                : is_negative\n                ? plugin.neg_fg_color\n                : [\"\", ...this._plugin_background, \"\"];\n        } else {\n            return is_positive\n                ? this._pos_fg_color\n                : is_negative\n                ? this._neg_fg_color\n                : [\"\", ...this._plugin_background, \"\"];\n        }\n    })();\n\n    if (plugin?.number_fg_mode === \"disabled\") {\n        if (plugin?.number_bg_mode === \"color\") {\n            const source = this._plugin_background;\n            const foreground = infer_foreground_from_background(\n                rgbaToRgb([bg_tuple[1], bg_tuple[2], bg_tuple[3], 1], source)\n            );\n            td.style.color = foreground;\n        } else if (plugin?.number_bg_mode === \"gradient\") {\n        } else {\n            td.style.color = \"\";\n        }\n    } else if (plugin?.number_fg_mode === \"bar\") {\n        td.style.color = \"\";\n        td.style.position = \"relative\";\n        if (\n            gradhex !== \"\" &&\n            td.children.length > 0 &&\n            td.children[0].nodeType === Node.ELEMENT_NODE\n        ) {\n            td.children[0].style.background = gradhex;\n        }\n    } else if (plugin?.number_fg_mode === \"color\" || !plugin?.number_fg_mode) {\n        td.style.color = hex;\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport chroma from \"chroma-js\";\nimport {\n    rgbaToRgb,\n    infer_foreground_from_background,\n} from \"../../color_utils.js\";\n\nexport function cell_style_string(plugin, td, metadata) {\n    const column_name = metadata.column_header?.[this._config.split_by.length];\n    const [hex, r, g, b, gradhex] = (() => {\n        if (plugin?.color !== undefined) {\n            return plugin.color;\n        } else {\n            return this._color;\n        }\n    })();\n\n    if (plugin?.string_color_mode === \"foreground\" && metadata.user !== null) {\n        td.style.color = hex;\n        td.style.backgroundColor = \"\";\n        if (plugin?.format === \"link\") {\n            td.children[0].style.color = hex;\n        }\n    } else if (\n        plugin?.string_color_mode === \"background\" &&\n        metadata.user !== null\n    ) {\n        const source = this._plugin_background;\n        const foreground = infer_foreground_from_background(\n            rgbaToRgb([r, g, b, 1], source)\n        );\n        td.style.color = foreground;\n        td.style.backgroundColor = hex;\n    } else if (\n        plugin?.string_color_mode === \"series\" &&\n        metadata.user !== null\n    ) {\n        if (!this._series_color_map.has(column_name)) {\n            this._series_color_map.set(column_name, new Map());\n            this._series_color_seed.set(column_name, 0);\n        }\n\n        const series_map = this._series_color_map.get(column_name);\n        if (!series_map.has(metadata.user)) {\n            const seed = this._series_color_seed.get(column_name);\n            series_map.set(metadata.user, seed);\n            this._series_color_seed.set(column_name, seed + 1);\n        }\n\n        const color_seed = series_map.get(metadata.user);\n        let [h, s, l] = chroma(hex).hsl();\n        h = h + ((color_seed * 150) % 360);\n        const color2 = chroma(h, s, l, \"hsl\");\n        const [r, g, b] = color2.rgb();\n        const hex2 = color2.hex();\n        const source = this._plugin_background;\n        const foreground = infer_foreground_from_background(\n            rgbaToRgb([r, g, b, 1], source)\n        );\n        td.style.color = foreground;\n        td.style.backgroundColor = hex2;\n    } else {\n        td.style.backgroundColor = \"\";\n        td.style.color = \"\";\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport chroma from \"chroma-js\";\nimport {\n    rgbaToRgb,\n    infer_foreground_from_background,\n} from \"../../color_utils.js\";\n\nexport function cell_style_datetime(plugin, td, metadata) {\n    const column_name = metadata.column_header?.[this._config.split_by.length];\n\n    const [hex, r, g, b, gradhex] = (() => {\n        if (plugin?.color !== undefined) {\n            return plugin.color;\n        } else {\n            return this._color;\n        }\n    })();\n\n    if (\n        plugin?.datetime_color_mode === \"foreground\" &&\n        metadata.user !== null\n    ) {\n        td.style.color = hex;\n        td.style.backgroundColor = \"\";\n    } else if (\n        plugin?.datetime_color_mode === \"background\" &&\n        metadata.user !== null\n    ) {\n        const source = this._plugin_background;\n        const foreground = infer_foreground_from_background(\n            rgbaToRgb([r, g, b, 1], source)\n        );\n        td.style.color = foreground;\n        td.style.backgroundColor = hex;\n    } else {\n        td.style.backgroundColor = \"\";\n        td.style.color = \"\";\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport function cell_style_boolean(plugin, td, metadata) {\n    const [hex] =\n        metadata.user === true\n            ? this._pos_fg_color\n            : metadata.user === false\n            ? this._neg_fg_color\n            : [\"\", 0, 0, 0, \"\"];\n\n    td.style.backgroundColor = \"\";\n    td.style.color = hex;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport function cell_style_row_header(regularTable, td, metadata) {\n    const is_not_empty =\n        typeof metadata.value != undefined &&\n        typeof metadata.value != null &&\n        metadata.value?.toString()?.trim().length > 0;\n    const is_leaf = metadata.row_header_x >= this._config.group_by.length;\n    const next = regularTable.getMeta({\n        dx: 0,\n        dy: metadata.y - metadata.y0 + 1,\n    });\n    const is_collapse =\n        next &&\n        next.row_header &&\n        typeof next.row_header[metadata.row_header_x + 1] !== \"undefined\";\n    td.classList.toggle(\"psp-tree-label\", is_not_empty && !is_leaf);\n    td.classList.toggle(\n        \"psp-tree-label-expand\",\n        is_not_empty && !is_leaf && !is_collapse\n    );\n    td.classList.toggle(\n        \"psp-tree-label-collapse\",\n        is_not_empty && !is_leaf && is_collapse\n    );\n    td.classList.toggle(\"psp-tree-leaf\", is_not_empty && is_leaf);\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { PRIVATE_PLUGIN_SYMBOL } from \"../../model\";\n\nimport { cell_style_numeric } from \"./numeric.js\";\nimport { cell_style_string } from \"./string.js\";\nimport { cell_style_datetime } from \"./datetime.js\";\nimport { cell_style_boolean } from \"./boolean.js\";\nimport { cell_style_row_header } from \"./row_header.js\";\n\nfunction get_psp_type(metadata) {\n    if (metadata.x >= 0) {\n        return this._column_types[metadata.x];\n    } else {\n        return this._row_header_types[metadata.row_header_x - 1];\n    }\n}\n\nexport function table_cell_style_listener(regularTable, viewer) {\n    const plugins = regularTable[PRIVATE_PLUGIN_SYMBOL] || {};\n    const is_settings_open = viewer.hasAttribute(\"settings\");\n\n    for (const tr of regularTable.children[0].children[1].children) {\n        for (const td of tr.children) {\n            const metadata = regularTable.getMeta(td);\n            const column_name =\n                metadata.column_header?.[this._config.split_by.length];\n\n            let type = get_psp_type.call(this, metadata);\n            const plugin = plugins[column_name];\n            const is_numeric = type === \"integer\" || type === \"float\";\n\n            if (is_numeric) {\n                cell_style_numeric.call(\n                    this,\n                    plugin,\n                    td,\n                    metadata,\n                    is_settings_open\n                );\n            } else if (type === \"boolean\") {\n                cell_style_boolean.call(this, plugin, td, metadata);\n            } else if (type === \"string\") {\n                cell_style_string.call(this, plugin, td, metadata);\n            } else if (type === \"date\" || type === \"datetime\") {\n                cell_style_datetime.call(this, plugin, td, metadata);\n            } else {\n                td.style.backgroundColor = \"\";\n                td.style.color = \"\";\n            }\n\n            td.classList.toggle(\n                \"psp-bool-type\",\n                type === \"boolean\" && metadata.user !== null\n            );\n\n            const is_th = td.tagName === \"TH\";\n            if (is_th) {\n                cell_style_row_header.call(this, regularTable, td, metadata);\n            }\n\n            td.classList.toggle(\"psp-align-right\", !is_th && is_numeric);\n            td.classList.toggle(\"psp-align-left\", is_th || !is_numeric);\n            td.classList.toggle(\n                \"psp-color-mode-bar\",\n                plugin?.number_fg_mode === \"bar\" && is_numeric\n            );\n        }\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport async function sortHandler(regularTable, viewer, event, target) {\n    const meta = regularTable.getMeta(target);\n    const column_name = meta.column_header[this._config.split_by.length];\n    const sort_method = event.shiftKey ? append_sort : override_sort;\n    const sort = sort_method.call(this, column_name);\n    this._preserve_focus_state = true;\n    await viewer.restore({ sort });\n}\n\nexport function append_sort(column_name) {\n    const sort = [];\n    let found = false;\n    for (const sort_term of this._config.sort) {\n        const [_column_name, _sort_dir] = sort_term;\n        if (_column_name === column_name) {\n            found = true;\n            const term = create_sort.call(this, column_name, _sort_dir);\n            if (term) {\n                sort.push(term);\n            }\n        } else {\n            sort.push(sort_term);\n        }\n    }\n    if (!found) {\n        sort.push([column_name, \"desc\"]);\n    }\n    return sort;\n}\n\nexport function override_sort(column_name) {\n    for (const [_column_name, _sort_dir] of this._config.sort) {\n        if (_column_name === column_name) {\n            const sort = create_sort.call(this, column_name, _sort_dir);\n            return sort ? [sort] : [];\n        }\n    }\n    return [[column_name, \"desc\"]];\n}\n\nexport function create_sort(column_name, sort_dir) {\n    const is_col_sortable = this._config.split_by.length > 0;\n    const order = is_col_sortable ? ROW_COL_SORT_ORDER : ROW_SORT_ORDER;\n    const inc_sort_dir = sort_dir ? order[sort_dir] : \"desc\";\n    if (inc_sort_dir) {\n        return [column_name, inc_sort_dir];\n    }\n}\n\nconst ROW_SORT_ORDER = { desc: \"asc\", asc: undefined };\nconst ROW_COL_SORT_ORDER = {\n    desc: \"asc\",\n    asc: \"col desc\",\n    \"col desc\": \"col asc\",\n    \"col asc\": undefined,\n};\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport async function expandCollapseHandler(regularTable, event) {\n    const meta = regularTable.getMeta(event.target);\n    const is_collapse = event.target.classList.contains(\n        \"psp-tree-label-collapse\"\n    );\n    if (event.shiftKey && is_collapse) {\n        this._view.set_depth(\n            meta.row_header.filter((x) => x !== undefined).length - 2\n        );\n    } else if (event.shiftKey) {\n        this._view.set_depth(\n            meta.row_header.filter((x) => x !== undefined).length - 1\n        );\n    } else if (is_collapse) {\n        this._view.collapse(meta.y);\n    } else {\n        this._view.expand(meta.y);\n    }\n    this._num_rows = await this._view.num_rows();\n    this._num_columns = await this._view.num_columns();\n    regularTable.draw();\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { sortHandler } from \"./sort.js\";\nimport { expandCollapseHandler } from \"./expand_collapse.js\";\n\nexport async function mousedown_listener(regularTable, viewer, event) {\n    if (event.which !== 1) {\n        return;\n    }\n\n    let target = event.target;\n    if (target.tagName === \"A\") {\n        return;\n    }\n\n    while (target.tagName !== \"TD\" && target.tagName !== \"TH\") {\n        target = target.parentElement;\n        if (!regularTable.contains(target)) {\n            return;\n        }\n    }\n\n    if (target.classList.contains(\"psp-tree-label\")) {\n        expandCollapseHandler.call(this, regularTable, event);\n        event.stopImmediatePropagation();\n        return;\n    }\n\n    if (target.classList.contains(\"psp-menu-enabled\")) {\n        const meta = regularTable.getMeta(target);\n        const column_name = meta.column_header?.[this._config.split_by.length];\n        await viewer.toggleColumnSettings(column_name);\n        event.preventDefault();\n        event.stopImmediatePropagation();\n    } else if (target.classList.contains(\"psp-sort-enabled\")) {\n        sortHandler.call(this, regularTable, viewer, event, target);\n        event.stopImmediatePropagation();\n    }\n}\n\nexport function click_listener(regularTable, event) {\n    if (event.which !== 1) {\n        return;\n    }\n\n    let target = event.target;\n    while (target.tagName !== \"TD\" && target.tagName !== \"TH\") {\n        target = target.parentElement;\n        if (!regularTable.contains(target)) {\n            return;\n        }\n    }\n\n    if (target.classList.contains(\"psp-tree-label\") && event.offsetX < 26) {\n        event.stopImmediatePropagation();\n    } else if (\n        target.classList.contains(\"psp-header-leaf\") &&\n        !target.classList.contains(\"psp-header-corner\")\n    ) {\n        event.stopImmediatePropagation();\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { PRIVATE_PLUGIN_SYMBOL } from \"../model\";\n\nfunction isEditable(viewer, allowed = false) {\n    const has_pivots =\n        this._config.group_by.length === 0 &&\n        this._config.split_by.length === 0;\n    const selectable = viewer.hasAttribute(\"selectable\");\n    const editable = allowed || !!viewer.children[0]._is_edit_mode;\n    return has_pivots && !selectable && editable;\n}\n\nexport function editable_style_listener(table, viewer, datagrid) {\n    // Independently check \"editable\" and `isEditable()`, so we can skip\n    // the styler entirely if editing was disabled at the time of element\n    // creation, but toggle in when e.g. pivots or selectable will\n    // affect editability.\n    const plugins = table[PRIVATE_PLUGIN_SYMBOL] || {};\n    const edit = isEditable.call(this, viewer);\n    datagrid.classList.toggle(\n        \"edit-mode-allowed\",\n        isEditable.call(this, viewer, true)\n    );\n\n    for (const td of table.querySelectorAll(\"td\")) {\n        const meta = table.getMeta(td);\n        const type = this.get_psp_type(meta);\n        if (edit && this._is_editable[meta.x]) {\n            const col_name = meta.column_header[this._config.split_by.length];\n            if (type === \"string\" && plugins[col_name]?.format === \"link\") {\n                td.toggleAttribute(\"contenteditable\", false);\n                td.classList.toggle(\"boolean-editable\", false);\n            } else if (type === \"boolean\") {\n                td.toggleAttribute(\"contenteditable\", false);\n                td.classList.toggle(\"boolean-editable\", meta.user !== null);\n            } else {\n                if (edit !== td.hasAttribute(\"contenteditable\")) {\n                    td.toggleAttribute(\"contenteditable\", edit);\n                }\n                td.classList.toggle(\"boolean-editable\", false);\n            }\n        } else {\n            td.toggleAttribute(\"contenteditable\", false);\n            td.classList.toggle(\"boolean-editable\", false);\n        }\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\n// const selected_position_map = new WeakMap();\n\nexport const focus_style_listener = (table, _viewer, selected_position_map) => {\n    const tds = table.querySelectorAll(\"td\");\n    const selected_position = selected_position_map.get(table);\n    const host = table.getRootNode();\n    if (selected_position) {\n        for (const td of tds) {\n            const meta = table.getMeta(td);\n            if (\n                meta.x === selected_position.x &&\n                meta.y === selected_position.y\n            ) {\n                if (host.activeElement !== td) {\n                    td.focus({ preventScroll: true });\n                }\n                return true;\n            }\n        }\n        if (\n            document.activeElement !== document.body &&\n            table.contains(host.activeElement)\n        ) {\n            host.activeElement.blur();\n        }\n    }\n};\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { focus_style_listener } from \"../style_handlers/focus.js\";\n\nfunction lock(body) {\n    let lock;\n    return async function (...args) {\n        if (!!lock && (await lock) && !!lock) {\n            return;\n        }\n\n        let resolve;\n        lock = new Promise((x) => (resolve = x));\n        await body.apply(this, args);\n        lock = undefined;\n        resolve();\n    };\n}\n\nfunction getPos() {\n    if (this.isContentEditable) {\n        let _range = this.getRootNode().getSelection().getRangeAt(0);\n        let range = _range.cloneRange();\n        range.selectNodeContents(this);\n        range.setEnd(_range.endContainer, _range.endOffset);\n        return range.toString().length;\n    } else {\n        return this.target.selectionStart;\n    }\n}\n\nexport function write_cell(table, model, active_cell) {\n    const meta = table.getMeta(active_cell);\n    const type = model._schema[model._column_paths[meta.x]];\n    if (meta) {\n        let text = active_cell.textContent;\n        const id = model._ids[meta.y - meta.y0];\n        if (type === \"float\" || type === \"integer\") {\n            text = parseFloat(text.replace(/,/g, \"\"));\n            if (isNaN(text)) {\n                return false;\n            }\n        } else if (type === \"date\" || type === \"datetime\") {\n            text = Date.parse(text);\n            if (isNaN(text)) {\n                return false;\n            }\n        } else if (type === \"boolean\") {\n            text = text === \"true\" ? false : text === \"false\" ? true : null;\n        }\n\n        const msg = {\n            __INDEX__: id,\n            [model._column_paths[meta.x]]: text,\n        };\n\n        model._table.update([msg], { port_id: model._edit_port });\n        return true;\n    }\n}\n\nexport function is_editable(viewer, allowed = false) {\n    const has_pivots =\n        this._config.group_by.length === 0 &&\n        this._config.split_by.length === 0;\n    const selectable = viewer.hasAttribute(\"selectable\");\n    const editable = allowed || !!viewer.children[0]._is_edit_mode;\n    return has_pivots && !selectable && editable;\n}\n\nconst moveSelection = lock(async function (\n    table,\n    selected_position_map,\n    active_cell,\n    dx,\n    dy\n) {\n    const meta = table.getMeta(active_cell);\n    const num_columns = this._column_paths.length;\n    const num_rows = this._num_rows;\n    const selected_position = selected_position_map.get(table);\n    if (!selected_position) {\n        return;\n    }\n\n    if (meta.x + dx < num_columns && 0 <= meta.x + dx) {\n        selected_position.x = meta.x + dx;\n    }\n\n    if (meta.y + dy < num_rows && 0 <= meta.y + dy) {\n        selected_position.y = meta.y + dy;\n    }\n\n    const xmin = Math.max(meta.x0 - 10, 0);\n    const xmax = Math.min(meta.x0 + 10, num_columns);\n    const ymin = Math.max(meta.y0 - 5, 0);\n    const ymax = Math.min(meta.y0 + 10, num_rows);\n    let x = meta.x0 + dx,\n        y = meta.y0 + dy;\n    while (\n        !focus_style_listener(table, undefined, selected_position_map) &&\n        x >= xmin &&\n        x < xmax &&\n        y >= ymin &&\n        y < ymax\n    ) {\n        await table.scrollToCell(x, y, num_columns, num_rows);\n        selected_position_map.set(table, selected_position);\n        x += dx;\n        y += dy;\n    }\n});\n\n// Events\n\nexport function keydownListener(table, viewer, selected_position_map, event) {\n    if (!is_editable.call(this, viewer)) {\n        return;\n    }\n    const target = table.getRootNode().activeElement;\n    event.target.classList.remove(\"psp-error\");\n    switch (event.key) {\n        case \"Enter\":\n            event.preventDefault();\n            if (event.shiftKey) {\n                moveSelection.call(\n                    this,\n                    table,\n                    selected_position_map,\n                    target,\n                    0,\n                    -1\n                );\n            } else {\n                moveSelection.call(\n                    this,\n                    table,\n                    selected_position_map,\n                    target,\n                    0,\n                    1\n                );\n            }\n            break;\n        case \"ArrowLeft\":\n            if (getPos.call(target) == 0) {\n                event.preventDefault();\n                moveSelection.call(\n                    this,\n                    table,\n                    selected_position_map,\n                    target,\n                    -1,\n                    0\n                );\n            }\n            break;\n        case \"ArrowUp\":\n            event.preventDefault();\n            moveSelection.call(\n                this,\n                table,\n                selected_position_map,\n                target,\n                0,\n                -1\n            );\n            break;\n        case \"ArrowRight\":\n            if (getPos.call(target) == target.textContent.length) {\n                event.preventDefault();\n                moveSelection.call(\n                    this,\n                    table,\n                    selected_position_map,\n                    target,\n                    1,\n                    0\n                );\n            }\n            break;\n        case \"ArrowDown\":\n            event.preventDefault();\n            moveSelection.call(\n                this,\n                table,\n                selected_position_map,\n                target,\n                0,\n                1\n            );\n            break;\n        default:\n    }\n}\n\nexport function clickListener(table, _viewer, event) {\n    const meta = table.getMeta(event.target);\n    if (typeof meta?.x !== \"undefined\") {\n        const is_all_editable = is_editable.call(this, _viewer);\n        const is_editable2 = this._is_editable[meta.x];\n        const is_bool = this.get_psp_type(meta) === \"boolean\";\n        const is_null = event.target.textContent === \"-\";\n        if (is_all_editable && is_editable2 && is_bool && !is_null) {\n            write_cell(table, this, event.target);\n        }\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { is_editable, write_cell } from \"./edit_click.js\";\n\nexport function focusoutListener(table, viewer, selected_position_map, event) {\n    if (is_editable.call(this, viewer) && selected_position_map.has(table)) {\n        event.target.classList.remove(\"psp-error\");\n        const selectedPosition = selected_position_map.get(table);\n        selected_position_map.delete(table);\n        if (selectedPosition.content !== event.target.textContent) {\n            if (!write_cell(table, this, event.target)) {\n                event.target.textContent = selectedPosition.content;\n                event.target.classList.add(\"psp-error\");\n                event.target.focus();\n            }\n        }\n    }\n}\n\nexport function focusinListener(table, _viewer, selected_position_map, event) {\n    const meta = table.getMeta(event.target);\n    if (meta) {\n        const new_state = {\n            x: meta.x,\n            y: meta.y,\n            content: event.target.textContent,\n        };\n        selected_position_map.set(table, new_state);\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport default async function getCellConfig(\n    { _view, _config },\n    row_idx,\n    col_idx\n) {\n    const group_by = _config.group_by;\n    const split_by = _config.split_by;\n    const start_row = row_idx >= 0 ? row_idx : 0;\n    const end_row = start_row + 1;\n    const r = await _view.to_json({ start_row, end_row });\n    const row_paths = r.map((x) => x.__ROW_PATH__);\n    const group_by_values = row_paths[0] || [];\n    const row_filters = group_by\n        .map((pivot, index) => {\n            const pivot_value = group_by_values[index];\n            return pivot_value ? [pivot, \"==\", pivot_value] : undefined;\n        })\n        .filter((x) => x);\n\n    const column_index = group_by.length > 0 ? col_idx + 1 : col_idx;\n    const column_paths = Object.keys(r[0])[column_index];\n    const result = { row: r[0] };\n    let column_filters = [];\n    if (column_paths) {\n        const split_by_values = column_paths.split(\"|\");\n        result.column_names = [split_by_values[split_by.length]];\n        column_filters = split_by\n            .map((pivot, index) => {\n                const pivot_value = split_by_values[index];\n                return pivot_value ? [pivot, \"==\", pivot_value] : undefined;\n            })\n            .filter((x) => x)\n            .filter(([, , value]) => value !== \"__ROW_PATH__\");\n    }\n\n    const filter = _config.filter.concat(row_filters).concat(column_filters);\n    result.config = { filter };\n    return result;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport getCellConfig from \"../get_cell_config.js\";\n\nexport async function selectionListener(\n    regularTable,\n    viewer,\n    selected_rows_map,\n    event\n) {\n    const meta = regularTable.getMeta(event.target);\n    if (!viewer.hasAttribute(\"selectable\")) return;\n    if (event.handled) return;\n    if (event.which !== 1) {\n        return;\n    }\n\n    if (!meta) {\n        return;\n    }\n\n    const id = this._ids[meta.y - meta.y0];\n    if (meta && meta.y >= 0) {\n        const selected = selected_rows_map.get(regularTable);\n        const key_match =\n            !!selected &&\n            selected.reduce((agg, x, i) => agg && x === id[i], true);\n\n        const is_deselect =\n            !!selected && id.length === selected.length && key_match;\n\n        let detail = { selected: !is_deselect };\n        const { row, column_names, config } = await getCellConfig(\n            this,\n            meta.y,\n            meta.x\n        );\n\n        if (is_deselect) {\n            selected_rows_map.delete(regularTable);\n            detail = {\n                ...detail,\n                row,\n                config: { filter: structuredClone(this._config.filter) },\n            };\n        } else {\n            selected_rows_map.set(regularTable, id);\n            detail = { ...detail, row, column_names, config };\n        }\n\n        await regularTable.draw({ preserve_width: true });\n        event.handled = true;\n        viewer.dispatchEvent(\n            new CustomEvent(\"perspective-select\", {\n                bubbles: true,\n                composed: true,\n                detail,\n            })\n        );\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport function selectionStyleListener(\n    regularTable,\n    viewer,\n    selected_rows_map\n) {\n    if (!viewer.hasAttribute(\"selectable\")) return;\n    const has_selected = selected_rows_map.has(regularTable);\n    const selected = selected_rows_map.get(regularTable);\n    for (const td of regularTable.querySelectorAll(\"td\")) {\n        if (!has_selected) {\n            td.classList.toggle(\"psp-row-selected\", false);\n            td.classList.toggle(\"psp-row-subselected\", false);\n        } else {\n            const meta = regularTable.getMeta(td);\n            const id = this._ids[meta.y - meta.y0];\n            const key_match = selected.reduce(\n                (agg, x, i) => agg && x === id[i],\n                true\n            );\n            td.classList.toggle(\n                \"psp-row-selected\",\n                id.length === selected.length && key_match\n            );\n            td.classList.toggle(\n                \"psp-row-subselected\",\n                id.length !== selected.length && key_match\n            );\n        }\n    }\n\n    for (const th of regularTable.querySelectorAll(\"tbody th\")) {\n        const meta = regularTable.getMeta(th);\n        const id = this._ids[meta.y - meta.y0];\n        if (!has_selected || !!id[meta.row_header_x]) {\n            th.classList.toggle(\"psp-row-selected\", false);\n            th.classList.toggle(\"psp-row-subselected\", false);\n        } else {\n            const key_match = selected.reduce(\n                (agg, x, i) => agg && x === id[i],\n                true\n            );\n            th.classList.toggle(\n                \"psp-row-selected\",\n                id.length === selected.length && key_match\n            );\n            th.classList.toggle(\n                \"psp-row-subselected\",\n                id.length !== selected.length && key_match\n            );\n        }\n    }\n}\n\n//  export function configureRowSelectable(table, viewer) {\n//      table.addStyleListener(selectionStyleListener.bind(this, table, viewer));\n//      table.addEventListener(\n//          \"mousedown\",\n//          selectionListener.bind(this, table, viewer)\n//      );\n//  }\n\n// export async function deselect(regularTable) {\n//     selected_rows_map.delete(regularTable);\n//     for (const td of regularTable.querySelectorAll(\"td,th\")) {\n//         td.classList.toggle(\"psp-row-selected\", false);\n//         td.classList.toggle(\"psp-row-subselected\", false);\n//     }\n// }\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport async function deselect_all_listener(\n    regularTable,\n    _viewer,\n    selected_rows_map\n) {\n    selected_rows_map.delete(regularTable);\n    for (const td of regularTable.querySelectorAll(\"td,th\")) {\n        td.classList.toggle(\"psp-row-selected\", false);\n        td.classList.toggle(\"psp-row-subselected\", false);\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport chroma from \"chroma-js\";\nimport { createDataListener } from \"../data_listener\";\nimport { blend, make_color_record } from \"../color_utils.js\";\n\nfunction get_rule(regular, tag, def) {\n    let color = window.getComputedStyle(regular).getPropertyValue(tag).trim();\n    if (color.length > 0) {\n        return color;\n    } else {\n        return def;\n    }\n}\n\nclass ElemFactory {\n    constructor(name) {\n        this._name = name;\n        this._elements = [];\n        this._index = 0;\n    }\n\n    clear() {\n        this._index = 0;\n    }\n\n    get() {\n        if (!this._elements[this._index]) {\n            this._elements[this._index] = document.createElement(this._name);\n        }\n        const elem = this._elements[this._index];\n        this._index += 1;\n        return elem;\n    }\n}\n\nfunction get_psp_type(metadata) {\n    if (metadata.x >= 0) {\n        return this._column_types[metadata.x];\n    } else {\n        return this._row_header_types[metadata.row_header_x - 1];\n    }\n}\n\nexport async function createModel(regular, table, view, extend = {}) {\n    const config = await view.get_config();\n\n    // Extract the entire expression string as typed by the user, so we can\n    // feed it into `validate_expressions` and get back the data types for\n    // each column without it being affected by a pivot.\n    const expressions = Object.fromEntries(\n        config.expressions.map((expr) => [expr[0], expr[1]])\n    );\n    const [\n        table_schema,\n        validated_expressions,\n        num_rows,\n        schema,\n        expression_schema,\n        column_paths,\n        _edit_port,\n    ] = await Promise.all([\n        table.schema(),\n        table.validate_expressions(expressions),\n        view.num_rows(),\n        view.schema(),\n        view.expression_schema(),\n        view.column_paths(),\n        this.parentElement.getEditPort(),\n    ]);\n\n    const _plugin_background = chroma(\n        get_rule(regular, \"--plugin--background\", \"#FFFFFF\")\n    ).rgb();\n\n    const _pos_fg_color = make_color_record(\n        get_rule(regular, \"--rt-pos-cell--color\", \"#338DCD\")\n    );\n\n    const _neg_fg_color = make_color_record(\n        get_rule(regular, \"--rt-neg-cell--color\", \"#FF5942\")\n    );\n\n    const _pos_bg_color = make_color_record(\n        blend(_pos_fg_color[0], _plugin_background)\n    );\n\n    const _neg_bg_color = make_color_record(\n        blend(_neg_fg_color[0], _plugin_background)\n    );\n\n    const _color = make_color_record(\n        get_rule(regular, \"--active--color\", \"#ff0000\")\n    );\n\n    const _schema = { ...schema, ...expression_schema };\n    const _table_schema = {\n        ...table_schema,\n        ...validated_expressions.expression_schema,\n    };\n\n    const _column_paths = column_paths.filter((path) => {\n        return path !== \"__ROW_PATH__\" && path !== \"__ID__\";\n    });\n\n    const _is_editable = [];\n    const _column_types = [];\n    for (const column_path of _column_paths) {\n        const column_path_parts = column_path.split(\"|\");\n        const column = column_path_parts[config.split_by.length];\n        _column_types.push(_schema[column]);\n        _is_editable.push(!!table_schema[column]);\n    }\n\n    const model = Object.assign(extend, {\n        _edit_port,\n        _view: view,\n        _table: table,\n        _table_schema,\n        _config: config,\n        _num_rows: num_rows,\n        _schema,\n        _ids: [],\n        _plugin_background,\n        _color,\n        _pos_fg_color,\n        _neg_fg_color,\n        _pos_bg_color,\n        _neg_bg_color,\n        _column_paths,\n        _column_types,\n        _is_editable,\n        _row_header_types: config.group_by.map((column_path) => {\n            return _table_schema[column_path];\n        }),\n        _series_color_map: new Map(),\n        _series_color_seed: new Map(),\n        get_psp_type,\n    });\n\n    // Re-use div factory\n    model._div_factory = model._div_factory || new ElemFactory(\"div\");\n    regular.setDataListener(\n        createDataListener(this.parentElement).bind(model, regular),\n        {\n            virtual_mode:\n                window\n                    .getComputedStyle(regular)\n                    .getPropertyValue(\"--datagrid-virtual-mode\")\n                    ?.trim() || \"both\",\n        }\n    );\n\n    return model;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\n/**\n * The default settings which populate `perspective.config.js`.\n */\nexport default {\n    /**\n     * `types` are the type-specific configuration options.  Each key is the\n     * name of a perspective type; their values are configuration objects for\n     * that type.\n     */\n    types: {\n        float: {\n            /**\n             * Which filter operator should be the default when a column of this\n             * type is pivotted.\n             */\n            filter_operator: \"==\",\n\n            /**\n             * Which aggregate should be the default when a column of this type\n             * is pivotted.\n             */\n            aggregate: \"sum\",\n\n            /**\n             * The format object for this type.  Can be either an\n             * `toLocaleString()` `options` object for this type (or supertype),\n             * or a function which returns the formatted string for this type.\n             */\n            format: {\n                style: \"decimal\",\n                minimumFractionDigits: 2,\n                maximumFractionDigits: 2,\n            },\n        },\n        string: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n        },\n        integer: {\n            filter_operator: \"==\",\n            aggregate: \"sum\",\n            format: {},\n        },\n        boolean: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n        },\n        datetime: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n            format: {\n                dateStyle: \"short\",\n                timeStyle: \"medium\",\n            },\n            null_value: -1,\n        },\n        date: {\n            filter_operator: \"==\",\n            aggregate: \"count\",\n            format: {\n                dateStyle: \"short\",\n            },\n            null_value: -1,\n        },\n    },\n};\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport DEFAULT_CONFIG from \"./settings.js\";\n\nexport function get_types() {\n    return Object.keys(get_config().types);\n}\n\nexport function get_type_config(type) {\n    const config = {};\n    if (get_config().types[type]) {\n        Object.assign(config, get_config().types[type]);\n    }\n    if (config.type) {\n        const props = get_type_config(config.type);\n        Object.assign(props, config);\n        return props;\n    } else {\n        return config;\n    }\n}\n\nfunction isObject(item) {\n    return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\nfunction mergeDeep(target, ...sources) {\n    if (!sources.length) return target;\n    const source = sources.shift();\n\n    if (isObject(target) && isObject(source)) {\n        for (const key in source) {\n            if (isObject(source[key])) {\n                if (!target[key]) Object.assign(target, { [key]: {} });\n                mergeDeep(target[key], source[key]);\n            } else {\n                Object.assign(target, { [key]: source[key] });\n            }\n        }\n    }\n\n    return mergeDeep(target, ...sources);\n}\n\nexport function override_config(config) {\n    if (globalThis.__PERSPECTIVE_CONFIG__) {\n        console.warn(\"Config already initialized!\");\n    }\n    globalThis.__PERSPECTIVE_CONFIG__ = mergeDeep(DEFAULT_CONFIG, config);\n}\n\nexport function get_config() {\n    if (!globalThis.__PERSPECTIVE_CONFIG__) {\n        globalThis.__PERSPECTIVE_CONFIG__ = mergeDeep(\n            DEFAULT_CONFIG,\n            globalThis.__TEMPLATE_CONFIG__ || {}\n        );\n    }\n    return globalThis.__PERSPECTIVE_CONFIG__;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { get_type_config } from \"@finos/perspective/src/js/config/index.js\";\n\nconst FORMATTER_CONS = {\n    datetime: Intl.DateTimeFormat,\n    date: Intl.DateTimeFormat,\n    integer: Intl.NumberFormat,\n    float: Intl.NumberFormat,\n    boolean: class {\n        format(val) {\n            return val ? \"true\" : \"false\";\n        }\n    },\n};\n\nexport class FormatterCache {\n    constructor() {\n        this._formatters = new Map();\n    }\n\n    create_datetime_formatter(type, plugin) {\n        const type_config = get_type_config(type);\n        if (type === \"datetime\") {\n            if (plugin.date_format?.format !== \"custom\") {\n                const options = {\n                    ...type_config.format,\n                    timeZone: plugin.date_format?.timeZone,\n                    dateStyle: plugin.date_format?.dateStyle,\n                    timeStyle: plugin.date_format?.timeStyle,\n                };\n                if (options.dateStyle === \"disabled\") {\n                    options.dateStyle = undefined;\n                } else if (options.dateStyle === undefined) {\n                    options.dateStyle = type_config.format.dateStyle;\n                }\n\n                if (options.timeStyle === \"disabled\") {\n                    options.timeStyle = undefined;\n                } else if (options.timeStyle === undefined) {\n                    options.timeStyle = type_config.format.timeStyle;\n                }\n\n                return new Intl.DateTimeFormat(navigator.languages, options);\n            } else {\n                const options = {\n                    // ...type_config.format,\n                    timeZone: plugin.date_format?.timeZone,\n                    second: plugin.date_format?.second,\n                    minute: plugin.date_format?.minute,\n                    hour: plugin.date_format?.hour,\n                    day: plugin.date_format?.day,\n                    weekday: plugin.date_format?.weekday,\n                    month: plugin.date_format?.month,\n                    year: plugin.date_format?.year,\n                    hour12: plugin.date_format?.hour12,\n                    fractionalSecondDigits:\n                        plugin.date_format?.fractionalSecondDigits,\n                };\n\n                if (options.year === \"disabled\") {\n                    options.year = undefined;\n                } else if (options.year === undefined) {\n                    options.year = \"2-digit\";\n                }\n\n                if (options.month === \"disabled\") {\n                    options.month = undefined;\n                } else if (options.month === undefined) {\n                    options.month = \"numeric\";\n                }\n\n                if (options.day === \"disabled\") {\n                    options.day = undefined;\n                } else if (options.day === undefined) {\n                    options.day = \"numeric\";\n                }\n\n                if (options.weekday === \"disabled\") {\n                    options.weekday = undefined;\n                }\n\n                if (options.hour === \"disabled\") {\n                    options.hour = undefined;\n                } else if (options.hour === undefined) {\n                    options.hour = \"numeric\";\n                }\n\n                if (options.minute === \"disabled\") {\n                    options.minute = undefined;\n                } else if (options.minute === undefined) {\n                    options.minute = \"numeric\";\n                }\n\n                if (options.second === \"disabled\") {\n                    options.second = undefined;\n                } else if (options.second === undefined) {\n                    options.second = \"numeric\";\n                }\n\n                if (options.hour12 === undefined) {\n                    options.hour12 = true;\n                }\n\n                return new Intl.DateTimeFormat(navigator.languages, options);\n            }\n        } else {\n            const options = {\n                ...type_config.format,\n                dateStyle: plugin.date_format?.dateStyle,\n            };\n\n            if (options.dateStyle === \"disabled\") {\n                options.dateStyle = undefined;\n            } else if (options.dateStyle === undefined) {\n                options.dateStyle = type_config.format.dateStyle;\n            }\n\n            return new Intl.DateTimeFormat(navigator.languages, options);\n        }\n    }\n\n    create_number_formatter(type, plugin) {\n        let { format } = get_type_config(type);\n        if (plugin.number_format !== undefined) {\n            format = plugin.number_format;\n        }\n\n        return new FORMATTER_CONS[type](navigator.languages, format);\n    }\n\n    create_boolean_formatter(type, plugin) {\n        const type_config = get_type_config(type);\n        return new FORMATTER_CONS[type](\n            navigator.languages,\n            type_config.format\n        );\n    }\n\n    get(type, plugin) {\n        let formatter_key = [\n            type,\n            ...Object.values(plugin.date_format ?? {}),\n            ...Object.values(plugin.number_format ?? {}),\n        ].join(\"-\");\n\n        if (!this._formatters.has(formatter_key)) {\n            const type_config = get_type_config(type);\n            if (type === \"date\" || type === \"datetime\") {\n                this._formatters.set(\n                    formatter_key,\n                    this.create_datetime_formatter(type, plugin)\n                );\n            } else if (type === \"integer\" || type === \"float\") {\n                this._formatters.set(\n                    formatter_key,\n                    this.create_number_formatter(type, plugin)\n                );\n            } else if (type === \"boolean\") {\n                this._formatters.set(\n                    formatter_key,\n                    this.create_boolean_formatter(type, plugin)\n                );\n            } else {\n                this._formatters.set(formatter_key, false);\n            }\n        }\n\n        return this._formatters.get(formatter_key);\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { FormatterCache } from \"./formatter_cache\";\n\nconst FORMAT_CACHE = new FormatterCache();\nconst MAX_BAR_WIDTH_PCT = 1;\n\n/**\n * Format a single cell's text content as the content of a `<td>` or `<th>`.\n *\n * @param {*} parts\n * @param {*} val\n * @param {*} plugins\n * @param {*} use_table_schema\n * @returns\n */\nexport function format_cell(\n    title,\n    val,\n    plugins = {},\n    use_table_schema = false\n) {\n    if (val === null) {\n        return \"-\";\n    }\n\n    const type =\n        (use_table_schema && this._table_schema[title]) ||\n        this._schema[title] ||\n        \"string\";\n    const plugin = plugins[title] || {};\n    const is_numeric = type === \"integer\" || type === \"float\";\n    if (is_numeric && plugin?.number_fg_mode === \"bar\") {\n        const a = Math.max(\n            0,\n            Math.min(\n                MAX_BAR_WIDTH_PCT,\n                Math.abs(val / plugin.fg_gradient) * MAX_BAR_WIDTH_PCT\n            )\n        );\n\n        const div = this._div_factory.get();\n        const anchor = val >= 0 ? \"left\" : \"right\";\n        const pct = (a * 100).toFixed(2);\n        div.setAttribute(\n            \"style\",\n            `width:calc(${pct}% - 4px);position:absolute;${anchor}:2px;height:80%;top:10%;pointer-events:none;`\n        );\n\n        return div;\n    } else if (plugin?.format === \"link\" && type === \"string\") {\n        const anchor = document.createElement(\"a\");\n        anchor.setAttribute(\"href\", val);\n        anchor.setAttribute(\"target\", \"_blank\");\n        anchor.textContent = val;\n        return anchor;\n    } else if (plugin?.format === \"bold\" && type === \"string\") {\n        const anchor = document.createElement(\"b\");\n        anchor.textContent = val;\n        return anchor;\n    } else if (plugin?.format === \"italics\" && type === \"string\") {\n        const anchor = document.createElement(\"i\");\n        anchor.textContent = val;\n        return anchor;\n    } else {\n        const formatter = FORMAT_CACHE.get(type, plugin);\n        return formatter ? formatter.format(val) : val;\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { PRIVATE_PLUGIN_SYMBOL } from \"../model\";\nimport { format_cell } from \"./format_cell.js\";\n\n/**\n * Format a single cell of the `group_by` tree header.\n *\n * @param {*} paths\n * @param {*} row_headers\n * @param {*} regularTable\n */\nexport function* format_tree_header(paths = [], row_headers, regularTable) {\n    const plugins = regularTable[PRIVATE_PLUGIN_SYMBOL];\n    for (let path of paths) {\n        path = [\"TOTAL\", ...path];\n        const last = path[path.length - 1];\n        path = path.slice(0, path.length - 1).fill(\"\");\n        const formatted = format_cell.call(\n            this,\n            row_headers[path.length - 1],\n            last,\n            plugins,\n            true\n        );\n\n        if (formatted instanceof HTMLElement) {\n            path = path.concat(formatted);\n        } else {\n            path = path.concat({ toString: () => formatted });\n        }\n\n        path.length = row_headers.length + 1;\n        yield path;\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { PRIVATE_PLUGIN_SYMBOL } from \"../model\";\nimport { format_cell } from \"./format_cell.js\";\nimport { format_tree_header } from \"./format_tree_header.js\";\n\n/**\n * Creates a new DataListener, suitable for passing to `regular-table`'s\n * `.setDataListener()` method.  This should be called as a method on the\n * plugin.\n *\n * @returns A data listener for the plugin.\n */\nexport function createDataListener(viewer) {\n    let last_meta;\n    let last_column_paths;\n    let last_ids;\n    let last_reverse_ids;\n    let last_reverse_columns;\n    return async function dataListener(regularTable, x0, y0, x1, y1) {\n        let columns = {};\n        let new_window;\n        if (x1 - x0 > 0 && y1 - y0 > 0) {\n            this._is_old_viewport =\n                this._last_window?.start_row === y0 &&\n                this._last_window?.end_row === y1 &&\n                this._last_window?.start_col === x0 &&\n                this._last_window?.end_col === x1;\n\n            new_window = {\n                start_row: y0,\n                start_col: x0,\n                end_row: y1,\n                end_col: x1,\n                id: true,\n            };\n\n            columns = JSON.parse(\n                await this._view.to_columns_string(new_window)\n            );\n\n            this._last_window = new_window;\n            this._ids = columns.__ID__;\n            this._reverse_columns = this._column_paths\n                .slice(x0, x1)\n                .reduce((acc, x, i) => {\n                    acc.set(x, i);\n                    return acc;\n                }, new Map());\n\n            this._reverse_ids = this._ids.reduce((acc, x, i) => {\n                acc.set(x?.join(\"|\"), i);\n                return acc;\n            }, new Map());\n        } else {\n            this._div_factory.clear();\n        }\n\n        const data = [],\n            metadata = [],\n            column_headers = [],\n            column_paths = [];\n\n        const is_settings_open = viewer.hasAttribute(\"settings\");\n\n        // for (const path of this._column_paths.slice(x0, x1)) {\n        for (\n            let ipath = x0;\n            ipath < Math.min(x1, this._column_paths.length);\n            ++ipath\n        ) {\n            const path = this._column_paths[ipath];\n            const path_parts = path.split(\"|\");\n            const column = columns[path] || new Array(y1 - y0).fill(null);\n            data.push(\n                column.map((x) =>\n                    format_cell.call(\n                        this,\n                        path_parts[this._config.split_by.length],\n                        x,\n                        regularTable[PRIVATE_PLUGIN_SYMBOL]\n                    )\n                )\n            );\n            metadata.push(column);\n            if (is_settings_open) {\n                path_parts.push(\"\");\n            }\n\n            column_headers.push(path_parts);\n            column_paths.push(path);\n        }\n\n        // Only update the last state if this is not a \"phantom\" call.\n        if (x1 - x0 > 0 && y1 - y0 > 0) {\n            this.last_column_paths = last_column_paths;\n            this.last_meta = last_meta;\n            this.last_ids = last_ids;\n            this.last_reverse_ids = last_reverse_ids;\n            this.last_reverse_columns = last_reverse_columns;\n\n            last_column_paths = column_paths;\n            last_meta = metadata;\n            last_ids = this._ids;\n            last_reverse_ids = this._reverse_ids;\n            last_reverse_columns = this._reverse_columns;\n        }\n\n        return {\n            num_rows: this._num_rows,\n            num_columns: this._column_paths.length,\n            row_headers: Array.from(\n                format_tree_header.call(\n                    this,\n                    columns.__ROW_PATH__,\n                    this._config.group_by,\n                    regularTable\n                )\n            ),\n            column_headers,\n            data,\n            metadata,\n            column_header_merge_depth: Math.max(\n                0,\n                this._config.split_by.length\n            ),\n        };\n    };\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport getCellConfig from \"../get_cell_config\";\n\nexport async function dispatch_click_listener(table, viewer, event) {\n    const meta = table.getMeta(event.target);\n    if (!meta) return;\n    const { x, y } = meta;\n\n    const { row, column_names, config } = await getCellConfig(this, y, x);\n\n    viewer.dispatchEvent(\n        new CustomEvent(\"perspective-click\", {\n            bubbles: true,\n            composed: true,\n            detail: {\n                row,\n                column_names,\n                config,\n            },\n        })\n    );\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport {\n    column_header_style_listener,\n    style_selected_column,\n} from \"../style_handlers/column_header.js\";\nimport { group_header_style_listener } from \"../style_handlers/group_header.js\";\nimport { table_cell_style_listener } from \"../style_handlers/table_cell\";\nimport {\n    click_listener,\n    mousedown_listener,\n} from \"../event_handlers/header_click.js\";\n\nimport { editable_style_listener } from \"../style_handlers/editable.js\";\nimport { focus_style_listener } from \"../style_handlers/focus.js\";\nimport { focusinListener, focusoutListener } from \"../event_handlers/focus.js\";\nimport {\n    keydownListener,\n    clickListener,\n} from \"../event_handlers/edit_click.js\";\n\nimport { selectionListener } from \"../event_handlers/row_select_click\";\nimport { selectionStyleListener } from \"../style_handlers/selection\";\nimport { deselect_all_listener } from \"../event_handlers/deselect_all.js\";\n\nimport { createModel } from \"../model/create.js\";\nimport { dispatch_click_listener } from \"../event_handlers/dispatch_click\";\n\n/**\n * Lazy initialize this plugin with various listeners.\n */\nexport async function activate(view) {\n    let viewer = this.parentElement;\n    let table = await viewer.getTable(true);\n    if (!this._initialized) {\n        this.innerHTML = \"\";\n        if (this.shadowRoot) {\n            this.shadowRoot.appendChild(this.regular_table);\n        } else {\n            this.appendChild(this.regular_table);\n        }\n        this.model = await createModel.call(\n            this,\n            this.regular_table,\n            table,\n            view\n        );\n\n        this.regular_table.addStyleListener(\n            table_cell_style_listener.bind(\n                this.model,\n                this.regular_table,\n                viewer\n            )\n        );\n\n        this.regular_table.addStyleListener(\n            group_header_style_listener.bind(this.model, this.regular_table)\n        );\n\n        this.regular_table.addStyleListener(\n            column_header_style_listener.bind(\n                this.model,\n                this.regular_table,\n                viewer\n            )\n        );\n\n        this.regular_table.addEventListener(\n            \"click\",\n            click_listener.bind(this.model, this.regular_table)\n        );\n\n        this.regular_table.addEventListener(\n            \"mousedown\",\n            mousedown_listener.bind(this.model, this.regular_table, viewer)\n        );\n\n        // Row selection\n        const selected_rows_map = new WeakMap();\n        this.regular_table.addStyleListener(\n            selectionStyleListener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                selected_rows_map\n            )\n        );\n\n        this.regular_table.addEventListener(\n            \"mousedown\",\n            selectionListener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                selected_rows_map\n            )\n        );\n\n        this.regular_table.addEventListener(\n            \"psp-deselect-all\",\n            deselect_all_listener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                selected_rows_map\n            )\n        );\n\n        // User click\n        this.regular_table.addEventListener(\n            \"click\",\n            dispatch_click_listener.bind(this.model, this.regular_table, viewer)\n        );\n\n        // Editing\n        const selected_position_map = new WeakMap();\n        this.regular_table.addStyleListener(\n            editable_style_listener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                this\n            )\n        );\n        this.regular_table.addStyleListener(\n            focus_style_listener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                selected_position_map\n            )\n        );\n        this.regular_table.addEventListener(\n            \"click\",\n            clickListener.bind(this.model, this.regular_table, viewer)\n        );\n        this.regular_table.addEventListener(\n            \"focusin\",\n            focusinListener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                selected_position_map\n            )\n        );\n        this.regular_table.addEventListener(\n            \"focusout\",\n            focusoutListener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                selected_position_map\n            )\n        );\n        this.regular_table.addEventListener(\n            \"keydown\",\n            keydownListener.bind(\n                this.model,\n                this.regular_table,\n                viewer,\n                selected_position_map\n            )\n        );\n\n        // viewer event listeners\n        viewer.addEventListener(\n            \"perspective-toggle-column-settings\",\n            (event) => {\n                if (this.isConnected) {\n                    style_selected_column.call(\n                        this.model,\n                        this.regular_table,\n                        viewer,\n                        event.detail.column_name\n                    );\n                    if (!event.detail.open) {\n                        this.model._column_settings_selected_column = null;\n                        return;\n                    }\n\n                    this.model._column_settings_selected_column =\n                        event.detail.column_name;\n                }\n            }\n        );\n\n        this._initialized = true;\n    } else {\n        await createModel.call(\n            this,\n            this.regular_table,\n            table,\n            view,\n            this.model\n        );\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\n/**\n * Restore a saved column width override token.\n *\n * @param {*} token An object previously returned by a call to\n * `_save_column_size_overrides()`\n * @param {*} [cache=false] A flag indicating whether this value should\n * be cached so a future `resetAutoSize()` call does not clear it.\n * @returns\n */\nexport function restore_column_size_overrides(old_sizes, cache = false) {\n    if (!this._initialized) {\n        return;\n    }\n\n    if (cache) {\n        this._cached_column_sizes = old_sizes;\n    }\n\n    const overrides = {};\n    const { group_by, columns } = this.model._config;\n    const tree_header_offset = group_by?.length > 0 ? group_by.length + 1 : 0;\n\n    for (const key of Object.keys(old_sizes)) {\n        if (key === \"__ROW_PATH__\") {\n            overrides[tree_header_offset - 1] = old_sizes[key];\n        } else {\n            const index = this.model._column_paths.indexOf(key);\n            overrides[index + tree_header_offset] = old_sizes[key];\n        }\n    }\n\n    this.regular_table._column_sizes.override = overrides;\n}\n\n/**\n * Extract the current user-overriden column widths from\n * `regular-table`.  This functiond depends on the internal\n * implementation of `regular-table` and may break!\n *\n * @returns An Object-as-dictionary keyed by column_path string, and\n * valued by the column's user-overridden pixel width.\n */\nexport function save_column_size_overrides() {\n    if (!this._initialized) {\n        return [];\n    }\n\n    if (this._cached_column_sizes) {\n        const x = this._cached_column_sizes;\n        this._cached_column_sizes = undefined;\n        return x;\n    }\n\n    const overrides = this.regular_table._column_sizes.override;\n    const { group_by, columns } = this.model._config;\n    const tree_header_offset = group_by?.length > 0 ? group_by.length + 1 : 0;\n\n    const old_sizes = {};\n    for (const key of Object.keys(overrides)) {\n        if (overrides[key] !== undefined) {\n            const index = key - tree_header_offset;\n            if (index > -1) {\n                old_sizes[this.model._column_paths[index]] = overrides[key];\n            } else if (index === -1) {\n                old_sizes[\"__ROW_PATH__\"] = overrides[key];\n            }\n        }\n    }\n\n    return old_sizes;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nexport function toggle_edit_mode(force = undefined) {\n    if (typeof force === \"undefined\") {\n        force = !this._is_edit_mode;\n    }\n\n    this._is_edit_mode = force;\n    this.classList.toggle(\"editable\", force);\n    if (this._edit_mode !== undefined) {\n        this._edit_mode.classList.toggle(\"editable\", force);\n    }\n}\n\nexport function toggle_scroll_lock(force = undefined) {\n    if (typeof force === \"undefined\") {\n        force = !this._is_scroll_lock;\n    }\n\n    this._is_scroll_lock = force;\n    this.classList.toggle(\"sub-cell-scroll-disabled\", force);\n    if (this._scroll_lock !== undefined) {\n        this._scroll_lock.classList.toggle(\"lock-scroll\", force);\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { restore_column_size_overrides } from \"../model/column_overrides.js\";\nimport { toggle_edit_mode, toggle_scroll_lock } from \"../model/toolbar.js\";\nimport { PRIVATE_PLUGIN_SYMBOL } from \"../model\";\nimport { make_color_record } from \"../color_utils.js\";\n\n/**\n * Restore this plugin's state from a previously saved `token`.\n *\n * @param {*} token A token returned from `save()`.\n * @param {import(\"@finos/perspective-viewer\").PerspectiveColumnConfig} columns Viewer column settings\n */\nexport function restore(token, columns) {\n    token = JSON.parse(JSON.stringify(token));\n    columns = JSON.parse(JSON.stringify(columns));\n    const overrides = {};\n\n    if (token.columns) {\n        for (const [col, value] of Object.entries(token.columns)) {\n            if (value.column_size_override !== undefined) {\n                overrides[col] = value.column_size_override;\n                delete value[\"column_size_override\"];\n            }\n        }\n    }\n\n    let styles = {};\n    if (columns) {\n        for (const [col_name, controls] of Object.entries(columns)) {\n            styles[col_name] = {\n                ...controls,\n                pos_fg_color: controls.pos_fg_color\n                    ? make_color_record(controls.pos_fg_color)\n                    : undefined,\n                neg_fg_color: controls.neg_fg_color\n                    ? make_color_record(controls.neg_fg_color)\n                    : undefined,\n                pos_bg_color: controls.pos_bg_color\n                    ? make_color_record(controls.pos_bg_color)\n                    : undefined,\n                neg_bg_color: controls.neg_bg_color\n                    ? make_color_record(controls.neg_bg_color)\n                    : undefined,\n                color: controls.color\n                    ? make_color_record(controls.color)\n                    : undefined,\n            };\n        }\n    }\n\n    if (\"editable\" in token) {\n        toggle_edit_mode.call(this, token.editable);\n    }\n\n    if (\"scroll_lock\" in token) {\n        toggle_scroll_lock.call(this, token.scroll_lock);\n    }\n\n    const datagrid = this.regular_table;\n    restore_column_size_overrides.call(this, overrides, true);\n    datagrid[PRIVATE_PLUGIN_SYMBOL] = styles;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { PRIVATE_PLUGIN_SYMBOL } from \"../model\";\nimport { save_column_size_overrides } from \"../model/column_overrides.js\";\n\n/**\n * Serialize the state of this plugin to a token.\n *\n * @returns This plugin's state as a token.\n */\nexport function save() {\n    if (this.regular_table) {\n        const token = {\n            columns: {},\n            scroll_lock: !!this._is_scroll_lock,\n            editable: !!this._is_edit_mode,\n        };\n\n        const column_size_overrides = save_column_size_overrides.call(this);\n\n        for (const col of Object.keys(column_size_overrides || {})) {\n            if (!token.columns[col]) {\n                token.columns[col] = {};\n            }\n\n            token.columns[col].column_size_override =\n                column_size_overrides[col];\n        }\n\n        return JSON.parse(JSON.stringify(token));\n    }\n    return {};\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { restore_column_size_overrides } from \"../model/column_overrides.js\";\nimport { save_column_size_overrides } from \"../model/column_overrides.js\";\n\n/**\n * Draw this datagrid instance.\n *\n * @param {perspective.View} view\n * @returns\n */\nexport async function draw(view) {\n    if (this.parentElement) {\n        await this.activate(view);\n    }\n\n    if (!this.isConnected || this.offsetParent == null) {\n        return;\n    }\n\n    const old_sizes = save_column_size_overrides.call(this);\n    const draw = this.regular_table.draw({ invalid_columns: true });\n    if (!this.model._preserve_focus_state) {\n        this.regular_table.scrollTop = 0;\n        this.regular_table.scrollLeft = 0;\n        this.regular_table.dispatchEvent(\n            new CustomEvent(\"psp-deselect-all\", { bubbles: false })\n        );\n        this.regular_table._resetAutoSize();\n    } else {\n        this.model._preserve_focus_state = false;\n    }\n\n    restore_column_size_overrides.call(this, old_sizes);\n    await draw;\n\n    this._toolbar.classList.toggle(\n        \"aggregated\",\n        this.model._config.group_by.length > 0 ||\n            this.model._config.split_by.length > 0\n    );\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\n/**\n * @param {import(\"@finos/perspective\").Type} type\n * @param {string} _group\n * @returns {import(\"@finos/perspective-viewer\").PerspectiveColumnConfigValue}\n */\nexport default function column_style_opts(type, _group) {\n    if (type === \"integer\" || type === \"float\")\n        return {\n            datagrid_number_style: {\n                fg_gradient: 0,\n                pos_fg_color: this.model._pos_fg_color[0],\n                neg_fg_color: this.model._neg_fg_color[0],\n                number_fg_mode: \"color\",\n                bg_gradient: 0,\n                pos_bg_color: this.model._pos_bg_color[0],\n                neg_bg_color: this.model._neg_bg_color[0],\n                number_bg_mode: \"disabled\",\n            },\n            number_string_format: true,\n        };\n    else if (type === \"date\" || type === \"datetime\" || type === \"string\") {\n        let control =\n            type === \"date\" || type === \"datetime\"\n                ? \"datagrid_datetime_style\"\n                : `datagrid_string_style`;\n        return {\n            [control]: {\n                color: this.model._color[0],\n                bg_color: this.model._color[0],\n            },\n        };\n    } else {\n        return null;\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport { activate } from \"../plugin/activate.js\";\nimport { restore } from \"../plugin/restore.js\";\nimport { save } from \"../plugin/save\";\nimport { draw } from \"../plugin/draw\";\nimport column_style_controls from \"../plugin/column_style_controls.js\";\nimport datagridStyles from \"../../../dist/css/perspective-viewer-datagrid.css\";\n\n/**\n * The custom element class for this plugin.  The interface methods for this\n */\nexport class HTMLPerspectiveViewerDatagridPluginElement extends HTMLElement {\n    constructor() {\n        super();\n        this.regular_table = document.createElement(\"regular-table\");\n        this.regular_table.part = \"regular-table\";\n        this._is_scroll_lock = false;\n        const Elem = HTMLPerspectiveViewerDatagridPluginElement;\n        if (Elem.renderTarget == \"shadow\") {\n            if (!Elem.#sheet) {\n                Elem.#sheet = new CSSStyleSheet();\n                Elem.#sheet.replaceSync(datagridStyles);\n            }\n\n            const shadow = this.attachShadow({ mode: \"open\" });\n            shadow.adoptedStyleSheets.push(Elem.#sheet);\n        }\n    }\n\n    connectedCallback() {\n        if (!this._toolbar) {\n            this._toolbar = document.createElement(\n                \"perspective-viewer-datagrid-toolbar\"\n            );\n        }\n\n        const parent = this.parentElement;\n        if (parent) {\n            parent.appendChild(this._toolbar);\n        }\n    }\n\n    disconnectedCallback() {\n        this._toolbar.parentElement.removeChild(this._toolbar);\n    }\n\n    async activate(view) {\n        return await activate.call(this, view);\n    }\n\n    get name() {\n        return \"Datagrid\";\n    }\n\n    get category() {\n        return \"Basic\";\n    }\n\n    get select_mode() {\n        return \"toggle\";\n    }\n\n    get min_config_columns() {\n        return undefined;\n    }\n\n    get config_column_names() {\n        return [\"Columns\"];\n    }\n\n    /**\n     * Give the Datagrid a higher priority so it is loaded\n     * over the default charts by default.\n     */\n    get priority() {\n        return 1;\n    }\n\n    can_render_column_styles(type, _group) {\n        return type !== \"boolean\";\n    }\n\n    column_style_controls(type, group) {\n        return column_style_controls.call(this, type, group);\n    }\n\n    async draw(view) {\n        return await draw.call(this, view);\n    }\n\n    async update(view) {\n        this.model._num_rows = await view.num_rows();\n        await this.regular_table.draw();\n    }\n\n    async resize() {\n        if (!this.isConnected || this.offsetParent == null) {\n            return;\n        }\n\n        if (this._initialized) {\n            await this.regular_table.draw();\n        }\n    }\n\n    async clear() {\n        this.regular_table._resetAutoSize();\n        this.regular_table.clear();\n    }\n\n    save() {\n        return save.call(this);\n    }\n\n    restore(token, columns_config) {\n        return restore.call(this, token, columns_config);\n    }\n\n    async restyle(view) {\n        await this.draw(view);\n    }\n\n    delete() {\n        if (this.regular_table.table_model) {\n            this.regular_table._resetAutoSize();\n        }\n        this.regular_table.clear();\n    }\n\n    static renderTarget =\n        window.CSS?.supports &&\n        window.CSS?.supports(\"selector(:host-context(foo))\")\n            ? \"shadow\"\n            : \"light\";\n    static #sheet;\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport TOOLBAR_STYLE from \"../../../dist/css/perspective-viewer-datagrid-toolbar.css\";\nimport { toggle_edit_mode, toggle_scroll_lock } from \"../model/toolbar\";\n\n/**\n * The custom element for this plugin's toolbar, a component which displays in\n * the host `<perspective-viewer>`'s status bar when this plugin is active.\n * In the case of Datagrid, this comprises \"Editable\" and \"Scroll Lock\" toggle\n * buttons.\n */\nexport class HTMLPerspectiveViewerDatagridToolbarElement extends HTMLElement {\n    connectedCallback() {\n        if (this._initialized) {\n            return;\n        }\n\n        this._initialized = true;\n        this.setAttribute(\"slot\", \"plugin-settings\");\n        this.attachShadow({ mode: \"open\" });\n        this.shadowRoot.innerHTML = `\n            <style>\n                ${TOOLBAR_STYLE}\n            </style>\n            <div id=\"toolbar\">\n                <span id=\"scroll_lock\" class=\"button\">\n                    <span></span>\n                </span>\n                <span id=\"edit_mode\" class=\"button\"><span></span></span>\n            </div>\n        `;\n\n        const viewer = this.parentElement;\n        const plugin = viewer.querySelector(\"perspective-viewer-datagrid\");\n        plugin._scroll_lock = this.shadowRoot.querySelector(\"#scroll_lock\");\n        plugin._scroll_lock.addEventListener(\"click\", () =>\n            toggle_scroll_lock.call(plugin)\n        );\n\n        plugin._edit_mode = this.shadowRoot.querySelector(\"#edit_mode\");\n        plugin._edit_mode.addEventListener(\"click\", () => {\n            toggle_edit_mode.call(plugin);\n            plugin.regular_table.draw();\n            viewer.dispatchEvent(new Event(\"perspective-config-update\"));\n        });\n    }\n}\n", "// \u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n// \u2503 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588       \u2588      \u2588      \u2588      \u2588      \u2588 \u2588\u2584  \u2580\u2588\u2588\u2588 \u2588       \u2503\n// \u2503 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2588  \u2580\u2580\u2580\u2580\u2580\u2588\u2580\u2580\u2580\u2580\u2580 \u2588 \u2580\u2580\u2580\u2580\u2580\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2584  \u2580\u2588 \u2588 \u2580\u2580\u2580\u2580\u2580 \u2503\n// \u2503 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2580\u2580\u2580\u2580 \u2588\u2580\u2588\u2588\u2580\u2580 \u2584\u2584\u2584\u2584\u2584 \u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2584   \u2588 \u2584\u2584\u2584\u2584\u2584 \u2503\n// \u2503 \u2588      \u2588\u2588\u2588\u2588\u2588\u2588 \u2588  \u2580\u2588\u2584       \u2588 \u2588\u2588\u2588\u2588\u2588\u2588      \u2588      \u2588\u2588\u2588\u258C\u2590\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2584 \u2588       \u2503\n// \u2523\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u252B\n// \u2503 Copyright (c) 2017, the Perspective Authors.                              \u2503\n// \u2503 \u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C \u2503\n// \u2503 This file is part of the Perspective library, distributed under the terms \u2503\n// \u2503 of the [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0). \u2503\n// \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\nimport \"regular-table\";\n\nimport MATERIAL_STYLE from \"../../dist/css/perspective-viewer-datagrid.css\";\nimport { HTMLPerspectiveViewerDatagridPluginElement } from \"./custom_elements/datagrid.js\";\nimport { HTMLPerspectiveViewerDatagridToolbarElement } from \"./custom_elements/toolbar.js\";\n\n/**\n * Appends the default table CSS to `<head>`, should be run once on module\n * import.\n *\n */\nfunction _register_global_styles() {\n    const style = document.createElement(\"style\");\n    style.textContent = MATERIAL_STYLE;\n    document.head.insertBefore(style, document.head.firstChild);\n}\n\n/******************************************************************************\n *\n * Main\n *\n */\n\nasync function _register_element() {\n    customElements.define(\n        \"perspective-viewer-datagrid-toolbar\",\n        HTMLPerspectiveViewerDatagridToolbarElement\n    );\n\n    customElements.define(\n        \"perspective-viewer-datagrid\",\n        HTMLPerspectiveViewerDatagridPluginElement\n    );\n\n    await customElements.whenDefined(\"perspective-viewer\");\n    customElements\n        .get(\"perspective-viewer\")\n        .registerPlugin(\"perspective-viewer-datagrid\");\n}\n\n_register_element();\n_register_global_styles();\n"],
  "mappings": "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",
  "names": ["require_chroma", "__commonJSMin", "exports", "module", "Color", "DEG2RAD", "LAB_CONSTANTS", "PI", "PITHIRD", "RAD2DEG", "TWOPI", "_average_lrgb", "_guess_formats", "_guess_formats_sorted", "_input", "_interpolators", "abs", "atan2", "bezier", "blend", "blend_f", "brewer", "burn", "chroma", "clip_rgb", "cmyk2rgb", "colors", "cos", "css2rgb", "darken", "dodge", "each", "floor", "hcg2rgb", "hex2rgb", "hsi2rgb", "hsl2css", "hsl2rgb", "hsv2rgb", "interpolate", "interpolate_hsx", "interpolate_lab", "interpolate_lrgb", "interpolate_num", "interpolate_rgb", "lab2lch", "lab2rgb", "lab_xyz", "lch2lab", "lch2rgb", "lighten", "limit", "log", "luminance_x", "m", "max", "multiply", "normal", "num2rgb", "overlay", "pow", "rgb2cmyk", "rgb2css", "rgb2hcg", "rgb2hex", "rgb2hsi", "rgb2hsl", "rgb2hsv", "rgb2lab", "rgb2lch", "rgb2luminance", "rgb2num", "rgb2temperature", "rgb2xyz", "rgb_xyz", "rnd", "root", "round", "screen", "sin", "sqrt", "temperature2rgb", "type", "unpack", "w3cx11", "xyz_lab", "xyz_rgb", "slice", "classToType", "len", "name", "o", "ref", "obj", "strType", "x", "min", "args", "rgb", "i", "func", "ctor", "child", "result", "arg", "chk", "len1", "me", "mode", "a", "b", "key", "results", "g", "l", "r", "y", "z", "ref1", "I", "I0", "I1", "lab0", "lab1", "lab2", "lab3", "ref2", "t", "lab", "f", "start", "rotations", "hue", "gamma", "lightness", "dh", "dl", "fract", "amp", "cos_a", "h", "sin_a", "s", "code", "digits", "col1", "col2", "interpol", "res", "k", "v", "n", "xyz0", "xyz1", "col", "xyz", "A", "alpha", "cnt", "dx", "dy", "first", "xyz2", "c", "hex", "u", "channels", "hxa", "str", "t1", "t2", "t3", "p", "q", "ref3", "ref4", "ref5", "delta", "num", "_c", "_g", "css", "aa", "ab", "hsl", "w", "rgba", "L", "lum", "cur_lum", "eps", "max_iter", "test", "lm", "kelvin", "temp", "maxTemp", "minTemp", "l1", "l2", "d", "sum_sq", "C", "L1", "L2", "a1", "a2", "b1", "b2", "c1", "c2", "c4", "dH2", "delA", "delB", "delC", "delL", "h1", "sc", "sh", "sl", "v1", "v2", "v3", "modechan", "channel", "src", "value", "amount", "lch", "bottom", "top", "c0", "out", "data", "val", "positions", "_classes", "_colorCache", "_colors", "_correctLightness", "_domain", "_fixed", "_gamma", "_max", "_min", "_mode", "_nacol", "_out", "_padding", "_pos", "_spread", "_useCache", "classifyValue", "getClass", "getColor", "resetCache", "setColors", "tmap", "maxc", "minc", "bypassMap", "classes", "domain", "_m", "_o", "L0", "L_actual", "L_diff", "L_ideal", "pol", "t0", "numColors", "dd", "dm", "samples", "filter", "add", "visit", "ac", "ad", "ae", "af", "ag", "ah", "ai", "aj", "ak", "al", "am", "assignments", "best", "centroids", "cluster", "clusterSizes", "dist", "j", "kClusters", "limits", "max_log", "min_log", "mindist", "nb_iters", "newCentroids", "pb", "pr", "ref10", "ref11", "ref12", "ref13", "ref14", "ref6", "ref7", "ref8", "ref9", "repeat", "sum", "tmpKMeansBreaks", "values", "hue0", "hue1", "lbv", "lbv0", "lbv1", "sat", "sat0", "sat1", "n1", "n2", "METADATA_MAP", "DEBUG", "isFirefox", "BROWSER_MAX_HEIGHT", "AVG", "TOTAL", "START", "get_draw_fps", "now", "elapsed", "avg", "real_fps", "virtual_fps", "num_frames", "log_perf", "x", "html", "strings", "args", "str", "i", "a", "invertPromise", "_resolve", "promise", "resolve", "TAGS", "flush_tag", "tag", "throttle_tag", "f", "l", "ht", "ct", "RegularVirtualTableViewModel", "slot", "container_default", "sub_cell_offsets_default", "style", "virtual_panel", "table_clip", "nrows", "num_columns", "start_row", "end_row", "start_col", "end_col", "height", "row_height", "header_levels", "total_scroll_height", "percent_scroll", "virtual_panel_row_height", "scroll_index_offset", "offset_width", "diff", "new_val", "vis_cols", "width", "w", "max_scroll_column", "invalid_column", "invalid_row", "cidx", "virtual_width", "invalid", "y", "panel_width", "header_height", "virtual_panel_px_size", "zoom_factor", "options", "internal_draw", "viewport", "y_offset", "x_offset", "__debug_start_time__", "invalid_viewport", "preserve_width", "num_rows", "autosize_cells", "needs_sub_cell_update", "last_cells", "callbacks", "callback", "IOS_DISABLE_OVERSCROLL", "RegularViewEventModel", "event", "clientWidth", "clientHeight", "scrollTop", "scrollLeft", "total_scroll_width", "element", "is_resize", "metadata", "row", "td", "_virtual_x", "size_key", "start", "header_x", "header_element", "move", "up", "override_width", "should_redraw", "th", "virtual_x", "auto_width", "ElemFactory", "name", "elem", "ViewModel", "column_sizes", "container", "table", "ridx", "tr", "row_container", "new_td", "idx", "RegularHeaderViewModel", "offset_cache", "d", "column", "span", "resizeSpan", "column_name", "alias", "parts", "colspan", "x0", "column_header_merge_depth", "merge_headers", "output", "group_meta", "RegularBodyViewModel", "tagName", "val", "ridx_offset", "container_height", "column_state", "view_state", "column_data", "row_headers", "column_data_listener_metadata", "tds", "cidx_offset", "id", "obj", "row_header", "prev_row", "prev_row_metadata", "prev_col", "prev_col_metadata", "RegularTableViewModel", "thead", "tbody", "override_row_height", "cell", "box", "is_override", "container_size", "view_cache", "selected_id", "container_width", "view", "config", "data", "column_headers", "data_listener_metadata", "merge_row_headers", "merge_column_headers", "x1", "y1", "max", "sub_cell_offset", "cont_body", "first_col", "cont_heads", "header", "total", "hmetadata", "dcidx", "num_visible_columns", "missing_cidx", "end_col_offset", "size_extension", "estimate", "new_col_req", "new_col", "cont_head", "last_measured_col_width", "VIRTUAL_MODES", "RegularTableElement", "styleListener", "isSubscribed", "index", "viewport_row_height", "row_height_offset", "real_row_height", "scroll_left", "dataListener", "virtual_mode", "schema", "get_psp_type", "metadata", "style_selected_column", "regularTable", "viewer", "selectedColumn", "group_header_trs", "len", "tr", "i", "id", "settings_open", "titles", "editBtns", "th", "title", "editBtn", "open", "r", "meta", "column_header_style_listener", "col_headers", "style_column_header_row", "style_menu_headers", "is_menu_row", "header_depth", "td", "column_name", "sort", "x", "needs_border", "is_corner", "type", "is_numeric", "is_string", "is_date", "is_datetime", "group_header_style_listener", "regularTable", "header_depth", "group_header_trs", "m", "marked", "table", "y", "row", "tops", "x", "td", "metadata", "needs_border", "cell", "xx", "tx", "ty", "PRIVATE_PLUGIN_SYMBOL", "style_cell_flash", "metadata", "td", "pos_s", "pos_e", "neg_s", "neg_e", "is_settings_open", "id", "metadata_path", "row_idx", "col_idx", "import_chroma_js", "blend", "a", "b", "chroma", "rgbaToRgb", "r", "g", "source", "f", "i", "c", "infer_foreground_from_background", "make_gradient", "chromahex", "r1", "g1", "b1", "r2", "g2", "b2", "make_color_record", "color", "chroma_neg", "_neg_grad", "rgb", "cell_style_numeric", "plugin", "td", "metadata", "is_settings_open", "is_positive", "is_negative", "pos_bg_color", "neg_bg_color", "bg_tuple", "hex", "r", "g", "b", "_gradhex", "a", "source", "foreground", "infer_foreground_from_background", "rgbaToRgb", "style_cell_flash", "gradhex", "import_chroma_js", "cell_style_string", "plugin", "td", "metadata", "column_name", "hex", "r", "g", "b", "gradhex", "source", "foreground", "infer_foreground_from_background", "rgbaToRgb", "series_map", "seed", "color_seed", "h", "s", "l", "chroma", "color2", "hex2", "import_chroma_js", "cell_style_datetime", "plugin", "td", "metadata", "column_name", "hex", "r", "g", "b", "gradhex", "source", "foreground", "infer_foreground_from_background", "rgbaToRgb", "cell_style_boolean", "plugin", "td", "metadata", "hex", "cell_style_row_header", "regularTable", "td", "metadata", "is_not_empty", "is_leaf", "next", "is_collapse", "get_psp_type", "metadata", "table_cell_style_listener", "regularTable", "viewer", "plugins", "PRIVATE_PLUGIN_SYMBOL", "is_settings_open", "tr", "td", "column_name", "type", "plugin", "is_numeric", "cell_style_numeric", "cell_style_boolean", "cell_style_string", "cell_style_datetime", "is_th", "cell_style_row_header", "sortHandler", "regularTable", "viewer", "event", "target", "column_name", "sort", "append_sort", "override_sort", "found", "sort_term", "_column_name", "_sort_dir", "term", "create_sort", "sort_dir", "order", "ROW_COL_SORT_ORDER", "ROW_SORT_ORDER", "inc_sort_dir", "expandCollapseHandler", "regularTable", "event", "meta", "is_collapse", "x", "mousedown_listener", "regularTable", "viewer", "event", "target", "expandCollapseHandler", "column_name", "sortHandler", "click_listener", "isEditable", "viewer", "allowed", "has_pivots", "selectable", "editable", "editable_style_listener", "table", "datagrid", "plugins", "PRIVATE_PLUGIN_SYMBOL", "edit", "td", "meta", "type", "col_name", "focus_style_listener", "table", "_viewer", "selected_position_map", "tds", "selected_position", "host", "td", "meta", "lock", "body", "args", "resolve", "x", "getPos", "_range", "range", "write_cell", "table", "model", "active_cell", "meta", "type", "text", "id", "msg", "is_editable", "viewer", "allowed", "has_pivots", "selectable", "editable", "moveSelection", "selected_position_map", "dx", "dy", "num_columns", "num_rows", "selected_position", "xmin", "xmax", "ymin", "ymax", "y", "focus_style_listener", "keydownListener", "event", "target", "clickListener", "_viewer", "is_all_editable", "is_editable2", "is_bool", "is_null", "focusoutListener", "table", "viewer", "selected_position_map", "event", "is_editable", "selectedPosition", "write_cell", "focusinListener", "_viewer", "meta", "new_state", "getCellConfig", "_view", "_config", "row_idx", "col_idx", "group_by", "split_by", "start_row", "end_row", "r", "group_by_values", "x", "row_filters", "pivot", "index", "pivot_value", "column_index", "column_paths", "result", "column_filters", "split_by_values", "value", "filter", "selectionListener", "regularTable", "viewer", "selected_rows_map", "event", "meta", "id", "selected", "key_match", "agg", "x", "i", "is_deselect", "detail", "row", "column_names", "config", "getCellConfig", "selectionStyleListener", "regularTable", "viewer", "selected_rows_map", "has_selected", "selected", "td", "meta", "id", "key_match", "agg", "x", "i", "th", "deselect_all_listener", "regularTable", "_viewer", "selected_rows_map", "td", "import_chroma_js", "settings_default", "get_type_config", "type", "config", "get_config", "props", "isObject", "item", "mergeDeep", "target", "sources", "source", "key", "get_config", "mergeDeep", "settings_default", "FORMATTER_CONS", "val", "FormatterCache", "type", "plugin", "type_config", "get_type_config", "options", "format", "formatter_key", "FORMAT_CACHE", "FormatterCache", "MAX_BAR_WIDTH_PCT", "format_cell", "title", "val", "plugins", "use_table_schema", "type", "plugin", "a", "div", "anchor", "pct", "formatter", "format_tree_header", "paths", "row_headers", "regularTable", "plugins", "PRIVATE_PLUGIN_SYMBOL", "path", "last", "formatted", "format_cell", "createDataListener", "viewer", "last_meta", "last_column_paths", "last_ids", "last_reverse_ids", "last_reverse_columns", "regularTable", "x0", "y0", "x1", "y1", "columns", "new_window", "acc", "x", "i", "data", "metadata", "column_headers", "column_paths", "is_settings_open", "ipath", "path", "path_parts", "column", "format_cell", "PRIVATE_PLUGIN_SYMBOL", "format_tree_header", "get_rule", "regular", "tag", "def", "color", "ElemFactory", "name", "elem", "get_psp_type", "metadata", "createModel", "table", "view", "extend", "config", "expressions", "expr", "table_schema", "validated_expressions", "num_rows", "schema", "expression_schema", "column_paths", "_edit_port", "_plugin_background", "chroma", "_pos_fg_color", "make_color_record", "_neg_fg_color", "_pos_bg_color", "blend", "_neg_bg_color", "_color", "_schema", "_table_schema", "_column_paths", "path", "_is_editable", "_column_types", "column_path", "column", "model", "createDataListener", "dispatch_click_listener", "table", "viewer", "event", "meta", "x", "y", "row", "column_names", "config", "getCellConfig", "activate", "view", "viewer", "table", "createModel", "table_cell_style_listener", "group_header_style_listener", "column_header_style_listener", "click_listener", "mousedown_listener", "selected_rows_map", "selectionStyleListener", "selectionListener", "deselect_all_listener", "dispatch_click_listener", "selected_position_map", "editable_style_listener", "focus_style_listener", "clickListener", "focusinListener", "focusoutListener", "keydownListener", "event", "style_selected_column", "restore_column_size_overrides", "old_sizes", "cache", "overrides", "group_by", "columns", "tree_header_offset", "key", "index", "save_column_size_overrides", "x", "toggle_edit_mode", "force", "toggle_scroll_lock", "restore", "token", "columns", "overrides", "col", "value", "styles", "col_name", "controls", "make_color_record", "toggle_edit_mode", "toggle_scroll_lock", "datagrid", "restore_column_size_overrides", "PRIVATE_PLUGIN_SYMBOL", "save", "token", "column_size_overrides", "save_column_size_overrides", "col", "draw", "view", "old_sizes", "save_column_size_overrides", "restore_column_size_overrides", "column_style_opts", "type", "_group", "_sheet", "_HTMLPerspectiveViewerDatagridPluginElement", "Elem", "__privateGet", "__privateSet", "perspective_viewer_datagrid_default", "parent", "view", "activate", "type", "_group", "group", "column_style_opts", "draw", "save", "token", "columns_config", "restore", "HTMLPerspectiveViewerDatagridPluginElement", "__publicField", "__privateAdd", "HTMLPerspectiveViewerDatagridToolbarElement", "perspective_viewer_datagrid_toolbar_default", "viewer", "plugin", "toggle_scroll_lock", "toggle_edit_mode", "_register_global_styles", "style", "perspective_viewer_datagrid_default", "_register_element", "HTMLPerspectiveViewerDatagridToolbarElement", "HTMLPerspectiveViewerDatagridPluginElement"]
}
